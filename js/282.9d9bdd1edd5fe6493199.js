"use strict";(self.webpackChunksources=self.webpackChunksources||[]).push([[282],{524:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var a=n(87462),r=n(45987),i=n(15861),s=n(29439),o=n(4942),u=n(64687),c=n.n(u),l=n(92950),d=n.n(l),f=n(86896),p=n(86706),m=n(8213),v=n(60566),g=n(58192),y=n(90280),h=n(45697),b=n.n(h),M=n(76429),w=n(67850),O=n(48880),E=["ModalProps"],Z=function(e){return d().createElement(m.Form,(0,a.Z)({},e,{id:"modal-form"}))},C=function(){var e=(0,f.Z)(),t=(0,O.default)().onCancel;return d().createElement(M.Z,{subscription:{submitting:!0,pristine:!0,invalid:!0,validating:!0}},(function(n){var a=n.pristine,r=n.invalid,i=n.validating,s=n.submitting;return d().createElement("div",{className:"pf-c-form"},d().createElement(m.ActionGroup,{className:"pf-u-mt-0"},d().createElement(m.Button,{variant:"primary",form:"modal-form",type:"submit",isDisabled:a||i||s||r},e.formatMessage({id:"sources.submit",defaultMessage:"Submit"})),d().createElement(m.Button,{variant:"link",onClick:t,id:"cancel-modal"},e.formatMessage({id:"sources.cancel",defaultMessage:"Cancel"}))))}))},k=function(e){var t=e.ModalProps,n=(0,r.Z)(e,E);return d().createElement(m.Modal,(0,a.Z)({footer:d().createElement(C,null)},t),d().createElement(w.ZP,(0,a.Z)({},n,{showFormControls:!1,FormWrapper:Z})))};k.propTypes={ModalProps:b().object};const _=k;var j=n(48815),P=n(89372),D=n(92657),S=n(93736),V=["tenant","source_id","id","authtype","resource_id","resource_type"];function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N={loading:!0,initialValues:{}},x=function(e,t){var n=t.type,a=t.values;if("loaded"===n)return F(F({},e),{},{loading:!1,initialValues:{authentication:a}})};const I=function(){var e=(0,v.L)(),t=(0,S.a)(),n=(0,f.Z)(),o=(0,p.I0)(),u=(0,p.v9)((function(e){return e.sources.sourceTypes}),p.wU),h=u.find((function(t){return t.id===e.source_type_id})).name,b=(0,l.useReducer)(x,N),M=(0,s.Z)(b,2),w=M[0],O=w.loading,E=w.initialValues,Z=M[1],C=function(){return t((0,g.yS)(g._j.sourcesDetail.path,e.id))},k=e.paused_at,z=k?n.formatMessage({id:"editCredentials.paused.title",defaultMessage:"View account authorization credentials"}):n.formatMessage({id:"editCredentials.title",defaultMessage:"Edit account authorization credentials"}),I=k?void 0:n.formatMessage({id:"editCredentials.description",defaultMessage:"Use the fields below to reset your account authorization credentials. It may take some time to validate new information."});return(0,l.useEffect)((function(){(0,j.Rj)().listSourceAuthentications(e.id).then((function(e){var t,n=e.data,a=null===(t=u.find((function(e){return e.name===h})))||void 0===t?void 0:t.schema.authentication.find((function(e){return e.is_superkey})),r=n.find((function(e){return e.authtype===a.type}));Z({type:"loaded",values:r})}))}),[]),O?d().createElement(m.Modal,{title:z,variant:"small",isOpen:!0,onClose:C},d().createElement(m.Bullseye,{className:"pf-u-m-2xl"},d().createElement(m.Spinner,null))):d().createElement(y.Z,{clearedValue:null,schema:{fields:(0,D.Z)(u,h).map((function(t){return e.paused_at?F(F({},t),{},{isDisabled:!0}):t}))},onSubmit:function(){var e=(0,i.Z)(c().mark((function e(t){var a,i,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t.authentication).tenant,a.source_id,i=a.id,a.authtype,a.resource_id,a.resource_type,s=(0,r.Z)(a,V),C(),e.prev=2,e.next=5,(0,j.Rj)().updateAuthentication(i,s);case 5:o((0,P.Hz)({title:n.formatMessage({id:"editCredentials.alert.title",defaultMessage:"New credentials saved"}),description:n.formatMessage({id:"editCredentials.alert.description",defaultMessage:"It may take some time to validate your new credentials. Check this page for status updates."}),variant:"info"})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),o((0,P.Hz)({title:n.formatMessage({id:"editCredentials.alert.warning.title",defaultMessage:"Error updating credentials"}),description:n.formatMessage({id:"editCredentials.alert.warning.description",defaultMessage:"There was a problem while trying to update credentials. Please try again. If the error persists, open a support case."}),variant:"danger"}));case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),initialValues:E,FormTemplate:function(e){return d().createElement(_,(0,a.Z)({},e,{ModalProps:F({isOpen:!0,onClose:C,variant:"small",title:z,description:I},k&&{footer:null})}))},onCancel:C})}},92657:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(93433),r=n(32600);const i=function(e,t){var n,i=null===(n=e.find((function(e){return e.name===t})))||void 0===n?void 0:n.schema.authentication.find((function(e){var t=e.is_superkey,n=e.type;return t||"access_key_secret_key"===n})),s=(0,r.gF)(t,i.type);return[].concat((0,a.Z)((0,r.YD)(t,i.type)),(0,a.Z)((0,r.Ow)((0,r.sM)(i.fields,s),t,i.type)))}},93736:(e,t,n)=>{n.d(t,{a:()=>i});var a=n(49881),r=n(16959),i=function(){var e=(0,a.useNavigate)();return function(t,n){return e((0,r.n)(t,r.d),n)}}}}]);
//# sourceMappingURL=../sourcemaps/282.dec348d5d089a55355367942c1a20c20.js.map