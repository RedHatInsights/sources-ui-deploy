(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{351:function(e,t,a){"use strict";var n=a(0),i=Object(n.createContext)();t.a=i},373:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(92),i=a.n(n),r=a(0),s=a.n(r),o=a(1),c=a.n(o),u=a(324),p=a.n(u),l=a(429),d=a.n(l),m=a(44),f=a(326),g=a(351),h=a(321),y=a.n(h),v="edit-field",b=function(e){var t=e.isRequired,a=e.label,n=e.helperText,o=e.hideLabel,c=e.name,u=e.type,l=e.isEditable,h=y()(),v=h.getFieldState,b=h.getState,E=Object(r.useContext)(g.a).setState,O=v(c)||{value:p()(b().initialValues,c)},T=O.error,_=O.touched,j=O.value,S=_&&T,M="password"===u||c.includes("password")?"Click to edit":"Click to add";return s.a.createElement(f.FormGroup,i()({isRequired:t,label:!o&&a,fieldId:c,isValid:!S,helperText:n,helperTextInvalid:T,tabIndex:0,onKeyPress:function(e){32===e.charCode&&l&&(e.preventDefault(),E({type:"setEdit",name:c}))}},l&&{onClick:function(){return E({type:"setEdit",name:c})}}),s.a.createElement("div",{className:"pf-c-form__horizontal-group ins-c-sources__edit-field-group ".concat(l?"clickable":"")},s.a.createElement(m.TextContent,{className:"ins-c-sources__edit-field-group-text-content ".concat(l?"clickable":"")},s.a.createElement("span",{className:"ins-c-sources__edit-field-value pf-u-mr-sm"},j||(l?M:"")),l&&s.a.createElement(d.a,null))))};b.propTypes={label:c.a.node,isRequired:c.a.bool,helperText:c.a.node,hideLabel:c.a.bool,isEditable:c.a.bool,type:c.a.string,name:c.a.string},t.b=b},477:function(e,t,a){"use strict";var n=a(92),i=a.n(n),r=a(3),s=a.n(r),o=a(0),c=a.n(o),u=a(367),p=a.n(u),l=a(320),d=a.n(l),m=a(322),f=a.n(m),g=a(357),h=a.n(g),y=a(347),v=a.n(y),b=a(369),E=a.n(b),O=a(455),T=a(68),_=a.n(T),j=a(1),S=a.n(j),M=a(381),A=a.n(M),x=a(351),w=a(373),P=[d.a.CHECKBOX,d.a.SWITCH],C=function(e){var t=e.originalComponent,a=e.isEditable,n=void 0===a||a,r=_()(e,["originalComponent","isEditable"]),s=w.b,u={},p=Object(o.useContext)(A.a).componentMapper;return Object(o.useContext)(x.a).editing[r.name]||P.includes(t)?s=p[t]:n&&(u={isEditable:!0}),c.a.createElement(s,i()({},r,u))};C.propTypes={originalComponent:S.a.string,name:S.a.string,isEditable:S.a.bool};var R=C;function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.a=function(e){return c.a.createElement(p.a,i()({FormTemplate:v.a,componentMapper:k(k(k({},E.a),O.mapperExtension),{},{"edit-field":R,"switch-field":E.a[d.a.SWITCH]}),validatorMapper:{"required-validator":h.a[f.a.REQUIRED],"pattern-validator":h.a[f.a.PATTERN],"min-length-validator":h.a[f.a.MIN_LENGTH],"url-validator":h.a[f.a.URL]}},e))}},758:function(e,t,a){"use strict";a.r(t),a.d(t,"onSubmit",(function(){return dt}));var n=a(25),i=a.n(n),r=a(39),s=a.n(r),o=a(92),c=a.n(o),u=a(78),p=a.n(u),l=a(105),d=a.n(l),m=a(0),f=a.n(m),g=a(10),h=a(30),y=a(312),v=a(13),b=a(463),E=a.n(b),O=a(470),T=a.n(O),_=a(537),j=a.n(_),S=a(538),M=a.n(S),A=a(539),x=a.n(A),w=a(540),P=a.n(w),C=a(347),R=a.n(C),V=a(90),k=a(477),D=a(320),N=a.n(D),I=a(322),F=a.n(I),q=a(26),B=a(44),L=a(541),G=a(324),z=a.n(G),U=a(1),W=a.n(U),Q=a(321),Y=a.n(Q),H=function(e){var t=e.modifiedValues,a=Y()(),n=z()(a.getState().values,"application.application_type_id",""),i=Object(m.useState)(n),r=s()(i,2),o=r[0],c=r[1];return Object(m.useEffect)((function(){if(o!==n){var e=t&&t.authentication?t.authentication:void 0;a.batch((function(){a.change("authentication",e),a.change("selectedAuthentication",void 0)})),c(void 0)}}),[n]),null};H.propTypes={modifiedValues:W.a.object};var K=a(419),J=a(88),X=a(387),Z=a(89),$=a(67),ee=a.n($),te=a(355),ae=function(e){var t=e.app,a=e.onCancel,n=e.container,i=Object(y.a)(),r=Object(h.useSelector)((function(e){return e.sources.appTypes})),s=Object(te.a)(),o=Object(h.useDispatch)();Object(m.useEffect)((function(){n&&(n.hidden=!0)}),[]);var c=t.dependent_applications.map((function(e){var a=r.find((function(t){return t.name===e}));return a&&t.sourceAppsNames.includes(a.display_name)?a.display_name:void 0})).filter((function(e){return e}));return f.a.createElement(X.Modal,{className:"ins-c-sources__dialog--warning",isOpen:!0,onClose:a,isFooterLeftAligned:!0,isSmall:!0,title:i.formatMessage({id:"sources.deleteAppTitle",defaultMessage:"Remove application?"}),header:f.a.createElement(Z.Title,{size:"2xl"},f.a.createElement(ee.a,{size:"sm",className:"ins-m-alert ins-c-source__delete-icon pf-u-mr-sm"}),i.formatMessage({id:"sources.deleteAppTitle",defaultMessage:"Remove application?"})),actions:[f.a.createElement(J.Button,{id:"deleteSubmit",key:"submit",variant:"danger",type:"button",onClick:function(){var e=i.formatMessage({id:"sources.removeAppWarning",defaultMessage:"{ name } was removed from this source."},{name:t.display_name}),n=i.formatMessage({id:"sources.removeAppError",defaultMessage:"Removing of { name } application from this source was unsuccessful."},{name:t.display_name});return a(),o(Object(V.i)(t.id,s.id,e,n))}},f.a.createElement(v.a,{id:"sources.remove",defaultMessage:"Remove application"})),f.a.createElement(J.Button,{id:"deleteCancel",key:"cancel",variant:"link",type:"button",onClick:a},f.a.createElement(v.a,{id:"sources.cancel",defaultMessage:"Cancel"}))]},f.a.createElement(B.TextContent,null,f.a.createElement(q.Text,{component:q.TextVariants.p},f.a.createElement(v.a,{id:"sources.deleteAppWarning",defaultMessage:"Are you sure to remove { appName } from this source?",values:{appName:f.a.createElement("b",null,t.display_name)}})),c.length>0&&f.a.createElement(q.Text,{component:q.TextVariants.p},f.a.createElement(v.a,{id:"sources.deleteAppDetails",defaultMessage:"This change will affect these applications: { apps }.",values:{apps:c}}))))};ae.propTypes={app:W.a.shape({id:W.a.string.isRequired,display_name:W.a.string.isRequired,dependent_applications:W.a.arrayOf(W.a.string),sourceAppsNames:W.a.arrayOf(W.a.string)}).isRequired,onCancel:W.a.func.isRequired,container:W.a.instanceOf(Element)};var ne=ae,ie=a(328),re=a(329),se=function(e){var t=e.setApplicationToRemove,a=e.breakpoints,n=e.namePrefix,i=Object(h.useSelector)((function(e){return e.sources.appTypes})),r=Object(te.a)(),s=r.applications.map((function(e){var t=e.application_type_id,a=i.find((function(e){return e.id===t}));return a?a.display_name:void 0}));return r.applications.filter((function(e){return!e.isDeleting})).map((function(e){var t=i.find((function(t){return t.id===e.application_type_id}));if(t)return{display_name:t.display_name,id:e.id,dependent_applications:t.dependent_applications}})).sort((function(e,t){return e.display_name.localeCompare(t.display_name)})).map((function(e){var i=e.display_name,r=e.id,o=e.dependent_applications;return f.a.createElement(B.TextContent,{key:r},f.a.createElement(ie.Grid,null,f.a.createElement(re.GridItem,{md:a.display_name||4},f.a.createElement(q.Text,{component:q.TextVariants.p,style:{marginBottom:0}},n,i)),f.a.createElement(re.GridItem,{md:a.remove||8,className:"ins-c-sources__remove-app"},f.a.createElement(J.Button,{variant:J.ButtonVariant.link,isInline:!0,onClick:function(){return t({id:r,display_name:i,dependent_applications:o,sourceAppsNames:s})}},f.a.createElement(v.a,{id:"sources.remove",defaultMessage:"Remove"})))))}))};se.propTypes={setApplicationToRemove:W.a.func.isRequired,breakpoints:W.a.shape({display_name:W.a.number,remove:W.a.number}),namePrefix:W.a.node},se.defaultProps={breakpoints:{}};var oe=se,ce=function(e){var t=e.container,a=Object(m.useState)({}),n=s()(a,2),i=n[0],r=n[1],o=Object(h.useSelector)((function(e){return e.sources.sourceTypes})),c=Object(te.a)(),u=o.find((function(e){return e.id===c.source_type_id})),p=c.applications.filter((function(e){return!e.isDeleting}));return f.a.createElement(f.a.Fragment,null,i.id&&f.a.createElement(ne,{app:i,onCancel:function(){return t&&(t.hidden=!1),r({})},container:t}),f.a.createElement(B.TextContent,null,f.a.createElement(K.Grid,{gutter:"md"},f.a.createElement(K.GridItem,{md:2},f.a.createElement(q.Text,{component:q.TextVariants.h4},f.a.createElement(v.a,{id:"sources.sourceName",defaultMessage:"Source name"}))),f.a.createElement(K.GridItem,{md:2},f.a.createElement(q.Text,{component:q.TextVariants.h4},f.a.createElement(v.a,{id:"sources.type",defaultMessage:"Type"}))),f.a.createElement(K.GridItem,{md:8},f.a.createElement(q.Text,{component:q.TextVariants.h4},f.a.createElement(v.a,{id:"sources.apps",defaultMessage:"Applications"}))),f.a.createElement(K.GridItem,{md:2},f.a.createElement(q.Text,{component:q.TextVariants.p},c.name)),f.a.createElement(K.GridItem,{md:2},f.a.createElement(q.Text,{component:q.TextVariants.p},u?u.product_name:f.a.createElement(v.a,{id:"sources.typeNotFound",defaultMessage:"Type not found"}))),f.a.createElement(K.GridItem,{md:8},p.length>0?f.a.createElement(oe,{setApplicationToRemove:r}):f.a.createElement(v.a,{id:"sources.noApps",defaultMessage:"No applications"})))))};ce.propTypes={container:W.a.instanceOf(Element)};var ue=ce,pe=function(e,t,a,n){return{name:"selectAuthType-".concat(t.id),title:a.formatMessage({id:"sources.selectAuthenticationTitle",defaultMessage:"Select authentication type"}),fields:[{component:N.a.RADIO,name:"authtype",options:t.supported_authentication_types[e.name].map((function(t){var a;return{value:t,label:(null===(a=e.schema.authentication.find((function(e){return e.type===t})))||void 0===a?void 0:a.name)||"Unknown type"}})),isRequired:!0,validate:[{type:F.a.REQUIRED}]}],nextStep:function(t){var a=t.values,i=a.application,r=a.authtype;if(r)return n.find((function(e){return e.authtype===r}))?"selectAuthentication":"".concat(e.name,"-").concat(i&&i.application_type_id,"-").concat(r)}}},le=a(3),de=a.n(le);function me(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function fe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?me(Object(a),!0).forEach((function(t){de()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):me(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ge=function(e,t,a,n,r){var s,o=i()(a),c=e.schema.authentication.find((function(e){return e.type===n})),u="".concat(e.name,"-").concat(n,"-").concat(t.name,"-additional-step"),p=L.shouldSkipEndpoint(e.name,n,t.name),l=L.hasCustomSteps(e.name,n,t.name);s=L.getAdditionalSteps(e.name,n,t.name).length>0?u:0!==a.length||p?"summary":"".concat(e.name,"-endpoint");var d=L.getAdditionalStepKeys(e.name,n,t.name),m={};if(L.shouldSkipSelection(e.name,n,t.name)){var f=L.getAdditionalSteps(e.name,n,t.name).find((function(e){return!e.name})),g=L.getAdditionalStepFields(c.fields,u);s=f.nextStep?f.nextStep:0!==a.length||p||l?"summary":"".concat(e.name,"-endpoint"),m=fe(fe({},f),{},{fields:[].concat(i()(o),i()(L.injectAuthFieldsInfo([].concat(i()(f.fields),i()(g)),e.name,n,t.name)))})}return fe({name:"".concat(e.name,"-").concat(t.id,"-").concat(n),title:r.formatMessage({id:"sources.configureCredentials",defaultMessage:"Configure credentials"}),fields:[].concat(i()(o),i()(L.getAdditionalAuthFields(e.name,n,t.name)),i()(L.injectAuthFieldsInfo(L.getNoStepsFields(c.fields,d),e.name,n,t.name))),nextStep:s},m)};function he(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ye(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?he(Object(a),!0).forEach((function(t){de()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):he(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ve=function(e){var t=e.authenticationValues,a=e.modifiedValues,n=Y()(),i=n.getState().values.selectedAuthentication,r=Object(m.useState)(i),o=s()(r,2),c=o[0],u=o[1];return Object(m.useEffect)((function(){c!==i&&(!function(e){var t=e.formOptions,a=e.modifiedValues,n=e.authenticationValues,i=e.selectedAuthentication;if(i.startsWith("new-")){var r=i.replace("new-","");a&&a.authentication?t.change("authentication",ye(ye({},a.authentication),{},{authtype:r})):t.change("authentication",{authtype:r})}else{var s=n.find((function(e){return e.id===i}));if(a&&a.authentication){var o=E()(T()(s),a.authentication);t.change("authentication",o)}else t.change("authentication",s)}}({formOptions:n,authenticationValues:t,modifiedValues:a,selectedAuthentication:i}),u(void 0))}),[i]),null};ve.propTypes={authenticationValues:W.a.arrayOf(W.a.object),modifiedValues:W.a.object};var be=function(e){var t=e.applicationTypeName,a=e.authenticationTypeName;return f.a.createElement(B.TextContent,null,f.a.createElement(q.Text,{component:q.TextVariants.p},f.a.createElement(v.a,{id:"sources.selectAuthenticationDescription",defaultMessage:"Selected application { applicationTypeName } supports { authenticationTypeName } authentication type. You can use already defined authentication values or define new.",values:{applicationTypeName:t,authenticationTypeName:a}})))};be.propTypes={applicationTypeName:W.a.string,authenticationTypeName:W.a.string};var Ee=function(e){var t=e.source,a=e.authenticationValues,n=e.applicationTypes,i=e.supportedAuthTypeName,r=e.supportedAuthType;return a.filter((function(e){return e.authtype===r})).map((function(e){var a=t.applications.find((function(t){return t.authentications.find((function(t){return t.id===e.id}))})),r=a&&a.application_type_id?n.find((function(e){return e.id===a.application_type_id})):"",s=e.username?"-".concat(e.username):"",o=r?"-".concat(r.display_name):"-unused-".concat(e.id);return{label:"".concat(i).concat(s).concat(o),value:e.id}}))},Oe=function(e){var t=e.intl,a=e.source,n=e.authenticationValues,r=e.sourceType,s=e.applicationTypes,o=e.modifiedValues,c=[{component:"description",name:"authtypesetter",Content:ve,authenticationValues:n,hideField:!0,modifiedValues:o}];return s.forEach((function(e){var o,u=e.supported_source_types.includes(r.name),p=!(null===(o=a.applications)||void 0===o?void 0:o.find((function(t){return t.application_type_id===e.id})));if(u&&p){var l=z()(e,"supported_authentication_types[".concat(r.name,"]"),[]);l.forEach((function(o){if(n.find((function(e){return e.authtype===o}))){var u=z()(r,"schema.authentication",{}).find((function(e){return e.type===o})).name;c.push({component:N.a.SUB_FORM,name:"".concat(e.name,"-subform"),condition:{and:[{when:"application.application_type_id",is:e.id}].concat(i()(l.length>1?[{when:"authtype",is:o}]:[]))},fields:[{name:"".concat(e.name,"-select-authentication-summary"),component:"description",Content:be,applicationTypeName:e.display_name,authenticationTypeName:u},{component:N.a.RADIO,name:"selectedAuthentication",label:t.formatMessage({id:"sources.selectAuthenticationTitle",defaultMessage:"Select authentication"}),isRequired:!0,validate:[{type:F.a.REQUIRED}],options:[{label:t.formatMessage({id:"sources.selectAuthenticationradioLabel",defaultMessage:"Define new { supportedAuthTypeName }"},{supportedAuthTypeName:u}),value:"new-".concat(o)}].concat(i()(Ee({authenticationValues:n,source:a,applicationTypes:s,supportedAuthTypeName:u,supportedAuthType:o})))}]})}}))}})),{name:"selectAuthentication",title:t.formatMessage({id:"sources.selectAuthenticationTitle",defaultMessage:"Select authentication"}),fields:c,nextStep:function(e){var t=e.values,a=t.application,n=t.authtype,i=t.authentication,s=a||{},o=s.application_type_id?s.application_type_id:"";return"".concat(r.name,"-").concat(o,"-").concat(n||(null==i?void 0:i.authtype))}}},Te=function(){return f.a.createElement(B.TextContent,null,f.a.createElement(q.Text,{component:q.TextVariants.p},f.a.createElement(v.a,{id:"sources.allApplicationsAssigned",defaultMessage:"All available applications have already been added to this source or there is no available application for this source."})))},_e=function(){return f.a.createElement(B.TextContent,null,f.a.createElement(q.Text,{component:q.TextVariants.p},f.a.createElement(v.a,{id:"sources.reviewAddAppSummary",defaultMessage:"Review the information below and click Add to add the application to your source. Use the Back button to make changes."})))},je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return e.find((function(e){return e.authtype===z()(t,"supported_authentication_types.".concat(a,"[0]"))}))},Se=function(e,t){var a;return e.supported_source_types.includes(t.name)&&(null===(a=e.supported_authentication_types[t.name])||void 0===a?void 0:a.length)>1},Me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,u=e.length>0,p=u?"summary":void 0,l=[],d=a.find((function(e){return e.id===s.source_type_id}));if(!s.imported&&u){var m=d.schema.endpoint.hidden?d.schema.endpoint.fields:[],f=0===m.length;n.forEach((function(e){e.supported_source_types.includes(d.name)&&e.supported_authentication_types[d.name].forEach((function(a){l.push(ge(d,e,m,a,t))}))})),d.schema.authentication.forEach((function(e){n.forEach((function(t){if(t.supported_source_types.includes(d.name)){var a=L.getAdditionalSteps(d.name,e.type,t.name);a.length>0&&l.push.apply(l,i()(L.createAdditionalSteps(a,d.name,e.type,f,e.fields,t.name)))}}))})),f&&l.push(L.createEndpointStep(d.schema.endpoint,d.name)),p=function(e){var t=e.values.application;if(t){var a,i=n.find((function(e){return e.id===t.application_type_id}));if((null==i||null===(a=i.supported_authentication_types[d.name])||void 0===a?void 0:a.length)>1)return"selectAuthType-".concat(t.application_type_id);if(je(r,n.find((function(e){return e.id===t.application_type_id})),d.name))return"selectAuthentication";var s=null==i?void 0:i.supported_authentication_types[d.name][0];return"".concat(d.name,"-").concat(t&&t.application_type_id,"-").concat(s)}}}var g=u?{component:"card-select",name:"application.application_type_id",options:e,label:t.formatMessage({id:"sources.chooseAppToAdd",defaultMessage:"Choose an application to add"}),DefaultIcon:null,isRequired:!0,validate:[{type:F.a.REQUIRED}]}:{component:"description",name:"description-no-options",validate:[{type:F.a.REQUIRED}],Content:Te},h=n.filter((function(e){return Se(e,d)})).map((function(e){return pe(d,e,t,r)}));return!s.imported&&u&&h.push(Oe({intl:t,source:s,authenticationValues:r,sourceType:d,applicationTypes:n,modifiedValues:o})),{fields:[{component:N.a.WIZARD,name:"wizard",title:t.formatMessage({id:"sources.manageApps",defaultMessage:"Manage applications"}),inModal:!0,container:c,predictSteps:!0,showTitles:!0,crossroads:["application.application_type_id","selectedAuthentication","authtype"],description:t.formatMessage({id:"sources.addAppDescription",defaultMessage:"You are managing applications of this source."}),buttonLabels:{submit:u?t.formatMessage({id:"sources.add",defaultMessage:"Add"}):t.formatMessage({id:"sources.close",defaultMessage:"Close"}),cancel:t.formatMessage({id:"sources.cancel",defaultMessage:"Cancel"}),back:t.formatMessage({id:"sources.back",defaultMessage:"Back"})},fields:[{nextStep:p,title:t.formatMessage({id:"sources.selectApp",defaultMessage:"Select application"}),name:"selectAppStep",fields:[{component:"description",name:"description",Content:ue,container:c},g,{component:"description",name:"authtypesetter",Content:H,hideField:!0,modifiedValues:o}]},{title:t.formatMessage({id:"sources.reviewDetails",defaultMessage:"Review details"}),name:"summary",fields:[{component:"description",name:"description-summary",Content:_e},{component:"summary",name:"summary",sourceTypes:a,applicationTypes:n}]}].concat(i()(h),l)}]}},Ae=a(352),xe=a(353),we=a(354),Pe=a(390),Ce=a(152),Re=a(391),Ve=a(70),ke=a.n(Ve),De=function(e){var t=e.goToSources,a=e.onReset,n=e.progressStep,i=e.progressTexts;return f.a.createElement(Ce.Bullseye,null,f.a.createElement(Ae.EmptyState,{variant:Ae.EmptyStateVariant.full,className:"ins-c-sources__empty-state"},f.a.createElement(xe.EmptyStateIcon,{icon:ke.a,color:"var(--pf-global--success-color--200)",className:"pf-u-mb-0"}),f.a.createElement(Z.Title,{headingLevel:"h5",size:"lg",className:"pf-u-mt-xl"},f.a.createElement(v.a,{id:"sources.configurationSuccessful",defaultMessage:"Configuration successful"})),f.a.createElement(we.EmptyStateBody,null,f.a.createElement(Re.Progress,{className:"pf-u-mb-md ins-c-sources__progress ins-c-sources__progress-success",value:n,min:0,title:" ",max:i.length-1,label:i[n],valueText:i[n],variant:"success"}),f.a.createElement(v.a,{id:"sources.successAddApp",defaultMessage:"Your application has been successfully added."})),f.a.createElement(J.Button,{variant:"primary",onClick:t,className:"pf-u-mt-xl"},f.a.createElement(v.a,{id:"sources.backToSources",defaultMessage:"Back to Sources"})),f.a.createElement(Pe.EmptyStateSecondaryActions,null,f.a.createElement(J.Button,{variant:"link",onClick:a},f.a.createElement(v.a,{id:"sources.continueManageApp",defaultMessage:"Continue managing applications"})))))};De.propTypes={onReset:U.PropTypes.func.isRequired,goToSources:U.PropTypes.func.isRequired,progressStep:U.PropTypes.number.isRequired,progressTexts:U.PropTypes.arrayOf(U.PropTypes.string).isRequired};var Ne=De,Ie=a(542),Fe=function(e){var t=e.step,a=e.goToSources,n=Object(y.a)();return f.a.createElement(Ie.Wizard,{isOpen:!0,onClose:a,title:n.formatMessage({id:"sources.manageApps",defaultMessage:"Manage applications"}),description:n.formatMessage({id:"sources.addAppDescription",defaultMessage:"You are managing applications of this source."}),steps:[{name:"Finish",component:t,isFinishedStep:!0}]})};Fe.propTypes={step:U.PropTypes.node.isRequired,goToSources:U.PropTypes.func.isRequired};var qe=Fe,Be=a(15),Le=a(378),Ge=a(100),ze=a(91),Ue=a(68),We=a.n(Ue),Qe=a(181),Ye=a.n(Qe),He=a(751),Ke=a(474),Je=a(376),Xe=a(475),Ze=a.n(Xe),$e=a(136),et=function(e,t,a){var n=[],i=0;return!e.endpoint||Ze()(e.endpoint)||z()(t,"endpoint.id",!1)||n.push(a.formatMessage({id:"sources.authProgressEndpoint",defaultMessage:"Step { step }: creating endpoint"},{step:++i})),n.push(a.formatMessage({id:"sources.authProgressValues",defaultMessage:"Step { step }: updating values and creating application"},{step:++i})),n.push(a.formatMessage({id:"sources.authConnectingApplication",defaultMessage:"Step { step }: connecting application and authentication"},{step:++i})),n.push(a.formatMessage({id:"sources.authReloadData",defaultMessage:"Step { step }: reloading data"},{step:++i})),n.push(a.formatMessage({id:"sources.authCompleted",defaultMessage:"Completed"})),n};function tt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function at(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(a),!0).forEach((function(t){de()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var nt=function e(t){return Object.keys(t).forEach((function(a){t[a]&&"object"===Ye()(t[a])?Ze()(t[a])?delete t[a]:e(t[a]):void 0===t[a]&&delete t[a]})),t},it=function(){var e=d()(p.a.mark((function e(t,a,n,i){var r,o,c,u,l,d,m,f,g,h,y,v,b,O,_,j,S,M,A,x,w,P,C,R,V,k,D,N,I,F,q,B,L,G,z,U,W,Q,Y=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Y.length>4&&void 0!==Y[4]?Y[4]:function(){},o=Y.length>5&&void 0!==Y[5]?Y[5]:function(){},c=a.getState(),u=c.values,l=u.authentication?u.authentication.id:void 0,d=l?n.find((function(e){return e.id===l})):void 0,m=t.authentication,f=We()(t,["authentication"]),g=Object(He.addedDiff)(i,f),h=Object(He.updatedDiff)(i,f),y=Object(He.addedDiff)(d,m),v=Object(He.updatedDiff)(d,m),b=nt(at(at({},E()(T()(g),h)),{},{authentication:at({},E()(T()(y),v))})),r({type:"setProgressTexts",progressTexts:et(b,u,o)}),e.prev=13,u.source&&u.source.id){e.next=16;break}throw"Missing source id";case 16:if(O=u.source.id,_=u.endpoint?u.endpoint.id:void 0,j=[],b.source&&!Ze()(b.source)?j.push(Object(Be.j)().updateSource(O,b.source)):j.push(Promise.resolve(void 0)),S=b.endpoint&&!Ze()(b.endpoint),M=b.url&&!Ze()(b.url),!S&&!M){e.next=39;break}if(A=Object($e.b)(b),x=A.scheme,w=A.host,P=A.port,C=A.path,R=parseInt(P,10),V=nt(at(at({},b.endpoint),{},{scheme:x,host:w,port:isNaN(R)?void 0:R,path:C})),!_){e.next=30;break}j.push(Object(Be.j)().updateEndpoint(_,V)),e.next=37;break;case 30:return j.push(Promise.resolve(void 0)),k=at(at({},V),{},{default:!0,source_id:O}),e.next=34,Object(Be.j)().createEndpoint(k);case 34:D=e.sent,r({type:"increaseProgressStep"}),_=D.id;case 37:e.next=40;break;case 39:j.push(Promise.resolve(void 0));case 40:return b.authentication&&!Ze()(b.authentication)?l?j.push(Object(Be.j)().updateAuthentication(l,b.authentication)):_&&(N=at(at({},b.authentication),{},{resource_id:_,resource_type:"Endpoint"}),j.push(Object(Be.j)().createAuthentication(N))):j.push(Promise.resolve(void 0)),b.application&&b.application.application_type_id?j.push(Object(Be.b)(O,b.application.application_type_id)):j.push(Promise.resolve(void 0)),e.next=44,Promise.all(j);case 44:return I=e.sent,F=s()(I,4),F[0],F[1],q=F[2],B=F[3],r({type:"increaseProgressStep"}),L=l||(q?q.id:void 0),G=[],B&&B.id&&L&&(z={application_id:B.id,authentication_id:L},G.push(Object(Be.j)().createAuthApp(z))),(b.credentials||b.billing_source)&&(U=b.credentials,W=b.billing_source,Q={},Q=U?{authentication:{credentials:U}}:{},Q=W?at(at({},Q),{},{billing_source:W}):Q,G.push(Object(Ke.patchSource)(at({id:O},Q)))),e.next=58,Promise.all(G);case 58:r({type:"increaseProgressStep"}),e.next=67;break;case 61:return e.prev=61,e.t0=e.catch(13),e.next=65,Object(Je.handleError)(e.t0);case 65:throw e.sent;case 67:case"end":return e.stop()}}),e,null,[[13,61]])})));return function(t,a,n,i){return e.apply(this,arguments)}}(),rt=a(438);function st(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ot(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?st(Object(a),!0).forEach((function(t){de()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):st(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ct={state:"loading",error:"",values:{},authenticationsValues:[],sourceAppsLength:0,initialValues:{},progressStep:0,progressTexts:[],isCancelling:!1},ut=function(e,t){var a=t.type,n=t.length,i=t.authenticationsValues,r=t.initialValues,s=t.error,o=t.values,c=t.progressTexts;switch(a){case"setSourceAppslength":return ot(ot({},e),{},{sourceAppsLength:n});case"loadAuthentications":return ot(ot({},e),{},{authenticationsValues:i,initialValues:r,values:{},state:"loading"===e.state?"wizard":e.state});case"loadWithoutAuthentications":return ot(ot({},e),{},{initialValues:r,values:{},state:"loading"===e.state?"wizard":e.state});case"reset":return ot(ot({},e),{},{state:"wizard"});case"submit":return ot(ot({},e),{},{state:"submitting",progressStep:0,progressTexts:["Preparing"]});case"finish":return ot(ot({},e),{},{state:"finished",progressStep:++e.progressStep});case"error":return ot(ot({},e),{},{state:"errored",error:s,values:o});case"setProgressTexts":return ot(ot({},e),{},{progressTexts:c});case"increaseProgressStep":return ot(ot({},e),{},{progressStep:++e.progressStep});case"toggleCancelling":return ot(ot({},e),{},{isCancelling:!e.isCancelling},o&&{values:o});default:return e}},pt=void 0,lt=function(e){var t=e.values.application;return pt=t},dt=function(e,t,a,n,i,r,s){return i({type:"submit"}),it(e,t,a,r,i,s).then(d()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(rt.a)(r.source.id),e.next=3,n(Object(V.f)());case 3:return pt=void 0,e.abrupt("return",i({type:"finish"}));case 5:case"end":return e.stop()}}),e)})))).catch((function(t){return i({type:"error",error:t,values:e})}))},mt=function(e){return f.a.createElement(R.a,c()({},e,{showFormControls:!1}))};t.default=function(){var e=Object(y.a)(),t=Object(g.f)(),a=Object(Le.a)(),n=Object(h.useSelector)((function(e){return e.sources}),h.shallowEqual),r=n.appTypes,o=n.sourceTypesLoaded,c=n.appTypesLoaded,u=n.sourceTypes,p=Object(te.a)(),l=Object(h.useDispatch)(),d=Object(m.useReducer)(ut,ct),b=s()(d,2),O=b[0],_=b[1],S=Object(m.useRef)(document.createElement("div"));Object(m.useEffect)((function(){pt=void 0}),[]),Object(m.useEffect)((function(){if(p){var e=O.sourceAppsLength>=p.applications.length&&O.sourceAppsLength>0;_({type:"setSourceAppslength",length:p.applications.length}),e||(p.endpoints&&p.endpoints[0]?Object(Be.j)().listEndpointAuthentications(p.endpoints[0].id).then((function(e){var t=e.data;return _({type:"loadAuthentications",authenticationsValues:t,initialValues:{source:p,endpoint:p.endpoints[0],url:Object(Ge.b)(p.endpoints[0]),application:pt},values:{}})})):_({type:"loadWithoutAuthentications",initialValues:{source:p,application:pt},values:{}}))}}),[p]);var A=function(){return t.push(ze.c.sources.path)};if(!(c&&o&&a&&"loading"!==O.state||"submitting"===O.state))return f.a.createElement(qe,{goToSources:A,step:f.a.createElement(x.a,{customText:e.formatMessage({id:"sources.loading",defaultMessage:"Loading, please wait."}),cancelTitle:f.a.createElement(v.a,{id:"sources.cancel",defaultMessage:"Cancel"})})});if("submitting"===O.state)return f.a.createElement(qe,{goToSources:A,step:f.a.createElement(x.a,{progressStep:O.progressStep,progressTexts:O.progressTexts,cancelTitle:f.a.createElement(v.a,{id:"sources.cancel",defaultMessage:"Cancel"})})});var w=function(){return _({type:"reset"})};if("wizard"!==O.state){var C="finished"===O.state?f.a.createElement(Ne,{onReset:w,goToSources:A,progressStep:O.progressStep,progressTexts:O.progressTexts}):f.a.createElement(P.a,{onRetry:w,onClose:A,message:O.error,progressStep:O.progressStep,progressTexts:O.progressTexts,customText:f.a.createElement(v.a,{id:"sources.successAddApp",defaultMessage:"Your application has not been successfully added:"}),title:f.a.createElement(v.a,{id:"sources.configurationSuccessful",defaultMessage:"Configuration unsuccessful"}),returnButtonTitle:f.a.createElement(v.a,{id:"sources.backToSources",defaultMessage:"Back to Sources"}),retryText:f.a.createElement(v.a,{id:"sources.retry",defaultMessage:"Retry"})});return f.a.createElement(qe,{goToSources:A,step:C})}var R=p.applications.filter((function(e){return!e.isDeleting})).reduce((function(e,t){return[].concat(i()(e),[t.application_type_id])}),[]),V=u.find((function(e){return e.id===p.source_type_id})),D=V&&V.name,N=r.filter((function(e){return!R.includes(e.id)&&e.supported_source_types.includes(D)})).filter(j.a),I=N.map((function(t){var a=p.applications.find((function(e){return e.application_type_id===t.id})),n="".concat(t.display_name," ").concat(a?"(".concat(e.formatMessage({id:"sources.currentlyRemoving",defaultMessage:"Currently removing"}),")"):"");return{value:t.id,label:n,isDisabled:!!a}})),F=Me(I,e,u,r,O.authenticationsValues,p,O.values,S.current),q=N.length>0?function(t,a){return dt(t,a,O.authenticationsValues,l,_,O.initialValues,e)}:A,B=E()(T()(O.initialValues),O.values);return f.a.createElement(f.a.Fragment,null,f.a.createElement(M.a,{title:e.formatMessage({id:"sources.manageAppsCloseModalTitle",defaultMessage:"Exit application adding?"}),isOpen:O.isCancelling,onStay:function(){S.current.hidden=!1,_({type:"toggleCancelling"})},onExit:A}),f.a.createElement(k.a,{schema:F,showFormControls:!1,onSubmit:q,onCancel:function(e){(null==e?void 0:e.application)?(S.current.hidden=!0,_({type:"toggleCancelling",values:e})):A()},initialValues:B,subscription:{values:!0},debug:lt,clearedValue:null,FormTemplate:mt}))}}}]);
//# sourceMappingURL=../sourcemaps/addApp.js.map