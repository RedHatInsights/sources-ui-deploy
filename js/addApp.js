(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{294:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(290),r=a.n(n),i=a(0),s=a.n(i),o=a(3),c=a.n(o),u=a(378),l=a.n(u),p=a(43),d=a(333),m="edit-field",f=function(e){var t=e.isRequired,a=e.label,n=e.helperText,r=e.hideLabel,i=e.meta,o=e.input,c=e.type,u=e.setEdit,m=i.error,f=i.touched&&m,h=o.value;"boolean"==typeof h&&(h=h?"True":"False");var y="password"===c||o.name.includes("password")?"Click to edit":"Click to add";return s.a.createElement(d.FormGroup,{isRequired:t,label:!r&&a,fieldId:o.name,isValid:!f,helperText:n,helperTextInvalid:m,onClick:u?function(){return u(o.name)}:void 0,tabIndex:0,onKeyPress:function(e){32===e.charCode&&u&&(e.preventDefault(),u(o.name))}},s.a.createElement("div",{className:"pf-c-form__horizontal-group ins-c-sources__edit-field-group ".concat(u?"clickable":"")},s.a.createElement(p.TextContent,{className:"ins-c-sources__edit-field-group-text-content ".concat(u?"clickable":"")},s.a.createElement("span",{className:"ins-c-sources__edit-field-value pf-u-mr-sm"},h||(u?y:"")),u&&s.a.createElement(l.a,null))))};f.propTypes={label:c.a.node,isRequired:c.a.bool,helperText:c.a.string,meta:c.a.object.isRequired,FieldProvider:c.a.oneOfType([c.a.node,c.a.func]),input:c.a.shape({value:c.a.any,name:c.a.string.isRequired}).isRequired,hideLabel:c.a.bool,setEdit:c.a.func,type:c.a.string};var h=function(e){var t=e.FieldProvider,a=r()(e,["FieldProvider"]);return s.a.createElement(t,a,(function(e){return s.a.createElement(f,e)}))};h.propTypes={FieldProvider:c.a.oneOfType([c.a.node,c.a.func]).isRequired},t.b=h},377:function(e,t,a){"use strict";var n=a(306),r=a.n(n),i=a(1),s=a.n(i),o=a(0),c=a.n(o),u=a(281),l=a.n(u),p=a(332),d=a(286),m=a(294);function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.a=function(e){return c.a.createElement(l.a,r()({layoutMapper:p.layoutMapper,formFieldsMapper:h({},p.formFieldsMapper,{},d.mapperExtension,{"edit-field":m.b})},e))}},404:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(3),s=a.n(i),o=a(30),c=a(11),u=a(26),l=a(43),p=a(78),d=a(314),m=a(315),f=a(285),h=function(e){var t=e.setApplicationToRemove,a=e.breakpoints,n=e.namePrefix,i=Object(o.useSelector)((function(e){return e.sources.appTypes})),s=Object(f.a)(),h=s.applications.map((function(e){var t=e.application_type_id,a=i.find((function(e){return e.id===t}));return a?a.display_name:void 0}));return s.applications.filter((function(e){return!e.isDeleting})).map((function(e){var t=i.find((function(t){return t.id===e.application_type_id}));if(t)return{display_name:t.display_name,id:e.id,dependent_applications:t.dependent_applications}})).sort((function(e,t){return e.display_name.localeCompare(t.display_name)})).map((function(e){var i=e.display_name,s=e.id,o=e.dependent_applications;return r.a.createElement(l.TextContent,{key:s},r.a.createElement(d.Grid,null,r.a.createElement(m.GridItem,{md:a.display_name||4},r.a.createElement(u.Text,{component:u.TextVariants.p,style:{marginBottom:0}},n,i)),r.a.createElement(m.GridItem,{md:a.remove||8,className:"ins-c-sources__remove-app"},r.a.createElement(p.Button,{variant:p.ButtonVariant.link,isInline:!0,onClick:function(){return t({id:s,display_name:i,dependent_applications:o,sourceAppsNames:h})}},r.a.createElement(c.a,{id:"sources.remove",defaultMessage:"Remove"})))))}))};h.propTypes={setApplicationToRemove:s.a.func.isRequired,breakpoints:s.a.shape({display_name:s.a.number,remove:s.a.number}),namePrefix:s.a.node},h.defaultProps={breakpoints:{}},t.a=h},405:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(3),s=a.n(i),o=a(30),c=a(276),u=a(11),l=a(26),p=a(43),d=a(78),m=a(331),f=a(330),h=a(344),y=a(342),g=a(62),v=a.n(g),b=a(44),E=a(285),O=function(e){var t=e.app,a=e.onCancel,n=Object(c.a)(),i=Object(o.useSelector)((function(e){return e.sources.appTypes})),s=Object(E.a)(),g=Object(o.useDispatch)(),O=t.dependent_applications.map((function(e){var a=i.find((function(t){return t.name===e}));return a&&t.sourceAppsNames.includes(a.display_name)?a.display_name:void 0})).filter((function(e){return e}));return r.a.createElement(y.Modal,{className:"ins-c-sources__dialog--warning",title:"Remove ".concat(t.display_name," application"),isOpen:!0,isSmall:!0,onClose:a,isFooterLeftAligned:!0,actions:[r.a.createElement(d.Button,{id:"deleteSubmit",key:"submit",variant:"danger",type:"button",onClick:function(){var e=n.formatMessage({id:"sources.removeAppWarning",defaultMessage:"{ name } was removed from this source."},{name:t.display_name}),r=n.formatMessage({id:"sources.removeAppError",defaultMessage:"Removing of { name } application from this source was unsuccessful."},{name:t.display_name});return a(),g(Object(b.j)(t.id,s.id,e,r))}},r.a.createElement(u.a,{id:"sources.remove",defaultMessage:"Remove"})),r.a.createElement(d.Button,{id:"deleteCancel",key:"cancel",variant:"link",type:"button",onClick:a},r.a.createElement(u.a,{id:"sources.cancel",defaultMessage:"Cancel"}))]},r.a.createElement(m.Split,{gutter:"md"},r.a.createElement(f.SplitItem,null,r.a.createElement(v.a,{size:"xl",className:"ins-m-alert ins-c-source__delete-icon"})),r.a.createElement(f.SplitItem,{isFilled:!0},r.a.createElement(h.Stack,{gutter:"md"},r.a.createElement(p.TextContent,null,r.a.createElement(l.Text,{component:l.TextVariants.p},r.a.createElement(u.a,{id:"sources.deleteAppWarning",defaultMessage:"Are you sure to remove { appName } from this source?",values:{appName:t.display_name}})),O.length>0&&r.a.createElement(l.Text,{component:l.TextVariants.p},r.a.createElement(u.a,{id:"sources.deleteAppDetails",defaultMessage:"This change will affect these applications: { apps }.",values:{apps:O}})))))))};O.propTypes={app:s.a.shape({id:s.a.string.isRequired,display_name:s.a.string.isRequired,dependent_applications:s.a.arrayOf(s.a.string),sourceAppsNames:s.a.arrayOf(s.a.string)}).isRequired,onCancel:s.a.func.isRequired},t.a=O},686:function(e,t,a){"use strict";a.r(t),a.d(t,"onSubmit",(function(){return qe}));var n=a(24),r=a.n(n),i=a(37),s=a.n(i),o=a(1),c=a.n(o),u=a(68),l=a.n(u),p=a(87),d=a.n(p),m=a(0),f=a.n(m),h=a(29),y=a(30),g=a(276),v=a(409),b=a.n(v),E=a(412),O=a.n(E),T=a(286),_=a(44),j=a(377),S=a(281),M=a(26),A=a(43),x=a(11),w=a(295),k=a.n(w),C=a(443),R=a(405),P=a(404),V=a(285),q=function(){var e=Object(m.useState)({}),t=s()(e,2),a=t[0],n=t[1],r=Object(y.useSelector)((function(e){return e.sources.sourceTypes})),i=Object(V.a)(),o=r.find((function(e){return e.id===i.source_type_id})),c=i.applications.filter((function(e){return!e.isDeleting}));return f.a.createElement(f.a.Fragment,null,a.id&&f.a.createElement(R.a,{app:a,onCancel:function(){return n({})}}),f.a.createElement(A.TextContent,null,f.a.createElement(C.Grid,{gutter:"md"},f.a.createElement(C.GridItem,{md:2},f.a.createElement(M.Text,{component:M.TextVariants.h4},f.a.createElement(x.a,{id:"sources.sourceName",defaultMessage:"Source name"}))),f.a.createElement(C.GridItem,{md:2},f.a.createElement(M.Text,{component:M.TextVariants.h4},f.a.createElement(x.a,{id:"sources.type",defaultMessage:"Type"}))),f.a.createElement(C.GridItem,{md:8},f.a.createElement(M.Text,{component:M.TextVariants.h4},f.a.createElement(x.a,{id:"sources.apps",defaultMessage:"Applications"}))),f.a.createElement(C.GridItem,{md:2},f.a.createElement(M.Text,{component:M.TextVariants.p},i.name)),f.a.createElement(C.GridItem,{md:2},f.a.createElement(M.Text,{component:M.TextVariants.p},o?o.product_name:f.a.createElement(x.a,{id:"sources.typeNotFound",defaultMessage:"Type not found"}))),f.a.createElement(C.GridItem,{md:8},c.length>0?f.a.createElement(P.a,{setApplicationToRemove:n}):f.a.createElement(x.a,{id:"sources.noApps",defaultMessage:"No applications"})))))},D=a(3),B=a.n(D),I=function(e){var t=e.formOptions,a=e.authenticationValues,n=e.modifiedValues,r=Object(m.useState)((function(){return function(t){return e!==t&&(e=t,!0)};var e})),i=s()(r,1)[0],o=Object(y.useSelector)((function(e){return e.sources}),y.shallowEqual),c=o.appTypes,u=o.sourceTypes,l=Object(V.a)();return Object(m.useEffect)((function(){!function(e){var t=e.sourceTypes,a=e.source,n=e.appTypes,r=e.formOptions,i=e.checkAuthType,s=e.authenticationValues,o=e.modifiedValues,c=t.find((function(e){return e.id===a.source_type_id})),u=r.getState(),l=n.find((function(e){return e.id===k()(u,"values.application.application_type_id",void 0)})),p=k()(l,"supported_authentication_types[".concat(c.name,"][0]"),"");if(i(p)){r.change("supported_auth_type",p);var d=s.find((function(e){return e.authtype===p}));if(d)if(o&&o.authentication){var m=b()(O()(d),o.authentication);r.change("authentication",m)}else r.change("authentication",d);else o&&o.authentication?r.change("authentication",o.authentication):r.change("authentication",void 0)}}({sourceTypes:u,checkAuthType:i,formOptions:t,authenticationValues:a,appTypes:c,source:l,modifiedValues:n})})),null};I.propTypes={formOptions:B.a.shape({getState:B.a.func.isRequired,change:B.a.func.isRequired}).isRequired,authenticationValues:B.a.arrayOf(B.a.object),modifiedValues:B.a.object};var F=function(){return f.a.createElement(A.TextContent,null,f.a.createElement(M.Text,{component:M.TextVariants.p},f.a.createElement(x.a,{id:"sources.allApplicationsAssigned",defaultMessage:"All available applications have already been added to this source or there is no available application for this source type."})))},N=function(){return f.a.createElement(A.TextContent,null,f.a.createElement(M.Text,{component:M.TextVariants.p},f.a.createElement(x.a,{id:"sources.reviewAddAppSummary",defaultMessage:"Review the information below and click Add to add the application to your source. Use the Back button to make changes."})))},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return e.find((function(e){return e.authtype===k()(t,"supported_authentication_types.".concat(a,"[0]"))}))},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,c=e.length>0,u=c?"summary":void 0,l=[];if(!s.imported&&c){var p=a.find((function(e){return e.id===s.source_type_id})),d=p.schema.endpoint.hidden?p.schema.endpoint.fields:[],m=0===d.length;n.forEach((function(e){if(e.supported_source_types.includes(p.name)){var t=L(i,e,p.name);l.push(T.schemaBuilder.createSpecificAuthTypeSelection(p,e,d,!1,t))}})),p.schema.authentication.forEach((function(e){n.forEach((function(t){if(t.supported_source_types.includes(p.name)){var a=T.schemaBuilder.getAdditionalSteps(p.name,e.type,t.name);if(a.length>0){var n=L(i,t,p.name);l.push.apply(l,r()(T.schemaBuilder.createAdditionalSteps(a,p.name,e.type,m,e.fields,t.name,n)))}}}))})),m&&l.push(T.schemaBuilder.createEndpointStep(p.schema.endpoint,p.name)),u=function(e){var t=e.values.application,a=t||{},n=a.application_type_id?a.application_type_id:"";return"".concat(p.name,"-").concat(n)}}var f=c?{component:"card-select",name:"application.application_type_id",options:e,label:t.formatMessage({id:"sources.chooseAppToAdd",defaultMessage:"Choose an application to add"}),DefaultIcon:null,isRequired:!0,validate:[{type:S.validatorTypes.REQUIRED}]}:{component:"description",name:"description-no-options",validate:[{type:S.validatorTypes.REQUIRED}],Content:F};return{fields:[{component:S.componentTypes.WIZARD,name:"wizard",title:t.formatMessage({id:"sources.manageApps",defaultMessage:"Manage applications"}),inModal:!0,predictSteps:!0,showTitles:!0,crossroads:["application.application_type_id"],description:t.formatMessage({id:"sources.addAppDescription",defaultMessage:"You are managing applications of this source."}),buttonLabels:{submit:c?t.formatMessage({id:"sources.add",defaultMessage:"Add"}):t.formatMessage({id:"sources.close",defaultMessage:"Close"}),cancel:t.formatMessage({id:"sources.cancel",defaultMessage:"Cancel"}),back:t.formatMessage({id:"sources.back",defaultMessage:"Back"})},fields:[{nextStep:u,title:t.formatMessage({id:"sources.selectApp",defaultMessage:"Select application"}),stepKey:1,name:"selectAppStep",fields:[{component:"description",name:"description",Content:q},f,{component:"description",name:"authtypesetter",Content:I,authenticationValues:i,hideField:!0,modifiedValues:o}]},{title:t.formatMessage({id:"sources.review",defaultMessage:"Review"}),stepKey:"summary",name:"summary",fields:[{component:"description",name:"description-summary",Content:N},{component:"summary",name:"summary",sourceTypes:a,applicationTypes:n}]}].concat(l)}]}},G=a(78),U=a(298),W=a(299),Y=a(335),K=a(80),J=a(318),Q=function(e){var t=e.onClose,a=e.customText;return f.a.createElement(K.Bullseye,null,f.a.createElement(U.EmptyState,{variant:U.EmptyStateVariant.full},f.a.createElement(J.Spinner,null),f.a.createElement(W.EmptyStateBody,null,a),t&&f.a.createElement(Y.EmptyStateSecondaryActions,null,f.a.createElement(G.Button,{variant:"link",onClick:t},f.a.createElement(x.a,{id:"sources.cancel",defaultMessage:"Cancel"})))))};Q.propTypes={onClose:B.a.func,customText:B.a.node},Q.defaultProps={customText:f.a.createElement(x.a,{id:"sources.loading",defaultMessage:"Loading, please wait."})};var Z=Q,H=a(307),X=a(127),$=a(83),ee=a.n($),te=function(e){var t=e.onClose,a=e.onRetry,n=e.message,r=e.title;return f.a.createElement(K.Bullseye,null,f.a.createElement(U.EmptyState,{variant:U.EmptyStateVariant.full},f.a.createElement(H.EmptyStateIcon,{icon:ee.a,color:"var(--pf-global--danger-color--100)"}),f.a.createElement(X.Title,{headingLevel:"h5",size:"lg"},r),f.a.createElement(W.EmptyStateBody,null,n),f.a.createElement(G.Button,{variant:"primary",onClick:t},f.a.createElement(x.a,{id:"sources.backToSources",defaultMessage:"Back to Sources"})),a&&f.a.createElement(Y.EmptyStateSecondaryActions,null,f.a.createElement(G.Button,{variant:"link",onClick:a},f.a.createElement(x.a,{id:"sources.retry",defaultMessage:"Retry"})))))};te.propTypes={onClose:B.a.func.isRequired,message:B.a.node.isRequired,title:B.a.node.isRequired,onRetry:B.a.func};var ae=te,ne=function(e){var t=e.setState,a=e.goToSources,n=e.error;return f.a.createElement(ae,{onClose:a,message:f.a.createElement(f.a.Fragment,null,f.a.createElement(x.a,{id:"sources.successAddApp",defaultMessage:"Your application has not been successfully added:"}),f.a.createElement("br",null),f.a.createElement(A.TextContent,null,f.a.createElement(M.Text,{component:M.TextVariants.h6},n))),title:f.a.createElement(x.a,{id:"sources.configurationSuccessful",defaultMessage:"Configuration unsuccessful"}),onRetry:function(){return t({state:"wizard"})}})};ne.propTypes={setState:D.PropTypes.func.isRequired,goToSources:D.PropTypes.func.isRequired,error:D.PropTypes.string.isRequired};var re=ne,ie=a(63),se=a.n(ie),oe=function(e){var t=e.onClose,a=e.title,n=e.successfulMessage,r=e.secondaryActions;return f.a.createElement(K.Bullseye,null,f.a.createElement(U.EmptyState,{variant:U.EmptyStateVariant.full},f.a.createElement(H.EmptyStateIcon,{icon:se.a,color:"var(--pf-global--success-color--100)"}),f.a.createElement(X.Title,{headingLevel:"h5",size:"lg"},a),f.a.createElement(W.EmptyStateBody,null,n),f.a.createElement(G.Button,{variant:"primary",onClick:t},f.a.createElement(x.a,{id:"sources.backToSources",defaultMessage:"Back to Sources"})),r&&f.a.createElement(Y.EmptyStateSecondaryActions,null,r)))};oe.propTypes={onClose:B.a.func.isRequired,successfulMessage:B.a.node.isRequired,title:B.a.node.isRequired,secondaryActions:B.a.node};var ce=oe,ue=function(e){var t=e.setState,a=e.goToSources;return f.a.createElement(ce,{onClose:a,successfulMessage:f.a.createElement(x.a,{id:"sources.successAddApp",defaultMessage:"Your application has been successfully added."}),title:f.a.createElement(x.a,{id:"sources.configurationSuccessful",defaultMessage:"Configuration successful"}),secondaryActions:f.a.createElement(G.Button,{variant:"link",onClick:function(){return t({state:"wizard"})}},f.a.createElement(x.a,{id:"sources.continueManageApp",defaultMessage:"Continue managing applications"}))})};ue.propTypes={setState:D.PropTypes.func.isRequired,goToSources:D.PropTypes.func.isRequired};var le=ue,pe=a(454),de=function(e){var t=e.step,a=e.goToSources,n=Object(g.a)();return f.a.createElement(pe.Wizard,{isOpen:!0,onClose:a,title:n.formatMessage({id:"sources.manageApps",defaultMessage:"Manage applications"}),description:n.formatMessage({id:"sources.addAppDescription",defaultMessage:"You are managing applications of this source."}),steps:[{name:"Finish",component:t,isFinishedStep:!0}]})};de.propTypes={step:D.PropTypes.node.isRequired,goToSources:D.PropTypes.func.isRequired};var me=de,fe=a(14),he=a(321),ye=a(85),ge=a(79),ve=a(290),be=a.n(ve),Ee=a(154),Oe=a.n(Ee),Te=a(677),_e=a(425),je=a.n(_e),Se=a(112);function Me(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ae(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(a),!0).forEach((function(t){c()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Me(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var xe=function e(t){return Object.keys(t).forEach((function(a){t[a]&&"object"===Oe()(t[a])?je()(t[a])?delete t[a]:e(t[a]):void 0===t[a]&&delete t[a]})),t},we=function(){var e=d()(l.a.mark((function e(t,a,n,r){var i,o,c,u,p,d,m,f,h,y,g,v,E,_,j,S,M,A,x,w,k,C,R,P,V,q,D,B,I,F,N,L,z,G,U,W;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.getState(),o=i.values,c=o.authentication?o.authentication.id:void 0,u=c?n.find((function(e){return e.id===c})):void 0,p=t.authentication,d=be()(t,["authentication"]),m=Object(Te.addedDiff)(r,d),f=Object(Te.updatedDiff)(r,d),h=Object(Te.addedDiff)(u,p),y=Object(Te.updatedDiff)(u,p),g=xe(Ae({},b()(O()(m),f),{authentication:Ae({},b()(O()(h),y))})),e.prev=10,o.source&&o.source.id){e.next=13;break}throw"Missing source id";case 13:if(v=o.source.id,E=o.endpoint?o.endpoint.id:void 0,_=[],g.source&&!je()(g.source)?_.push(Object(fe.i)().updateSource(v,g.source)):_.push(Promise.resolve(void 0)),j=g.endpoint&&!je()(g.endpoint),S=g.url&&!je()(g.url),!j&&!S){e.next=35;break}if(M=Object(Se.b)(g),A=M.scheme,x=M.host,w=M.port,k=M.path,C=parseInt(w,10),R=xe(Ae({},g.endpoint,{scheme:A,host:x,port:isNaN(C)?void 0:C,path:k})),!E){e.next=27;break}_.push(Object(fe.i)().updateEndpoint(E,R)),e.next=33;break;case 27:return _.push(Promise.resolve(void 0)),P=Ae({},R,{default:!0,source_id:v}),e.next=31,Object(fe.i)().createEndpoint(P);case 31:V=e.sent,E=V.id;case 33:e.next=36;break;case 35:_.push(Promise.resolve(void 0));case 36:return g.authentication&&!je()(g.authentication)?c?_.push(Object(fe.i)().updateAuthentication(c,g.authentication)):E&&(q=Ae({},g.authentication,{resource_id:E,resource_type:"Endpoint"}),_.push(Object(fe.i)().createAuthentication(q))):_.push(Promise.resolve(void 0)),g.application&&g.application.application_type_id?_.push(Object(fe.b)(v,g.application.application_type_id)):_.push(Promise.resolve(void 0)),e.next=40,Promise.all(_);case 40:return D=e.sent,B=s()(D,4),B[0],B[1],I=B[2],F=B[3],N=c||(I?I.id:void 0),L=[],F&&F.id&&N&&(z={application_id:F.id,authentication_id:N},L.push(Object(fe.i)().createAuthApp(z))),(g.credentials||g.billing_source)&&(G=g.credentials,U=g.billing_source,W={},W=G?{authentication:{credentials:G}}:{},W=U?Ae({},W,{billing_source:U}):W,L.push(Object(T.patchSource)(Ae({id:v},W)))),e.next=53,Promise.all(L);case 53:e.next=61;break;case 55:return e.prev=55,e.t0=e.catch(10),e.next=59,Object(T.handleError)(e.t0);case 59:throw e.sent;case 61:case"end":return e.stop()}}),e,null,[[10,55]])})));return function(t,a,n,r){return e.apply(this,arguments)}}(),ke=a(482),Ce=a(365);function Re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Pe=void 0,Ve=function(e){var t=e.values.application;return Pe=t},qe=function(e,t,a,n,r,i){return r({state:"submitting"}),we(e,t,a,i).then(d()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(Ce.a)(i.source.id),e.next=3,n(Object(_.g)());case 3:return Pe=void 0,e.abrupt("return",r({state:"finished"}));case 5:case"end":return e.stop()}}),e)})))).catch((function(t){return r({state:"errored",error:t,values:e})}))},De={state:"loading",error:"",values:{},authenticationsValues:[],sourceAppsLength:0,initialValues:{}},Be=function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(a),!0).forEach((function(t){c()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Re(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{},t)};t.default=function(){var e=Object(g.a)(),t=Object(h.f)(),a=Object(he.a)(),n=Object(y.useSelector)((function(e){return e.sources}),y.shallowEqual),i=n.appTypes,o=n.sourceTypesLoaded,c=n.appTypesLoaded,u=n.sourceTypes,l=n.undoValues,p=Object(V.a)(),d=Object(y.useDispatch)(),v=Object(m.useReducer)(Be,De),E=s()(v,2),S=E[0],M=E[1];Object(m.useEffect)((function(){Pe=void 0}),[]),Object(m.useEffect)((function(){if(p){var e=S.sourceAppsLength>=p.applications.length&&S.sourceAppsLength>0;M({sourceAppsLength:p.applications.length}),e||(p.endpoints&&p.endpoints[0]?Object(fe.i)().listEndpointAuthentications(p.endpoints[0].id).then((function(e){var t=e.data;return M({authenticationsValues:t,initialValues:{source:p,endpoint:p.endpoints[0],url:Object(ye.b)(p.endpoints[0]),application:Pe,values:{}}})})).then((function(){"loading"===S.state&&M({state:"wizard"})})):(M({initialValues:{source:p,application:Pe},values:{}}),"loading"===S.state&&M({state:"wizard"})))}}),[p]);var A=function(){return t.push(ge.c.sources.path)};if(!c||!o||!a)return f.a.createElement(me,{goToSources:A,step:f.a.createElement(Z,null)});if("loading"===S.state||"submitting"===S.state)return f.a.createElement(me,{goToSources:A,step:f.a.createElement(Z,null)});if("wizard"!==S.state){var w="finished"===S.state?f.a.createElement(le,{setState:M,goToSources:A}):f.a.createElement(re,{setState:M,goToSources:A,error:S.error});return f.a.createElement(me,{goToSources:A,step:w})}var k=p.applications.filter((function(e){return!e.isDeleting})).reduce((function(e,t){return[].concat(r()(e),[t.application_type_id])}),[]),C=u.find((function(e){return e.id===p.source_type_id})),R=C&&C.name,P=i.filter((function(e){return!k.includes(e.id)&&e.supported_source_types.includes(R)})).filter(T.filterApps),q=P.map((function(t){var a=p.applications.find((function(e){return e.application_type_id===t.id})),n="".concat(t.display_name," ").concat(a?"(".concat(e.formatMessage({id:"sources.currentlyRemoving",defaultMessage:"Currently removing"}),")"):"");return{value:t.id,label:n,isDisabled:!!a}})),D=b()(O()(l),S.values),B=z(q,e,u,i,S.authenticationsValues,p,D),I=P.length>0?function(e,t){return qe(e,t,S.authenticationsValues,d,M,S.initialValues)}:A,F=b()(O()(S.initialValues),D);return f.a.createElement(j.a,{schema:B,showFormControls:!1,onSubmit:I,onCancel:function(a){return function(e){var t=e.values,a=e.dispatch,n=e.history,r=e.intl,i=e.sourceId;if(t&&t.application){var s=Date.now();a(Object(_.b)(r.formatMessage({id:"sources.addApplicationCanceled",defaultMessage:"Adding an application was cancelled"}),"success",f.a.createElement(x.a,{id:"sources.undoMistake",defaultMessage:"{undo} if this was a mistake.",values:{undo:f.a.createElement(ke.a,{messageId:s,values:t,path:Object(ge.b)(ge.c.sourceManageApps.path,i)})}}),s))}a(Object(_.c)()),n.push(ge.c.sources.path)}({values:a,dispatch:d,intl:e,sourceId:p.id,history:t})},initialValues:F,subscription:{values:!0},onStateUpdate:Ve,clearedValue:null})}}}]);
//# sourceMappingURL=../sourcemaps/addApp.js.map