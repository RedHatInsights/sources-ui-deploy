{"version":3,"sources":["webpack://sources-ui/./src/components/FormComponents/Authentication.js","webpack://sources-ui/./src/components/addSourceWizard/SourceAddModal.js","webpack://sources-ui/./src/components/addSourceWizard/EditLink.js","webpack://sources-ui/./src/components/addSourceWizard/FinalWizard.js","webpack://sources-ui/./src/api/createSuperSource.js","webpack://sources-ui/./src/api/createSource.js","webpack://sources-ui/./src/components/addSourceWizard/index.js"],"names":["rest","intl","useIntl","authentication","useFormApi","getState","values","doNotRequirePassword","validate","filter","type","validatorTypes","componentProps","id","isRequired","helperText","formatMessage","defaultMessage","label","Component","componentMapper","componentTypes","initialValues","schema","sourceTypes","isLoading","reducer","state","applicationTypes","container","disableAppSelection","selectedType","initialWizardState","createSchema","filterTypes","filterVendorTypes","filterApps","filterVendorAppTypes","FormTemplateWrapper","props","showFormControls","SourceAddModal","isCancelling","onCancel","onSubmit","useReducer","stateSourceTypes","stateApplicationTypes","dispatch","isMounted","useRef","document","createElement","useEffect","current","promises","push","doLoadSourceTypes","doLoadApplicationTypes","Promise","all","then","data","sourceTypesOut","find","types","Object","prototype","hasOwnProperty","call","applicationTypesOut","style","opacity","Wizard","className","isOpen","onClose","title","wizardTitle","description","wizardDescription","steps","name","component","LoadingStep","isFinishedStep","SourcesFormRenderer","source_type","_formApi","wizardState","FormTemplate","subscription","Authentication","propTypes","PropTypes","product_name","endpoint","display_name","defaultProps","EditLink","message","insights","chrome","getApp","Link","to","Button","variant","target","href","computeSourcesUrl","rel","FinalWizard","step","afterSubmit","afterError","isFinished","isErrored","successfulMessage","hideSourcesButton","returnButtonTitle","reset","createdSource","tryAgain","afterSuccess","useState","isDeletingSource","setIsDeleting","isAfterDeletion","setDeleted","addAnotherSourceButton","onClick","FinishedStep","secondaryActions","customText","computeSourceStatus","ErroredStep","getSourcesApi","deleteSource","computeSourceError","TimeoutStep","source_type_id","AmazonFinishedStep","primaryAction","Text","TextContent","cancelTitle","errorMessage","formData","startDate","Date","bulkCreate","sources","source","source_type_name","authentications","resource_name","resource_type","applications","map","appId","application_type_id","source_name","sourceData","checkSourceStatus","checkStatusPromises","checkAppAvailability","undefined","forEach","authenticationDataOut","handleError","urlOrHost","url","u","URL","scheme","protocol","replace","host","hostname","port","path","pathname","error","console","log","parseUrl","doCreateSource","timetoutedApps","payload","endpoints","hasEndpoint","endPointPort","parseInt","default","isNaN","hasApplication","application","NO_APPLICATION_VALUE","dataOut","app","timeout","includes","Boolean","prepareInitialValues","isSubmitted","toString","AddSourceWizard","submitCallback","formValues","isSuperKey","createSuperSource","timeoutedApps","CloseModal","onExit","onStay","isEmpty","AddSourceButton","setIsOpen"],"mappings":"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","file":"js/addSource.3d72fccf7fc0d3558f81.js","sourcesContent":["import React from 'react';\nimport componentTypes from '@data-driven-forms/react-form-renderer/component-types';\nimport componentMapper from '@data-driven-forms/pf4-component-mapper/component-mapper';\nimport useFormApi from '@data-driven-forms/react-form-renderer/use-form-api';\nimport validatorTypes from '@data-driven-forms/react-form-renderer/validator-types';\nimport { useIntl } from 'react-intl';\n\nconst Authentication = (rest) => {\n  const intl = useIntl();\n  const formOptions = useFormApi();\n\n  const { authentication } = formOptions.getState().values;\n\n  const doNotRequirePassword = rest.validate && rest.validate.filter(({ type }) => type !== validatorTypes.REQUIRED);\n\n  const componentProps = {\n    ...rest,\n    ...(authentication && authentication.id\n      ? {\n          isRequired: false,\n          helperText: intl.formatMessage(\n            {\n              id: 'wizard.changeAuthHelper',\n              defaultMessage: 'Changing this resets your current {label}.',\n            },\n            { label: rest.label }\n          ),\n          validate: doNotRequirePassword,\n        }\n      : {}),\n  };\n\n  const Component = componentMapper[componentTypes.TEXT_FIELD];\n\n  return <Component {...componentProps} />;\n};\n\nexport default Authentication;\n","import React, { useRef, useEffect, useReducer } from 'react';\nimport PropTypes from 'prop-types';\nimport { useIntl } from 'react-intl';\n\nimport FormTemplate from '@data-driven-forms/pf4-component-mapper/form-template';\n\nimport { Wizard } from '@patternfly/react-core';\n\nimport createSchema from './SourceAddSchema';\nimport { doLoadSourceTypes, doLoadApplicationTypes } from '../../api/wizardHelpers';\nimport { wizardDescription, wizardTitle } from './stringConstants';\nimport filterApps, { filterVendorAppTypes } from '../../utilities/filterApps';\nimport filterTypes, { filterVendorTypes } from '../../utilities/filterTypes';\nimport Authentication from '../FormComponents/Authentication';\nimport SourcesFormRenderer from '../../utilities/SourcesFormRenderer';\nimport LoadingStep from '../steps/LoadingStep';\n\nconst initialValues = {\n  schema: {},\n  sourceTypes: [],\n  isLoading: true,\n};\n\nconst reducer = (\n  state,\n  { type, sourceTypes, applicationTypes, container, disableAppSelection, intl, selectedType, initialWizardState }\n) => {\n  switch (type) {\n    case 'loaded':\n      return {\n        ...state,\n        schema: createSchema(\n          sourceTypes.filter(filterTypes).filter(filterVendorTypes),\n          applicationTypes.filter(filterApps).filter(filterVendorAppTypes(sourceTypes)),\n          disableAppSelection,\n          container,\n          intl,\n          selectedType,\n          initialWizardState\n        ),\n        isLoading: false,\n        sourceTypes,\n        applicationTypes,\n      };\n  }\n};\n\nconst FormTemplateWrapper = (props) => <FormTemplate {...props} showFormControls={false} />;\n\nconst SourceAddModal = ({\n  sourceTypes,\n  applicationTypes,\n  disableAppSelection,\n  isCancelling,\n  onCancel,\n  values,\n  onSubmit,\n  selectedType,\n  initialWizardState,\n}) => {\n  const [{ schema, sourceTypes: stateSourceTypes, applicationTypes: stateApplicationTypes, isLoading }, dispatch] = useReducer(\n    reducer,\n    initialValues\n  );\n  const isMounted = useRef(false);\n  const container = useRef(document.createElement('div'));\n  const intl = useIntl();\n\n  useEffect(() => {\n    isMounted.current = true;\n\n    const promises = [];\n    if (!sourceTypes) {\n      promises.push(doLoadSourceTypes());\n    }\n\n    if (!applicationTypes) {\n      promises.push(doLoadApplicationTypes());\n    }\n\n    Promise.all(promises).then((data) => {\n      const sourceTypesOut = data.find((types) => Object.prototype.hasOwnProperty.call(types, 'sourceTypes'));\n      const applicationTypesOut = data.find((types) => Object.prototype.hasOwnProperty.call(types, 'applicationTypes'));\n\n      if (isMounted.current) {\n        dispatch({\n          type: 'loaded',\n          sourceTypes: sourceTypes || sourceTypesOut.sourceTypes,\n          applicationTypes: applicationTypes || applicationTypesOut.applicationTypes,\n          disableAppSelection,\n          container: container.current,\n          intl,\n          selectedType,\n          initialWizardState,\n        });\n      }\n    });\n\n    return () => {\n      isMounted.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    container.current.style.opacity = isCancelling ? 0 : 1;\n  }, [isCancelling]);\n\n  if (isLoading) {\n    return (\n      <Wizard\n        className=\"sources\"\n        isOpen={true}\n        onClose={onCancel}\n        title={wizardTitle()}\n        description={wizardDescription()}\n        steps={[\n          {\n            name: 'Loading',\n            component: <LoadingStep onClose={() => onCancel()} />,\n            isFinishedStep: true,\n          },\n        ]}\n      />\n    );\n  }\n\n  return (\n    <SourcesFormRenderer\n      initialValues={{\n        ...values,\n        ...(selectedType && { source_type: selectedType }),\n      }}\n      schema={schema}\n      onSubmit={(values, _formApi, wizardState) => onSubmit(values, stateSourceTypes, wizardState, stateApplicationTypes)}\n      onCancel={onCancel}\n      FormTemplate={FormTemplateWrapper}\n      subscription={{ values: true }}\n      componentMapper={{\n        authentication: Authentication,\n      }}\n    />\n  );\n};\n\nSourceAddModal.propTypes = {\n  onCancel: PropTypes.func.isRequired,\n  onSubmit: PropTypes.func.isRequired,\n  sourceTypes: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      name: PropTypes.string.isRequired,\n      product_name: PropTypes.string.isRequired,\n      schema: PropTypes.shape({\n        authentication: PropTypes.array,\n        endpoint: PropTypes.object,\n      }),\n    })\n  ),\n  applicationTypes: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      name: PropTypes.string.isRequired,\n      display_name: PropTypes.string.isRequired,\n    })\n  ),\n  values: PropTypes.object,\n  disableAppSelection: PropTypes.bool,\n  isCancelling: PropTypes.bool,\n  selectedType: PropTypes.string,\n  initialWizardState: PropTypes.object,\n};\n\nSourceAddModal.defaultProps = {\n  values: {},\n  disableAppSelection: false,\n};\n\nexport default SourceAddModal;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { useIntl } from 'react-intl';\nimport { Link } from 'react-router-dom';\n\nimport { Button } from '@patternfly/react-core';\nimport computeSourcesUrl from '../../utilities/computeSourcesUrl';\n\nconst EditLink = ({ id }) => {\n  const intl = useIntl();\n  const message = intl.formatMessage({ id: 'wizard.editSource', defaultMessage: 'Edit source' });\n\n  if (insights.chrome.getApp() === 'sources') {\n    return (\n      <Link to={`/sources/detail/${id}`}>\n        <Button variant=\"primary\" className=\"pf-u-mt-xl\">\n          {message}\n        </Button>\n      </Link>\n    );\n  }\n\n  return (\n    <Button\n      variant=\"primary\"\n      className=\"pf-u-mt-xl\"\n      component=\"a\"\n      target=\"_blank\"\n      href={`${computeSourcesUrl()}/detail/${id}`}\n      rel=\"noopener noreferrer\"\n    >\n      {message}\n    </Button>\n  );\n};\n\nEditLink.propTypes = {\n  id: PropTypes.string.isRequired,\n};\n\nexport default EditLink;\n","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { useIntl } from 'react-intl';\n\nimport { Text, TextContent, Button, Wizard } from '@patternfly/react-core';\n\nimport { wizardDescription, wizardTitle } from './stringConstants';\nimport { getSourcesApi } from '../../api/entities';\nimport computeSourceStatus from '../../utilities/computeSourceStatus';\nimport EditLink from './EditLink';\nimport computeSourceError from '../../utilities/computeSourceError';\n\nimport FinishedStep from '../steps/FinishedStep';\nimport LoadingStep from '../steps/LoadingStep';\nimport ErroredStep from '../steps/ErroredStep';\nimport TimeoutStep from '../steps/TimeoutStep';\nimport AmazonFinishedStep from '../steps/AmazonFinishedStep';\n\nconst FinalWizard = ({\n  afterSubmit,\n  afterError,\n  isFinished,\n  isErrored,\n  successfulMessage,\n  hideSourcesButton,\n  returnButtonTitle,\n  reset,\n  createdSource = {},\n  tryAgain,\n  afterSuccess,\n  sourceTypes,\n}) => {\n  const [isDeletingSource, setIsDeleting] = useState();\n  const [isAfterDeletion, setDeleted] = useState();\n\n  const intl = useIntl();\n\n  const removeSource = () => {\n    setIsDeleting(true);\n\n    return getSourcesApi()\n      .deleteSource(createdSource.id)\n      .then(() => {\n        afterSuccess && afterSuccess();\n        setDeleted(true);\n      })\n      .catch(() => setIsDeleting(false));\n  };\n\n  const addAnotherSourceButton = (\n    <Button variant=\"link\" onClick={reset}>\n      {intl.formatMessage({\n        id: 'wizard.addAnotherSource',\n        defaultMessage: 'Add another source',\n      })}\n    </Button>\n  );\n\n  let step;\n  if (isAfterDeletion) {\n    step = (\n      <FinishedStep\n        onClose={afterSubmit}\n        title={intl.formatMessage({ id: 'wizard.removeSourceSuccessTitle', defaultMessage: 'Removing successful' })}\n        successfulMessage={intl.formatMessage({\n          id: 'wizard.removeSourceSuccessDescription',\n          defaultMessage: 'Source was successfully removed.',\n        })}\n        hideSourcesButton={hideSourcesButton}\n        returnButtonTitle={returnButtonTitle}\n        secondaryActions={addAnotherSourceButton}\n      />\n    );\n  } else if (isDeletingSource) {\n    step = (\n      <LoadingStep\n        customText={intl.formatMessage({\n          id: 'wizard.removingSource',\n          defaultMessage: 'Removing source',\n        })}\n      />\n    );\n  } else if (isFinished) {\n    switch (computeSourceStatus(createdSource)) {\n      case 'unavailable':\n        step = (\n          <ErroredStep\n            onClose={afterSubmit}\n            secondaryActions={\n              <Button variant=\"link\" onClick={removeSource}>\n                {intl.formatMessage({ id: 'wizard.removeSource', defaultMessage: 'Remove source' })}\n              </Button>\n            }\n            Component={() => <EditLink id={createdSource.id} />}\n            message={computeSourceError(createdSource, intl)}\n            title={intl.formatMessage({ id: 'wizard.configurationUnsuccessful', defaultMessage: 'Configuration unsuccessful' })}\n          />\n        );\n        break;\n      case 'timeout':\n        step = (\n          <TimeoutStep onClose={afterSubmit} returnButtonTitle={returnButtonTitle} secondaryActions={addAnotherSourceButton} />\n        );\n        break;\n      default:\n        if (createdSource.source_type_id === sourceTypes.find(({ name }) => name === 'amazon')?.id) {\n          step = <AmazonFinishedStep onClose={afterSubmit} />;\n        } else {\n          step = (\n            <FinishedStep\n              onClose={afterSubmit}\n              successfulMessage={successfulMessage}\n              hideSourcesButton={hideSourcesButton}\n              returnButtonTitle={returnButtonTitle}\n              secondaryActions={addAnotherSourceButton}\n            />\n          );\n        }\n\n        break;\n    }\n  } else if (isErrored) {\n    step = (\n      <ErroredStep\n        onClose={afterError}\n        primaryAction={tryAgain}\n        secondaryActions={\n          <Text\n            component=\"a\"\n            target=\"_blank\"\n            href=\"https://access.redhat.com/support/cases/#/case/new/open-case?caseCreate=true\"\n            rel=\"noopener noreferrer\"\n          >\n            {intl.formatMessage({ id: 'wizard.openTicket', defaultMessage: 'Open a support case' })}\n          </Text>\n        }\n        returnButtonTitle={intl.formatMessage({\n          id: 'wizard.retryText',\n          defaultMessage: 'Retry',\n        })}\n      />\n    );\n  } else {\n    step = (\n      <LoadingStep\n        customText={intl.formatMessage({\n          id: 'wizard.loadingText',\n          defaultMessage: 'Validating credentials',\n        })}\n        description={\n          <TextContent>\n            <Text className=\"pf-u-mb-md\">\n              {intl.formatMessage({\n                id: 'wizard.loadingDescription-a',\n                defaultMessage:\n                  // eslint-disable-next-line max-len\n                  \"This might take some time. You'll receive a notification if you are still in the Sources application when the process completes. Otherwise, you can check the status in the main sources table at any time.\",\n              })}\n            </Text>\n            <Text>\n              {intl.formatMessage({\n                id: 'wizard.loadingDescription-b',\n                defaultMessage: 'In the meantime, you can close this window while the validation process continues.',\n              })}\n            </Text>\n          </TextContent>\n        }\n        onClose={afterError}\n        cancelTitle={intl.formatMessage({ id: 'wizard.close', defaultMessage: 'Close' })}\n      />\n    );\n  }\n\n  return (\n    <Wizard\n      className=\"sources\"\n      isOpen={true}\n      onClose={isFinished ? afterSubmit : afterError}\n      title={wizardTitle()}\n      description={wizardDescription()}\n      steps={[\n        {\n          name: 'Finish',\n          component: step,\n          isFinishedStep: true,\n        },\n      ]}\n    />\n  );\n};\n\nFinalWizard.propTypes = {\n  afterSubmit: PropTypes.func.isRequired,\n  afterError: PropTypes.func.isRequired,\n  isFinished: PropTypes.bool.isRequired,\n  isErrored: PropTypes.bool.isRequired,\n  successfulMessage: PropTypes.node.isRequired,\n  hideSourcesButton: PropTypes.bool,\n  returnButtonTitle: PropTypes.node.isRequired,\n  errorMessage: PropTypes.node,\n  reset: PropTypes.func,\n  createdSource: PropTypes.object,\n  tryAgain: PropTypes.func,\n  afterSuccess: PropTypes.func,\n  sourceTypes: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      name: PropTypes.string.isRequired,\n    })\n  ),\n};\n\nexport default FinalWizard;\n","import { getSourcesApi } from './entities';\nimport checkSourceStatus from './checkSourceStatus';\nimport { checkAppAvailability } from './getApplicationStatus';\nimport handleError from './handleError';\n\nconst createSuperSource = async (formData) => {\n  try {\n    const startDate = new Date();\n\n    const sourceData = await getSourcesApi().bulkCreate({\n      sources: [{ ...formData.source, source_type_name: formData.source_type }],\n      authentications: [{ ...formData.authentication, resource_name: formData.source.name, resource_type: 'source' }],\n      applications: formData.applications.map((appId) => ({\n        application_type_id: appId,\n        source_name: formData.source.name,\n      })),\n    });\n\n    await checkSourceStatus(sourceData.sources[0].id);\n\n    const checkStatusPromises = [];\n\n    checkStatusPromises.push(\n      checkAppAvailability(sourceData.authentications[0].id, undefined, undefined, 'showAuthentication', startDate)\n    );\n\n    sourceData.applications.forEach(({ id }) =>\n      checkStatusPromises.push(checkAppAvailability(id, undefined, undefined, 'showApplication', startDate))\n    );\n\n    const [authenticationDataOut, ...applications] = await Promise.all(checkStatusPromises);\n\n    return {\n      ...sourceData,\n      ...sourceData.sources[0],\n      authentications: [authenticationDataOut],\n      applications,\n    };\n  } catch (error) {\n    const errorMessage = await handleError(error);\n    throw errorMessage;\n  }\n};\n\nexport default createSuperSource;\n","import { handleError } from './handleError';\n\nimport { getSourcesApi } from './entities';\nimport { checkAppAvailability } from './getApplicationStatus';\nimport checkSourceStatus from './checkSourceStatus';\nimport { NO_APPLICATION_VALUE } from '../components/addSourceWizard/stringConstants';\n\nexport const parseUrl = (url) => {\n  if (!url) {\n    return {};\n  }\n\n  try {\n    const u = new URL(url);\n    return {\n      scheme: u.protocol.replace(/:$/, ''),\n      host: u.hostname,\n      port: u.port,\n      path: u.pathname,\n    };\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.log(error);\n    return {};\n  }\n};\n\nexport const urlOrHost = (formData) => (formData.url ? parseUrl(formData.url) : formData);\n\nexport const handleErrorWrapper = (sourceId) => async (error) => await handleError(error, sourceId);\n\nexport const doCreateSource = async (formData, timetoutedApps = [], applicationTypes) => {\n  let source;\n  try {\n    const payload = {\n      sources: [{ ...formData.source, source_type_name: formData.source_type }],\n      endpoints: [],\n      authentications: [],\n      applications: [],\n    };\n\n    const hasEndpoint = formData.url || formData.endpoint;\n    if (hasEndpoint) {\n      const { scheme, host, port, path } = urlOrHost(formData);\n\n      const endPointPort = parseInt(port, 10);\n\n      payload.endpoints.push({\n        ...formData.endpoint,\n        default: true,\n        source_name: formData.source.name,\n        scheme,\n        host,\n        port: isNaN(endPointPort) ? undefined : endPointPort,\n        path,\n      });\n    }\n\n    const hasApplication =\n      formData.application?.application_type_id && formData.application?.application_type_id !== NO_APPLICATION_VALUE;\n\n    if (hasApplication) {\n      payload.applications.push({\n        ...formData.application,\n        source_name: formData.source.name,\n      });\n    }\n\n    if (formData.authentication) {\n      payload.authentications.push({\n        ...formData.authentication,\n        resource_type: hasEndpoint ? 'endpoint' : hasApplication ? 'application' : 'source',\n        resource_name: formData.source.name,\n        ...(hasEndpoint && { resource_name: urlOrHost(formData).host }),\n        ...(hasApplication && {\n          resource_name: applicationTypes?.find(({ id }) => id === formData.application.application_type_id)?.name,\n        }),\n      });\n    }\n\n    const dataOut = await getSourcesApi().bulkCreate(payload);\n\n    source = dataOut.sources?.[0];\n    let app = dataOut.applications?.[0];\n    let endpoint = dataOut.endpoints?.[0];\n\n    await checkSourceStatus(source.id);\n\n    if (app) {\n      const timeout = timetoutedApps.includes(app.application_type_id) ? 10000 : 0;\n      app = await checkAppAvailability(app.id, timeout);\n    }\n\n    if (endpoint) {\n      endpoint = await checkAppAvailability(endpoint.id, undefined, undefined, 'getEndpoint');\n    }\n\n    return {\n      ...source,\n      endpoint: [endpoint].filter(Boolean),\n      applications: [app].filter(Boolean),\n    };\n  } catch (error) {\n    const errorMessage = await handleError(error, source ? source.id : undefined);\n    throw errorMessage;\n  }\n};\n","import React, { useState, useReducer } from 'react';\nimport PropTypes from 'prop-types';\nimport isEmpty from 'lodash/isEmpty';\nimport { FormattedMessage } from 'react-intl';\n\nimport { Button } from '@patternfly/react-core';\n\nimport Form from './SourceAddModal';\nimport FinalWizard from './FinalWizard';\n\nimport { wizardTitle } from './stringConstants';\n\nimport isSuperKey from '../../utilities/isSuperKey';\nimport { timeoutedApps } from '../../utilities/constants';\nimport createSuperSource from '../../api/createSuperSource';\nimport { doCreateSource } from '../../api/createSource';\nimport CloseModal from '../CloseModal';\n\nconst prepareInitialValues = (initialValues) => ({\n  isSubmitted: false,\n  isFinished: false,\n  isErrored: false,\n  isCancelling: false,\n  values: initialValues,\n  createdSource: {},\n  error: undefined,\n});\n\nconst reducer = (state, { type, values, data, error, initialValues, sourceTypes, applicationTypes }) => {\n  switch (type) {\n    case 'reset':\n      return prepareInitialValues(initialValues);\n    case 'prepareSubmitState':\n      return {\n        ...state,\n        isFinished: false,\n        isErrored: false,\n        error: undefined,\n        isSubmitted: true,\n        values,\n        sourceTypes,\n        applicationTypes,\n      };\n    case 'setSubmitted':\n      return { ...state, isFinished: true, createdSource: data };\n    case 'setErrored':\n      return { ...state, isErrored: true, error: error.toString() };\n    case 'onStay':\n      return { ...state, isCancelling: false };\n    case 'showCancelModal':\n      return { ...state, isCancelling: true, values };\n  }\n};\n\nconst AddSourceWizard = ({\n  successfulMessage,\n  isOpen,\n  sourceTypes,\n  applicationTypes,\n  disableAppSelection,\n  hideSourcesButton,\n  returnButtonTitle,\n  initialValues,\n  onClose,\n  afterSuccess,\n  selectedType,\n  initialWizardState,\n  submitCallback,\n}) => {\n  const [{ isErrored, isFinished, isSubmitted, values, error, isCancelling, createdSource, ...state }, dispatch] = useReducer(\n    reducer,\n    prepareInitialValues(initialValues)\n  );\n\n  const onSubmit = (formValues, sourceTypes, wizardState, applicationTypes) => {\n    dispatch({ type: 'prepareSubmitState', values: formValues, sourceTypes, applicationTypes });\n\n    const fn = isSuperKey(formValues.source) ? createSuperSource : doCreateSource;\n\n    return fn(formValues, timeoutedApps(applicationTypes), applicationTypes)\n      .then((data) => {\n        afterSuccess && afterSuccess(data);\n        submitCallback && submitCallback({ isSubmitted: true, createdSource: data, sourceTypes });\n        dispatch({ type: 'setSubmitted', data });\n      })\n      .catch((error) => {\n        submitCallback && submitCallback({ isErrored: true, error, values: formValues, sourceTypes, wizardState });\n        dispatch({ type: 'setErrored', error });\n      });\n  };\n\n  const reset = () => dispatch({ type: 'reset', initialValues });\n\n  const afterSubmit = () => {\n    onClose(undefined, createdSource);\n    reset();\n  };\n\n  const onCancelBeforeExit = (values) => (isEmpty(values) ? onClose({}) : dispatch({ type: 'showCancelModal', values }));\n\n  const onExit = () => onClose(values);\n\n  if (!isOpen) {\n    return null;\n  }\n\n  if (!isSubmitted) {\n    return (\n      <React.Fragment>\n        {isCancelling && <CloseModal onExit={onExit} onStay={() => dispatch({ type: 'onStay' })} />}\n        <Form\n          isCancelling={isCancelling}\n          values={values}\n          onSubmit={onSubmit}\n          onCancel={onCancelBeforeExit}\n          sourceTypes={sourceTypes}\n          applicationTypes={applicationTypes}\n          disableAppSelection={disableAppSelection}\n          selectedType={selectedType}\n          initialWizardState={initialWizardState}\n        />\n      </React.Fragment>\n    );\n  }\n\n  return (\n    <FinalWizard\n      afterSubmit={afterSubmit}\n      afterError={() => onClose({})}\n      isFinished={isFinished}\n      isErrored={isErrored}\n      successfulMessage={successfulMessage}\n      hideSourcesButton={hideSourcesButton}\n      returnButtonTitle={returnButtonTitle}\n      errorMessage={error}\n      reset={reset}\n      createdSource={createdSource}\n      tryAgain={() => onSubmit(values, state.sourceTypes, undefined, state.applicationTypes)}\n      afterSuccess={afterSuccess}\n      sourceTypes={state.sourceTypes}\n    />\n  );\n};\n\nAddSourceWizard.propTypes = {\n  afterSuccess: PropTypes.func,\n  sourceTypes: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      name: PropTypes.string.isRequired,\n      product_name: PropTypes.string.isRequired,\n      schema: PropTypes.shape({\n        authentication: PropTypes.array,\n        endpoint: PropTypes.object,\n      }),\n    })\n  ),\n  applicationTypes: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      name: PropTypes.string.isRequired,\n      display_name: PropTypes.string.isRequired,\n    })\n  ),\n  onClose: PropTypes.func.isRequired,\n  isOpen: PropTypes.bool.isRequired,\n  successfulMessage: PropTypes.node,\n  initialValues: PropTypes.shape({\n    [PropTypes.string]: PropTypes.oneOf([PropTypes.string, PropTypes.array, PropTypes.number, PropTypes.bool]),\n  }),\n  disableAppSelection: PropTypes.bool,\n  hideSourcesButton: PropTypes.bool,\n  returnButtonTitle: PropTypes.node,\n  selectedType: PropTypes.string,\n  initialWizardState: PropTypes.object,\n  submitCallback: PropTypes.func,\n};\n\nAddSourceWizard.defaultProps = {\n  successfulMessage: <FormattedMessage id=\"wizard.successfulMessage\" defaultMessage=\"Your source was successfully added.\" />,\n  initialValues: {},\n  returnButtonTitle: <FormattedMessage id=\"wizard.goBackToSources\" defaultMessage=\"Go back to Sources\" />,\n};\n\nconst AddSourceButton = (props) => {\n  const [isOpen, setIsOpen] = useState(false);\n\n  return (\n    <React.Fragment>\n      <Button variant=\"primary\" onClick={() => setIsOpen(true)}>\n        {wizardTitle()}\n      </Button>\n      <AddSourceWizard isOpen={isOpen} onClose={() => setIsOpen(false)} {...props} />\n    </React.Fragment>\n  );\n};\n\nexport { AddSourceButton, AddSourceWizard };\n"],"sourceRoot":""}