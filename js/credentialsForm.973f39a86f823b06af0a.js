(self.webpackChunksources_ui=self.webpackChunksources_ui||[]).push([[8331],{64108:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>R});var r=a(22122),n=a(81253),i=a(92137),s=a(28481),o=a(96156),l=a(87757),u=a.n(l),c=a(80150),d=a.n(c),p=a(86896),f=a(61084),m=a(334),g=a(80236),v=a(2372),h=a(52643),y=a(66187),b=a(11405),w=a(7505),E=a(45697),M=a.n(E),O=a(76429),C=a(67850),j=a(48880),Z=a(68809),P=a(47173),k=a(83115),_=function(e){return d().createElement(k.l,(0,r.Z)({},e,{id:"modal-form"}))},D=function(){var e=(0,p.Z)(),t=(0,j.default)().onCancel;return d().createElement(O.Z,{subscription:{submitting:!0,pristine:!0,invalid:!0,validating:!0}},(function(a){var r=a.pristine,n=a.invalid,i=a.validating,s=a.submitting;return d().createElement("div",{className:"pf-c-form"},d().createElement(Z.W,{className:"pf-u-mt-0"},d().createElement(P.zx,{variant:"primary",form:"modal-form",type:"submit",isDisabled:r||i||s||n},e.formatMessage({id:"sources.submit",defaultMessage:"Submit"})),d().createElement(P.zx,{variant:"link",onClick:t,id:"cancel-modal"},e.formatMessage({id:"sources.cancel",defaultMessage:"Cancel"}))))}))},S=function(e){var t=e.ModalProps,a=(0,n.Z)(e,["ModalProps"]);return d().createElement(g.u,(0,r.Z)({},t,{footer:d().createElement(D,null)}),d().createElement(C.ZP,(0,r.Z)({},a,{showFormControls:!1,FormWrapper:_})))};S.propTypes={ModalProps:M().object};const x=S;var z=a(45857),V=a(39324),N=a(90300);function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,o.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var H={loading:!0,initialValues:{}},I=function(e,t){var a=t.type,r=t.values;switch(a){case"loaded":return F(F({},e),{},{loading:!1,initialValues:{authentication:r}})}};const R=function(){var e=(0,y.L)(),t=(0,m.useHistory)(),a=(0,p.Z)(),o=(0,f.useDispatch)(),l=(0,f.useSelector)((function(e){return e.sources.sourceTypes}),f.shallowEqual),E=l.find((function(t){return t.id===e.source_type_id})).name,M=(0,c.useReducer)(I,H),O=(0,s.Z)(M,2),C=O[0],j=C.loading,Z=C.initialValues,P=O[1],k=function(){return t.push((0,b.yS)(b._j.sourcesDetail.path,e.id))},_=a.formatMessage({id:"editCredentials.title",defaultMessage:"Edit account authorization credentials"}),D=a.formatMessage({id:"editCredentials.description",defaultMessage:"Use the fields below to reset your account authorization credentials. It may take some time to validate new information."});return(0,c.useEffect)((function(){(0,z.Rj)().listSourceAuthentications(e.id).then((function(e){var t,a=e.data,r=null===(t=l.find((function(e){return e.name===E})))||void 0===t?void 0:t.schema.authentication.find((function(e){return e.is_superkey})),n=a.find((function(e){return e.authtype===r.type}));P({type:"loaded",values:n})}))}),[]),j?d().createElement(g.u,{title:_,variant:"small",isOpen:!0,onClose:k},d().createElement(h.b,{className:"pf-u-m-2xl"},d().createElement(v.$,null))):d().createElement(w.Z,{clearedValue:null,schema:{fields:[(0,N.Z)(l,E)]},onSubmit:function(){var e=(0,i.Z)(u().mark((function e(t){var r,i,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.authentication).tenant,r.source_id,i=r.id,r.authtype,r.resource_id,s=(0,n.Z)(r,["tenant","source_id","id","authtype","resource_id"]),k(),e.prev=2,e.next=5,(0,z.Rj)().updateAuthentication(i,s);case 5:o((0,V.Hz)({title:a.formatMessage({id:"editCredentials.alert.title",defaultMessage:"New credentials saved"}),description:a.formatMessage({id:"editCredentials.alert.description",defaultMessage:"It may take some time to validate your new credentials. Check this page for status updates."}),variant:"info"})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),o((0,V.Hz)({title:a.formatMessage({id:"editCredentials.alert.warning.title",defaultMessage:"Error updating credentials"}),description:a.formatMessage({id:"editCredentials.alert.warning.description",defaultMessage:"There was a problem while trying to update credentials. Please try again. If the error persists, open a support case."}),variant:"danger"}));case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),initialValues:Z,FormTemplate:function(e){return d().createElement(x,(0,r.Z)({},e,{ModalProps:{isOpen:!0,onClose:k,variant:"small",title:_,description:D}}))},onCancel:k})}}}]);
//# sourceMappingURL=credentialsForm.973f39a86f823b06af0a.js.map