(self.webpackChunksources_ui=self.webpackChunksources_ui||[]).push([[8331],{64108:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>U});var n=a(67154),r=a.n(n),i=a(87757),s=a.n(i),o=a(6479),l=a.n(o),u=a(48926),c=a.n(u),d=a(63038),p=a.n(d),f=a(59713),m=a.n(f),g=a(80150),v=a.n(g),h=a(86896),y=a(61084),b=a(334),w=a(80236),E=a(2372),M=a(52643),O=a(66187),C=a(11405),j=a(7505),P=a(45697),k=a.n(P),_=a(25607),D=a(81554),S=a(58860),Z=a(68809),x=a(47173),z=a(83115),V=function(e){return v().createElement(z.l,r()({},e,{id:"modal-form"}))},N=function(){var e=(0,h.Z)(),t=(0,S.Z)().onCancel;return v().createElement(_.Z,{subscription:{submitting:!0,pristine:!0,invalid:!0,validating:!0}},(function(a){var n=a.pristine,r=a.invalid,i=a.validating,s=a.submitting;return v().createElement("div",{className:"pf-c-form"},v().createElement(Z.W,{className:"pf-u-mt-0"},v().createElement(x.zx,{variant:"primary",form:"modal-form",type:"submit",isDisabled:n||i||s||r},e.formatMessage({id:"sources.submit",defaultMessage:"Submit"})),v().createElement(x.zx,{variant:"link",onClick:t,id:"cancel-modal"},e.formatMessage({id:"sources.cancel",defaultMessage:"Cancel"}))))}))},T=function(e){var t=e.ModalProps,a=l()(e,["ModalProps"]);return v().createElement(w.u,r()({},t,{footer:v().createElement(N,null)}),v().createElement(D.ZP,r()({},a,{showFormControls:!1,FormWrapper:V})))};T.propTypes={ModalProps:k().object};const F=T;var H=a(45857),I=a(39324),R=a(90300);function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){m()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var q={loading:!0,initialValues:{}},L=function(e,t){var a=t.type,n=t.values;switch(a){case"loaded":return W(W({},e),{},{loading:!1,initialValues:{authentication:n}})}};const U=function(){var e=(0,O.L)(),t=(0,b.useHistory)(),a=(0,h.Z)(),n=(0,y.useDispatch)(),i=(0,y.useSelector)((function(e){return e.sources.sourceTypes}),y.shallowEqual),o=i.find((function(t){return t.id===e.source_type_id})).name,u=(0,g.useReducer)(L,q),d=p()(u,2),f=d[0],m=f.loading,P=f.initialValues,k=d[1],_=function(){return t.push((0,C.yS)(C._j.sourcesDetail.path,e.id))},D=a.formatMessage({id:"editCredentials.title",defaultMessage:"Edit account authorization credentials"}),S=a.formatMessage({id:"editCredentials.description",defaultMessage:"Use the fields below to reset your account authorization credentials. It may take some time to validate new information."});return(0,g.useEffect)((function(){(0,H.Rj)().listSourceAuthentications(e.id).then((function(e){var t,a=e.data,n=null===(t=i.find((function(e){return e.name===o})))||void 0===t?void 0:t.schema.authentication.find((function(e){return e.is_superkey})),r=a.find((function(e){return e.authtype===n.type}));k({type:"loaded",values:r})}))}),[]),m?v().createElement(w.u,{title:D,variant:"small",isOpen:!0,onClose:_},v().createElement(M.b,{className:"pf-u-m-2xl"},v().createElement(E.$,null))):v().createElement(j.Z,{clearedValue:null,schema:{fields:[(0,R.Z)(i,o)]},onSubmit:function(){var e=c()(s().mark((function e(t){var r,i,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.authentication).tenant,r.source_id,i=r.id,r.authtype,r.resource_id,o=l()(r,["tenant","source_id","id","authtype","resource_id"]),_(),e.prev=2,e.next=5,(0,H.Rj)().updateAuthentication(i,o);case 5:n((0,I.Hz)({title:a.formatMessage({id:"editCredentials.alert.title",defaultMessage:"New credentials saved"}),description:a.formatMessage({id:"editCredentials.alert.description",defaultMessage:"It may take some time to validate your new credentials. Check this page for status updates."}),variant:"info"})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n((0,I.Hz)({title:a.formatMessage({id:"editCredentials.alert.warning.title",defaultMessage:"Error updating credentials"}),description:a.formatMessage({id:"editCredentials.alert.warning.description",defaultMessage:"There was a problem while trying to update credentials. Please try again. If the error persists, open a support case."}),variant:"danger"}));case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),initialValues:P,FormTemplate:function(e){return v().createElement(F,r()({},e,{ModalProps:{isOpen:!0,onClose:_,variant:"small",title:D,description:S}}))},onCancel:_})}}}]);
//# sourceMappingURL=credentialsForm.c95490cc6c7284a6cbf4.js.map