(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{316:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),a=n.n(r),i=n(1),o=n.n(i),c=n(475),s=n.n(c),u=n(42),l=n(296),d=n(295),p=n.n(d),f="edit-field",m=function(e){var t=p()(e),n=t.isRequired,r=t.label,i=t.helperText,o=t.hideLabel,c=t.meta,d=t.input,f=t.type,m=t.setEdit,h=c.error,b=c.touched&&h,g=d.value;"boolean"==typeof g&&(g=g?"True":"False");var O="password"===f||d.name.includes("password")?"Click to edit":"Click to add";return a.a.createElement(l.FormGroup,{isRequired:n,label:!o&&r,fieldId:d.name,isValid:!b,helperText:i,helperTextInvalid:h,onClick:m?function(){return m(d.name)}:void 0,tabIndex:0,onKeyPress:function(e){32===e.charCode&&m&&(e.preventDefault(),m(d.name))}},a.a.createElement("div",{className:"pf-c-form__horizontal-group ins-c-sources__edit-field-group ".concat(m?"clickable":"")},a.a.createElement(u.TextContent,{className:"ins-c-sources__edit-field-group-text-content ".concat(m?"clickable":"")},a.a.createElement("span",{className:"ins-c-sources__edit-field-value pf-u-mr-sm"},g||(m?O:"")),m&&a.a.createElement(s.a,null))))};m.propTypes={label:o.a.node,isRequired:o.a.bool,helperText:o.a.node,hideLabel:o.a.bool,setEdit:o.a.func,type:o.a.string},t.b=m},395:function(e,t,n){"use strict";var r=n(85),a=n.n(r),i=n(2),o=n.n(i),c=n(0),s=n.n(c),u=n(396),l=n.n(u),d=n(314),p=n.n(d),f=n(330),m=n.n(f),h=n(354),b=n.n(h),g=n(340),O=n.n(g),y=n(399),v=n.n(y),j=n(301),E=n(316);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){return s.a.createElement(l.a,a()({FormTemplate:O.a,componentMapper:w(w(w({},v.a),j.mapperExtension),{},{"edit-field":E.b,"switch-field":v.a[p.a.SWITCH]}),validatorMapper:{"required-validator":b.a[m.a.REQUIRED],"pattern-validator":b.a[m.a.PATTERN],"min-length-validator":b.a[m.a.MIN_LENGTH],"url-validator":b.a[m.a.URL]}},e))}},482:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(360);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}));var a=n(473);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}));var i=n(470);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var o=n(472);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}));var c=n(474);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})}));var s=n(471);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})}));var u=n(469);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})}))},680:function(e,t,n){var r=n(681);e.exports=function(e,t,n){return null==e?e:r(e,t,n)}},681:function(e,t,n){var r=n(414),a=n(476),i=n(416),o=n(306),c=n(480);e.exports=function(e,t,n,s){if(!o(e))return e;for(var u=-1,l=(t=a(t,e)).length,d=l-1,p=e;null!=p&&++u<l;){var f=c(t[u]),m=n;if(u!=d){var h=p[f];void 0===(m=s?s(h,f,p):void 0)&&(m=o(h)?h:i(t[u+1])?[]:{})}r(p,f,m),p=p[f]}return e}},682:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TrashIconConfig=void 0;var r,a=(r=n(43))&&r.__esModule?r:{default:r};var i={name:"TrashIcon",height:512,width:448,svgPath:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z",yOffset:"",xOffset:"",transform:""};t.TrashIconConfig=i;var o=(0,a.default)(i);t.default=o},741:function(e,t,n){"use strict";n.r(t);var r=n(85),a=n.n(r),i=n(37),o=n.n(i),c=n(0),s=n.n(c),u=n(29),l=n(10),d=n(287),p=n(88),f=n(340),m=n.n(f),h=n(482),b=n(395),g=n(2),O=n.n(g),y=n(14),v=n(11);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=n(13),w=n(304),M=n(305),T=n(81),S=function(){return s.a.createElement(w.Grid,null,s.a.createElement(M.GridItem,{xs:12},s.a.createElement(T.Title,{headingLevel:T.TitleLevel.h1,size:"3xl"},s.a.createElement(P.a,{id:"sources.editSource",defaultMessage:"Edit source"}))),s.a.createElement(M.GridItem,{xs:12},s.a.createElement(P.a,{id:"sources.editSourceDescription",defaultMessage:"You are editing a source."})))},_=n(62),D=n.n(_),R=n(317),A=n.n(R),C=n(680),k=n.n(C),x=n(91);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var N=function(e,t){var n,r,a=e.endpoints,i=e.authentications,o=D()(e,["endpoints","authentications"]),c={};return i&&i.length>0&&i.forEach((function(e){c["a".concat(e.id)]=e})),a&&a.length>0&&(n=a[0]),n&&(r=n.scheme||n.host||n.path||n.port?Object(x.b)(n):void 0),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({source_type:t,endpoint:n,authentications:c,url:r},o)},F=n(82),q=n(83),L=n(383),B=function(e,t,n,r,a,i){return n(Object(F.l)(r,function(e,t){var n={};return Object.keys(t).filter((function(e){return t[e]})).forEach((function(t){k()(n,t,A()(e,t))})),n}(e,t),a.formatMessage({id:"sources.modifiedNotificationTitle",defaultMessage:'"{ name }" was modified successfully.'},{name:r.source.name}),a.formatMessage({id:"sources.modifiedNotificationDescription",defaultMessage:"The source was successfully modified."}),{authentication:a.formatMessage({id:"sources.sourceEditAuthFailure",defaultMessage:"Authentication update failure."}),source:a.formatMessage({id:"sources.sourceEditFailure",defaultMessage:"Source update failure."}),endpoint:a.formatMessage({id:"sources.sourceEditEndpointFailure",defaultMessage:"Endpoint update failure."}),costManagement:a.formatMessage({id:"sources.sourceCostmanagementFailure",defaultMessage:"Cost Management update failure."})})).then((function(){Object(L.a)(r.source.id),i(q.c.sources.path),n(Object(F.f)())}))},V=n(310),H=n(334),z=n(25),G=n.n(z),U=n(333),W=n(301),K=n(330),Q=n.n(K),X=n(316);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=function(e,t,n){return[Y(Y({name:"source.name",label:s.a.createElement(P.a,{id:"sources.sourceName",defaultMessage:"Source name"}),component:e["source.name"]?U.a.TEXT_FIELD:X.a},e["source.name"]?{}:{setEdit:t}),{},{validate:[function(e){return Object(W.asyncValidator)(e,n)},{type:Q.a.REQUIRED}],isRequired:!0}),{name:"source_type",label:s.a.createElement(P.a,{id:"sources.sourceType",defaultMessage:"Source type"}),isReadOnly:!0,component:X.a}]},$=n(26),ee=n(42),te=n(1),ne=n.n(te),re=n(57),ae=n(417),ie=n(682),oe=n.n(ie),ce=Object(c.createContext)(),se=function(e){var t=e.schemaAuth,n=e.auth,r=e.appTypes,a=e.isDeleting,i=Object(c.useContext)(ce),o=i.source,u=i.setState,l=o.source.applications.filter((function(e){return e.authentications.find((function(e){return e.id===n.id}))})).map((function(e){var t=e.application_type_id;return t?r.find((function(e){return e.id===t})):void 0})).filter(Boolean).map((function(e){return e.display_name}));return s.a.createElement(ae.GridItem,{sm:12},s.a.createElement(T.Title,{size:"xl"},t.name,"Â ",!a&&s.a.createElement(re.Button,{variant:"plain","aria-label":"Remove authentication",onClick:function(){return u({type:"setAuthRemoving",removingAuth:{auth:n,appNames:l,schemaAuth:t}})}},s.a.createElement(oe.a,null))),s.a.createElement(ee.TextContent,null,s.a.createElement($.Text,{component:$.TextVariants.small,className:"pf-u-mb-0"},s.a.createElement(P.a,{id:"sources.removeAuthDescription",defaultMessage:"id: {authid} { appNames}",values:{authid:n.id,appNames:l.length>0?s.a.createElement(P.a,{id:"sources.removeAuthWithApps",defaultMessage:"used by {appNames}",values:{appNames:l.join(", ")}}):s.a.createElement(P.a,{id:"sources.removeAuthNoApps",defaultMessage:"not used by any app"})}}))))};se.propTypes={isDeleting:ne.a.bool,appTypes:ne.a.arrayOf(ne.a.object),schemaAuth:ne.a.shape({name:ne.a.string.isRequired}).isRequired,auth:ne.a.shape({id:ne.a.string.isRequired}).isRequired};var ue=se,le=n(94),de=function(){return s.a.createElement(ae.Grid,null,s.a.createElement(ae.GridItem,{xs:12},s.a.createElement(le.Bullseye,null,s.a.createElement(p.Spinner,{size:"lg"}))),s.a.createElement(ae.GridItem,{xs:12},s.a.createElement(le.Bullseye,null,s.a.createElement(ee.TextContent,null,s.a.createElement($.Text,{component:$.TextVariants.small,className:"pf-u-mt-md"},s.a.createElement(P.a,{id:"sources.removingAuthMessage",defaultMessage:"This authentication is being removed..."}))))))};function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me=function(e,t,n,r){return e.map((function(e){var a=e.name.startsWith("authentication")?function(e,t){return"authentications.a".concat(t,".").concat(e.replace("authentication.",""))}(e.name,t):e.name,i=n[a],o=fe(fe({},e),{},{name:a,component:i?e.component:X.a});return i||(o.setEdit=r),"password"===o.name.split(".").pop()&&(o.helperText=s.a.createElement(P.a,{id:"sources.passwordResetHelperText",defaultMessage:"Changing this resets your current { label }.",values:{label:o.label}}),o.isRequired=!1,o.validate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.filter((function(e){return e.type!==U.b.REQUIRED&&"required-validator"!==e.type}))}(o.validate)),o}))},he=function(e,t,n,r,a){return e&&0!==e.length&&t.schema&&t.schema.authentication?e.map((function(e){var i,o=e.isDeleting,c=D()(e,["isDeleting"]),u=t.schema.authentication.find((function(e){return e.type===c.authtype}));if(!u)return i=c.authtype,{component:"description",name:"".concat(i,"-unsupported"),Content:function(){return s.a.createElement(ee.TextContent,null,s.a.createElement($.Text,{component:$.TextVariants.p},s.a.createElement(P.a,{id:"sources.unsupportedAuthType",defaultMessage:"Authentication type of { type } is no longer supported.",values:{type:i}})))}};var l=function(e,t){return A()(W.hardcodedSchemas,[e,"authentication",t,"generic","includeStepKeyFields"],[])}(t.name,c.authtype),d=u.fields.filter((function(e){return!e.stepKey||l.includes(e.stepKey)})).map((function(e){return fe(fe({},e),function(e,t,n){return A()(W.hardcodedSchemas,[e,"authentication",t,"generic",n],{})}(t.name,c.authtype,e.name))}));return{component:U.a.SUB_FORM,name:u.name,fields:[{component:"description",name:"".concat(c.id,"-authentication-management"),Content:ue,schemaAuth:u,appTypes:a,auth:c,isDeleting:o},o?{component:"description",name:"".concat(c.id,"-remove-spinner"),Content:de}:me(d,c.id,n,r)]}})):[]};function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oe=[U.a.CHECKBOX,U.a.SWITCH],ye=function(e,t,n){return e.map((function(e){var r=t[e.name],a=ge(ge({},e),{},{component:r||Oe.includes(e.component)?e.component:X.a});return r||Oe.includes(e.component)||(a.setEdit=n),a}))};function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ee=function(e,t,n){if(e.schema&&e.schema.endpoint&&!e.schema.endpoint.hidden){var r=e.schema.endpoint.fields.map((function(t){return je(je({},t),function(e,t){return A()(W.hardcodedSchemas,[e,"endpoint",t],{})}(e.name,t.name))}));return{component:U.a.SUB_FORM,title:s.a.createElement(P.a,{id:"sources.endpoint",defaultMessage:"Endpoint"}),name:"endpoint",fields:ye(r,t,n)}}};function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Me="/insights/platform/cost-management",Te=["billing_source","credentials"],Se=function(e){var t=e.name;return Te.some((function(e){return t.startsWith(e)}))},_e=function(e){return Object.keys(e).map((function(t){return e[t].fields.filter(Se)})).flatMap((function(e){return e}))},De=function(e,t,n){var r=void 0;return n.forEach((function(n){var a=r?{}:A()(W.hardcodedSchemas,[e,"authentication",n],{});Object.keys(a).find((function(a){var i=A()(W.hardcodedSchemas,[e,"authentication",n,a,t],void 0);if(i)return r=i,!0}))})),r||{}},Re=function(e,t,n){return"openshift"===n.name?[we(we({name:"source.source_ref",label:s.a.createElement(P.a,{id:"sources.clusterIdentifier",defaultMessage:"Cluster identifier"}),isRequired:!0},e["source.source_ref"]?{}:{setEdit:t}),{},{validate:[{type:U.b.REQUIRED}],component:e["source.source_ref"]?U.a.TEXT_FIELD:X.a})]:[]},Ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=a.find((function(e){return e.name===Me}));if(o){var c=e.find((function(e){return e.application_type_id===o.id}));if(c){var s=_e(t.schema.authentication),u=i.authentications?i.authentications.map((function(e){return e.authtype})):[],l=s.map((function(e){return we(we({},e),De(t.name,e.name,u))}));return{component:U.a.SUB_FORM,title:o.display_name,name:o.display_name,fields:[].concat(G()(ye(l,n,r)),G()(Re(n,r,t)))}}}},Ce=function(e,t,n,r,a,i){return[Ae(e,t,n,r,a,i)]},ke=function(e,t,n,r,a){return{fields:[].concat(G()(Z(t,n,e.source.id)),G()(he(e.authentications,r,t,n,a)),G()(Ce(e.applications,r,t,n,a,e)),[!!(e.endpoints&&e.endpoints.length>0)&&Ee(r,t,n)]).filter(Boolean)}};function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne={loading:!0,editing:{},source:void 0,initialValues:{},sourceType:void 0,schema:void 0,isAuthRemoving:null},Fe=function(e,t){var n=t.type,r=t.source,a=t.name,i=t.sourceType,o=t.setEdit,c=t.appTypes,s=t.authId,u=t.removingAuth;switch(n){case"createForm":return Ie(Ie({},e),{},{sourceType:i,initialValues:N(e.source,i.product_name),schema:ke(e.source,e.editing,o,i,c),loading:!1});case"refreshSchema":return Ie(Ie({},e),{},{schema:ke(e.source,e.editing,o,e.sourceType,c)});case"setSource":return Ie(Ie({},e),{},{source:r});case"reset":return Ie(Ie({},e),{},{editing:{}});case"setEdit":return Ie(Ie({},e),{},{editing:Ie(Ie({},e.editing),{},O()({},a,!e.editing[a]))});case"removeAuthPending":return Ie(Ie({},e),{},{isAuthRemoving:null,source:Ie(Ie({},e.source),{},{authentications:e.source.authentications.map((function(e){return e.id===s?Ie(Ie({},e),{},{isDeleting:!0}):e}))})});case"removeAuthRejected":return Ie(Ie({},e),{},{source:Ie(Ie({},e.source),{},{authentications:e.source.authentications.map((function(e){return e.id===s?Ie(Ie({},e),{},{isDeleting:!1}):e}))})});case"removeAuthFulfill":return Ie(Ie({},e),{},{source:Ie(Ie({},e.source),{},{authentications:e.source.authentications.filter((function(e){return e.id!==s}))})});case"setAuthRemoving":return Ie(Ie({},e),{},{isAuthRemoving:u});case"closeAuthRemoving":return Ie(Ie({},e),{},{isAuthRemoving:null});default:return e}},qe=n(80),Le=n(89),Be=n.n(Le),Ve=function(e){var t,n,r=e.appNames,a=e.schemaAuth,i=e.auth,o=r.length>0,l=Object(u.useDispatch)(),p=Object(d.a)(),f=Object(c.useContext)(ce).setState,m=function(){return f({type:"closeAuthRemoving"})};return o?(t=s.a.createElement(P.a,{id:"sources.removeAuthWarningApps",defaultMessage:"To remove {authname} authentication you have to remove attached {count, plural, one {application} other {applications}}: { appNames }.",values:{appNames:r.join(", "),count:r.length,authname:s.a.createElement("b",null,a.name)}}),n=[s.a.createElement(qe.Button,{id:"deleteCancel",key:"cancel",variant:"link",type:"button",onClick:m},s.a.createElement(P.a,{id:"sources.close",defaultMessage:"Close"}))]):(t=s.a.createElement(P.a,{id:"sources.removeAuthWarning",defaultMessage:"Do you really want to remove {auth} authentication?",values:{auth:s.a.createElement("b",null,a.name)}}),n=[s.a.createElement(qe.Button,{id:"deleteSubmit",key:"submit",variant:"danger",type:"button",onClick:function(){return f({type:"removeAuthPending",authId:i.id}),m(),Object(y.d)(i.id).then((function(){f({type:"removeAuthFulfill",authId:i.id}),l(Object(F.b)(p.formatMessage({id:"sources.authRemoveFullfil",defaultMessage:"Authentication was deleted successfully."}),"success"))})).catch((function(e){f({type:"removeAuthRejected",authId:i.id}),l(Object(F.b)(p.formatMessage({id:"sources.authRemoveRejected",defaultMessage:"Authentication was not deleted successfully."}),"danger",Object(W.handleError)(e)))}))}},s.a.createElement(P.a,{id:"sources.deleteConfirm",defaultMessage:"Remove authentication"})),s.a.createElement(qe.Button,{id:"deleteCancel",key:"cancel",variant:"link",type:"button",onClick:m},s.a.createElement(P.a,{id:"sources.deleteCancel",defaultMessage:"Cancel"}))]),s.a.createElement(h.Modal,{isOpen:!0,className:"ins-c-sources__dialog--warning",isFooterLeftAligned:!0,onClose:m,actions:n,isSmall:!0,title:p.formatMessage({id:"sources.deleteAuthTitle",defaultMessage:"Remove authentication?"}),header:s.a.createElement(T.Title,{size:"2xl"},s.a.createElement(Be.a,{size:"sm",className:"ins-m-alert ins-c-source__delete-icon pf-u-mr-sm"}),p.formatMessage({id:"sources.deleteAppTitle",defaultMessage:"Remove authentication?"}))},s.a.createElement(ee.TextContent,null,s.a.createElement($.Text,{variant:$.TextVariants.p},t)))};Ve.propTypes={appNames:ne.a.arrayOf(ne.a.string),schemaAuth:ne.a.shape({name:ne.a.string.isRequired}).isRequired,auth:ne.a.shape({id:ne.a.string.isRequired}).isRequired};var He=Ve;t.default=function(){var e=Object(c.useReducer)(Fe,Ne),t=o()(e,2),n=t[0],r=t[1],i=Object(l.f)(),f=Object(V.a)(),g=Object(H.a)(),O=n.loading,j=n.editing,P=n.source,w=n.initialValues,M=n.schema,T=Object(d.a)(),_=Object(u.useSelector)((function(e){return e.sources}),u.shallowEqual),D=_.sourceTypes,R=_.appTypes,A=_.sourceTypesLoaded,C=_.appTypesLoaded,k=Object(u.useDispatch)();Object(c.useEffect)((function(){f&&function(e){return Promise.all([Object(y.j)().showSource(e.id),Object(y.j)().listSourceEndpoints(e.id),Object(y.j)().listSourceApplications(e.id),(t=e.id,y.a.get("".concat(v.a,"/sources/").concat(t,"/"))).catch((function(){}))]).then((function(t){var n=o()(t,4),r=n[0],a=n[1],i=n[2],c=n[3],s=a&&a.data&&a.data[0],u={source:E(E({},e),r),applications:i.data};return c&&(u=E(E({},u),{},{billing_source:c.billing_source,credentials:c.authentication.credentials})),s?Object(y.j)().listEndpointAuthentications(s.id).then((function(e){return E(E({},u),{},{endpoints:a.data,authentications:e.data})})):u}));var t}(f).then((function(e){e.source.imported&&function(e,t,n,r){e(Object(F.b)(t.formatMessage({id:"sources.importSourceCannotEdited",defaultMessage:"Source { name } is imported."},{name:r}),"danger",t.formatMessage({id:"sources.importedSourcesCannotEdited",defaultMessage:"Imported sources cannot be edited."}))),n.push(q.c.sources.path)}(k,T,i,e.source.name),r({type:"setSource",source:e})}))}),[f,g]);var x=function(e){return r({type:"setEdit",name:e})};Object(c.useEffect)((function(){if(P&&C&&A){var e=D.find((function(e){return e.id===P.source.source_type_id}));r({type:"createForm",sourceType:e,source:P,setEdit:x,appTypes:R})}}),[C,P,A]),Object(c.useEffect)((function(){P&&!O&&r({type:"refreshSchema",setEdit:x,appTypes:R})}),[j]);var I=function(){return i.push(q.c.sources.path)};return!C||!A||O?s.a.createElement(h.Modal,{title:T.formatMessage({id:"sources.editSource",defaultMessage:"Edit source."}),header:s.a.createElement(S,null),isOpen:!0,isLarge:!0,onClose:I},s.a.createElement("div",{className:"ins-c-sources__dialog--spinnerContainer"},s.a.createElement(p.Spinner,null))):s.a.createElement(s.a.Fragment,null,s.a.createElement(ce.Provider,{value:{setState:r,source:P}},n.isAuthRemoving&&s.a.createElement(He,n.isAuthRemoving),s.a.createElement(h.Modal,{title:T.formatMessage({id:"sources.editSource",defaultMessage:"Edit source."}),header:s.a.createElement(S,null),isOpen:!n.isAuthRemoving,isLarge:!0,onClose:I},s.a.createElement(b.a,{onCancel:I,schema:M,onSubmit:function(e,t){return B(e,t.getState().dirtyFields,k,P,T,i.push)},FormTemplate:function(e){return s.a.createElement(m.a,a()({},e,{formWrapperProps:{isHorizontal:!0},canReset:!0,disableSubmit:["submitting"],submitLabel:T.formatMessage({id:"sources.save",defaultMessage:"Save"})}))},clearedValue:null,onReset:function(){return r({type:"reset"})},initialValues:w}))))}}}]);
//# sourceMappingURL=../sourcemaps/edit.js.map