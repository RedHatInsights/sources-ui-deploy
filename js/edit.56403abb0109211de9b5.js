(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{524:function(e,t,n){"use strict";var a=n(129);t.a=function(e,t,n,r,i){var o=t.formatMessage({id:"sources.removeAppWarning",defaultMessage:"{ name } was removed from this source."},{name:e.display_name}),s=t.formatMessage({id:"sources.removeAppError",defaultMessage:"Removing of { name } application from this source was unsuccessful."},{name:e.display_name});return n&&n(),r(Object(a.i)(e.id,i.id,o,s))}},588:function(e,t,n){"use strict";var a=n(131),r=n.n(a),i=n(3),o=n.n(i),s=n(0),c=n.n(s),u=n(468),l=n.n(u),p=n(406),d=n.n(p),m=n(405),f=n.n(m),v=n(456),b=n.n(v),h=n(449),g=n.n(h),y=n(473),O=n.n(y),E=n(571),j=n(56),M=n.n(j),T=n(410),w=n.n(T),P=n(409),_=n(434),R=n(568),S=n.n(R),k=n(404),D=n.n(k),x=n(475),A=n.n(x);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(e){var t,n,a=D()(),i=a.getState().values,o=(null==e||null===(t=e.name)||void 0===t?void 0:t.match(/\d+/))||[],u=M()(o,1)[0]||(null===(n=i.authentication)||void 0===n?void 0:n.id),l=w()(i,e.name),p=Object(s.useState)(!u||l),d=M()(p,2),m=d[0],v=d[1],b=Object(s.useRef)(!0),h=Object(s.useRef)(!1);Object(s.useEffect)((function(){h.current&&(!b.current&&a.getState().pristine&&(v(!1),b.current=!0),m&&(b.current=!1))})),Object(s.useEffect)((function(){h.current=!0}),[]);var g=e.validate&&e.validate.filter((function(e){return e.type!==f.a.REQUIRED})),y=N(N({},e),u?{validate:g,resolveProps:A.a}:{});return!m&&u?c.a.createElement(P.FormGroup,{helperText:y.helperText,label:y.label,onFocus:function(){return v(!0)},isRequired:!0},c.a.createElement(_.TextInput,{"aria-label":"pre-filled-authentication",value:"•••••••••••••"})):c.a.createElement(S.a,r()({},y,{autoFocus:!0}))},F=n(53),q=n.n(F),B=n(12),L=n.n(B),G=n(48),V=n(252),U=n(436),z=n(128),W=n(525),K=n.n(W),Q=n(408),X=n.n(Q),H=n(433),J=n(208),$=n(209),Y=n(127),Z=n(458),ee=n(211),te=n(213),ne=n.n(te),ae=n(524),re=function(e){var t=e.app,n=e.onCancel,a=e.container,r=Object(V.a)(),i=Object(G.useSelector)((function(e){return e.sources.appTypes})),o=Object(H.a)(),u=Object(G.useDispatch)();Object(s.useEffect)((function(){a&&(a.hidden=!0)}),[]);var l=t.dependent_applications.map((function(e){var n=i.find((function(t){return t.name===e}));return t.sourceAppsNames.includes(null==n?void 0:n.display_name)&&(null==n?void 0:n.display_name)})).filter((function(e){return e}));return c.a.createElement(Z.Modal,{className:"ins-c-sources__dialog--warning",isOpen:!0,onClose:n,variant:"small","aria-label":r.formatMessage({id:"sources.deleteAppTitle",defaultMessage:"Remove application?"}),header:c.a.createElement(ee.Title,{headingLevel:"h1",size:"2xl"},c.a.createElement(ne.a,{size:"sm",className:"ins-m-alert ins-c-source__delete-icon pf-u-mr-sm"}),r.formatMessage({id:"sources.deleteAppTitle",defaultMessage:"Remove application?"})),actions:[c.a.createElement(Y.Button,{id:"deleteSubmit",key:"submit",variant:"danger",type:"button",onClick:function(){return Object(ae.a)(t,r,n,u,o)}},r.formatMessage({id:"sources.remove",defaultMessage:"Remove"})),c.a.createElement(Y.Button,{id:"deleteCancel",key:"cancel",variant:"link",type:"button",onClick:n},r.formatMessage({id:"sources.cancel",defaultMessage:"Cancel"}))]},c.a.createElement($.TextContent,null,c.a.createElement(J.Text,{component:J.TextVariants.p},r.formatMessage({id:"sources.deleteAppWarning",defaultMessage:"{ appName } will be disconnected from this source."},{appName:c.a.createElement("b",{key:"b"},t.display_name)})),l.length>0&&c.a.createElement(J.Text,{component:J.TextVariants.p},r.formatMessage({id:"sources.deleteAppDetails",defaultMessage:"This change will affect these applications: { apps }."},{apps:l}))))};re.propTypes={app:L.a.shape({id:L.a.string.isRequired,display_name:L.a.string.isRequired,dependent_applications:L.a.arrayOf(L.a.string),sourceAppsNames:L.a.arrayOf(L.a.string)}).isRequired,onCancel:L.a.func.isRequired,container:L.a.instanceOf(Element)};var ie=re,oe=function(e){var t=e.option,n=e.setApplicationToRemove,a=e.sourceAppsNames,r=e.app,i=e.appType,o=Object(V.a)();return c.a.createElement("div",{className:"pf-c-radio pf-u-mb-md"},c.a.createElement(z.Button,{id:"remove-app-".concat(t.value),variant:"plain","aria-label":o.formatMessage({id:"source.removeAppAria",defaultMessage:"Remove application {app} from this source"},{app:t.label}),className:"pf-u-p-0",onClick:function(){return n({id:null==r?void 0:r.id,display_name:null==i?void 0:i.display_name,dependent_applications:null==i?void 0:i.dependent_applications,sourceAppsNames:a})}},c.a.createElement(K.a,{variant:"small"})),c.a.createElement("label",{className:"pf-c-radio__label",htmlFor:"remove-app-".concat(t.value)},t.label))};oe.propTypes={option:L.a.shape({label:L.a.string.isRequired,value:L.a.string.isRequired}),setApplicationToRemove:L.a.func.isRequired,sourceAppsNames:L.a.arrayOf(L.a.string),appType:L.a.shape({display_name:L.a.string.isRequired,dependent_applications:L.a.arrayOf(L.a.string)}),app:L.a.shape({id:L.a.string.isRequired,application_type_id:L.a.string.isRequired})};var se=function(e){var t=X()(e),n=t.options,a=t.input,r=a.onChange,i=a.value,o=a.name,u=t.container,l=Object(s.useState)({}),p=M()(l,2),d=p[0],m=p[1],f=Object(G.useSelector)((function(e){return e.sources.appTypes})),v=Object(H.a)(),b=v.applications.map((function(e){var t,n=e.application_type_id;return null===(t=f.find((function(e){return e.id===n})))||void 0===t?void 0:t.display_name})),h=function(e){return null==f?void 0:f.find((function(t){return t.id===e}))},g=function(e){return v.applications.find((function(t){return t.application_type_id===e}))},y=function(e){var t;return null===(t=g(e))||void 0===t?void 0:t.isDeleting},O=v.applications.filter((function(e){return!e.isDeleting})).reduce((function(e,t){return[].concat(q()(e),[t.application_type_id])}),[]);return c.a.createElement("div",null,d.id&&c.a.createElement(ie,{app:d,onCancel:function(){return u&&(u.hidden=!1),m({})},container:u}),n.map((function(e){return O.includes(e.value)?c.a.createElement(oe,{key:e.value,option:e,setApplicationToRemove:m,sourceAppsNames:b,app:g(e.value),appType:h(e.value)}):c.a.createElement(U.Radio,{className:"pf-u-mb-md",key:e.value,onChange:function(){return r(e.value)},label:e.label,id:"".concat(o,"-").concat(e.value),name:o,isChecked:i===e.value,isDisabled:y(e.value)})})))};function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){return c.a.createElement(l.a,r()({FormTemplate:g.a,componentMapper:ue(ue(ue({},O.a),E.mapperExtension),{},{authentication:I,"switch-field":O.a[d.a.SWITCH],"application-select":se}),validatorMapper:{"required-validator":b.a[f.a.REQUIRED],"pattern-validator":b.a[f.a.PATTERN],"min-length-validator":b.a[f.a.MIN_LENGTH],"url-validator":b.a[f.a.URL]}},e))}},590:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return p}));var a=n(3),r=n.n(a),i=n(459),o=n(39),s=n(15);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){return e.url||null===e.url?function(e){if(null===e)return{scheme:null,host:null,port:null,path:null};if(!e)return{};try{var t=new URL(e),n=t.protocol.replace(/:$/,"");return{scheme:n,host:t.hostname,port:""===t.port?Object(i.b)(n):t.port,path:t.pathname}}catch(e){return{}}}(e.url):e.endpoint?e.endpoint:e},p=function(e,t){var n,a,r=[];if(t.source&&r.push(Object(o.k)().updateSource(e.source.id,t.source)),t.endpoint||t.url||null===t.url){var i=l(t),c=i.scheme,p=i.host,d=i.port,m=i.path,f=null===d?null:parseInt(d,10),v=u({scheme:c,host:p,path:m,port:null===f?null:isNaN(f)?void 0:f},t.endpoint);r.push(Object(o.k)().updateEndpoint(e.endpoints[0].id,v))}if(t.authentications&&Object.keys(t.authentications).forEach((function(e){var n=e.replace("a","");r.push(Object(o.k)().updateAuthentication(n,t.authentications[e]))})),t.billing_source||t.credentials){var b={};t.credentials&&(b={authentication:{credentials:t.credentials}}),t.billing_source&&(b=u(u({},b),{},{billing_source:t.billing_source})),r.push((n=e.source.id,a=b,o.a.patch("".concat(s.a,"/sources/").concat(n,"/"),a)))}return Promise.all(r)}},929:function(e,t,n){"use strict";n.r(t);var a=n(131),r=n.n(a),i=n(3),o=n.n(i),s=n(56),c=n.n(s),u=n(0),l=n.n(u),p=n(48),d=n(13),m=n(252),f=n(104),v=n(478),b=n(588),h=n(103),g=n.n(h),y=n(133),O=n.n(y),E=n(39),j=n(15);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=function(e){return Promise.all([Object(E.k)().showSource(e.id),Object(E.k)().listSourceEndpoints(e.id),Object(E.f)(e.id),(t=e.id,E.a.get("".concat(j.a,"/sources/").concat(t,"/"))).catch((function(){}))]).then(function(){var t=O()(g.a.mark((function t(n){var a,r,i,o,s,u,l,p,d,m,f,v,b;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=c()(n,4),i=r[0],o=r[1],s=r[2],u=r[3],l=o&&o.data&&o.data[0],p=(null==s||null===(a=s.sources[0])||void 0===a?void 0:a.applications)||[],d={source:T(T({},e),i),applications:p},u&&(d=T(T({},d),{},{billing_source:u.billing_source,credentials:u.authentication.credentials})),m=[],v=[],b=[],p.forEach((function(e){var t;null==e||null===(t=e.authentications)||void 0===t||t.forEach((function(t){(null==t?void 0:t.id)&&(m.push(Object(E.k)().showAuthentication(t.id)),v.push(e.id),b.push(t.id))}))})),!(m.length>0)){t.next=14;break}return t.next=12,Promise.all(m);case 12:f=t.sent,v.forEach((function(e,t){d.applications.find((function(t){return t.id===e})).authentications.push(f[t])}));case 14:if(l){t.next=16;break}return t.abrupt("return",d);case 16:return t.abrupt("return",Object(E.k)().listEndpointAuthentications(l.id).then((function(e){return T(T({},d),{},{endpoints:o.data,authentications:e.data.filter((function(e){var t=e.id;return!b.includes(t)}))})})));case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());var t},P=n(12),_=n.n(P),R=n(418),S=n(419),k=n(211),D=function(e){var t=e.name,n=Object(m.a)();return l.a.createElement(R.Grid,null,l.a.createElement(S.GridItem,{xs:12},l.a.createElement(k.Title,{headingLevel:"h1",size:"3xl"},n.formatMessage({id:"sources.editSource",defaultMessage:"Edit source"}))),t&&l.a.createElement(S.GridItem,{xs:12},n.formatMessage({id:"sources.editSourceDescription",defaultMessage:"Use the form fields below to make desired changes to source {name}."},{name:l.a.createElement("b",{key:"b"},t)})))};D.propTypes={name:_.a.node};var x=D,A=n(526),C=n(53),N=n.n(C),I=n(102),F=n.n(I),q=n(410),B=n.n(q),L=n(889),G=n.n(L),V=n(459);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var z=function(e,t){var n={};return Object.keys(t).filter((function(e){return t[e]})).forEach((function(t){G()(n,t,B()(e,t))})),n},W=function(e,t){var n,a,r=e.endpoints,i=e.authentications,s=e.applications,c=F()(e,["endpoints","authentications","applications"]),u={},l=[].concat(N()(i||[]),N()((null==s?void 0:s.reduce((function(e,t){return[].concat(N()(e),N()(t.authentications))}),[]))||[]));return l.length>0&&l.forEach((function(e){u["a".concat(e.id)]=e})),r&&r.length>0&&(n=r[0]),n&&(a=n.scheme||n.host||n.path||n.port?Object(V.c)(n):void 0),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({source_type:t,endpoint:n,authentications:u,url:a},c)},K=n(129),Q=n(556),X=n(590),H=function(){var e=O()(g.a.mark((function e(t,n,a,r,i,o){var s,c,u,l,p,d;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o({type:"submit",values:t,editing:n}),e.prev=1,e.next=4,Object(X.a)(r,z(t,n));case 4:e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(1),o({type:"submitFailed"}),e.abrupt("return");case 10:return Object(Q.a)(r.source.id),a(Object(K.f)()),e.next=14,w({id:r.source.id});case 14:if(u=e.sent,!((l=(null===(s=r.applications)||void 0===s?void 0:s.map((function(e){var t=e.id;return Object(A.checkAppAvailability)(t)})))||[]).length>0)){e.next=36;break}return e.prev=17,e.next=20,Promise.all(l);case 20:p=e.sent,e.next=27;break;case 23:return e.prev=23,e.t1=e.catch(17),o({type:"submitFailed"}),e.abrupt("return");case 27:if(!(d=p.find((function(e){return e.availability_status===V.a})))){e.next=32;break}return c={title:i.formatMessage({id:"wizard.failEditToastTitle",defaultMessage:"Edit source failed"}),description:d.availability_status_error,variant:"danger"},o({type:"submitFinished",source:u,message:c}),e.abrupt("return");case 32:if(!p.some((function(e){return!e.availability_status}))){e.next=36;break}return o({type:"submitTimetouted"}),e.abrupt("return");case 36:c={title:i.formatMessage({id:"wizard.successEditToastTitle",defaultMessage:"Source ‘{name}’ was edited successfully."},{name:r.source.name}),variant:"success"},o({type:"submitFinished",source:u,message:c});case 38:case"end":return e.stop()}}),e,null,[[1,6],[17,23]])})));return function(t,n,a,r,i,o){return e.apply(this,arguments)}}(),J=n(130),$=n(433),Y=n(482),Z=n(406),ee=n.n(Z),te=n(574),ne=n(405),ae=n.n(ne),re=n(475),ie=n.n(re),oe=n(208),se=n(209),ce=n(670),ue=function(e){var t=e.sourceType,n=e.applications,a=Object(m.a)(),r=Object(p.useSelector)((function(e){return e.sources.appTypes})),i=null==n?void 0:n.map((function(e){var t,n=e.application_type_id;return null==r||null===(t=r.find((function(e){return e.id===n})))||void 0===t?void 0:t.display_name}));return l.a.createElement(se.TextContent,null,l.a.createElement(ce.Grid,{hasGutter:!0},l.a.createElement(ce.GridItem,{md:2},l.a.createElement(oe.Text,{component:oe.TextVariants.h4},a.formatMessage({id:"sources.sourceType",defaultMessage:"Source type"})),l.a.createElement(oe.Text,{component:oe.TextVariants.p,id:"source-edit-type"},t.product_name)),l.a.createElement(ce.GridItem,{md:8},l.a.createElement(oe.Text,{component:oe.TextVariants.h4},a.formatMessage({id:"sources.apps",defaultMessage:"Applications"})),l.a.createElement(oe.Text,{component:oe.TextVariants.p,id:"source-edit-apps"},i.length>0?i.join(", "):a.formatMessage({id:"sources.none",defaultMessage:"None"})))))};ue.propTypes={sourceType:_.a.shape({product_name:_.a.string.isRequired}),applications:_.a.arrayOf(_.a.shape({application_type_id:_.a.string.isRequired}))};var le=ue,pe=n(404),de=n.n(pe),me=n(218),fe=function(){var e=de()().getState().values.message;return l.a.createElement(me.Alert,{variant:null==e?void 0:e.variant,isInline:!0,title:null==e?void 0:e.title},null==e?void 0:e.description)},ve=function(e,t,n,a){return[{name:"alert",component:"description",Content:fe,condition:{when:"message",isNotEmpty:!0}},{name:"source.name",label:t.formatMessage({id:"sources.sourceName",defaultMessage:"Source name"}),component:ee.a.TEXT_FIELD,validate:[function(n){return Object(te.asyncValidatorDebounced)(n,e,t)},{type:ae.a.REQUIRED}],isRequired:!0,resolveProps:ie.a},{name:"additional_info",Content:le,component:"description",sourceType:n,applications:a}]},be=n(671),he=n.n(be);function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oe=function(e){if(e.schema&&e.schema.endpoint&&!e.schema.endpoint.hidden){var t=e.schema.endpoint.fields.map((function(t){return ye(ye({},t),function(e,t){return B()(he.a,[e,"endpoint",t],{})}(e.name,t.name))})),n={component:ee.a.SUB_FORM,name:"endpoint"};if("ansible-tower"===e.name){var a,r=t.find((function(e){return"url"===e.name}));return ye(ye({},n),{},{fields:[{component:ee.a.SUB_FORM,name:"receptor_node_group",condition:{when:"endpoint.receptor_node",isNotEmpty:!0},fields:[ye(ye({},r),{},{isRequired:!1,validate:null==r||null===(a=r.validate)||void 0===a?void 0:a.filter((function(e){return e.type!==ae.a.REQUIRED}))})]},{component:ee.a.SUB_FORM,name:"hostname_group",condition:{when:"endpoint.receptor_node",isEmpty:!0},fields:t}]})}return ye(ye({},n),{},{fields:t})}},Ee=n(594),je=n(891),Me=n(127),Te=n(525),we=n.n(Te),Pe=n(409),_e=function(e){var t=e.id,n=Object(m.a)();return l.a.createElement(Pe.FormGroup,{label:n.formatMessage({id:"sources.authId",defaultMessage:"Authentication ID"})},l.a.createElement(se.TextContent,null,l.a.createElement(oe.Text,{variant:"p"},t)))};_e.propTypes={id:_.a.string.isRequired};var Re=_e,Se=Object(u.createContext)(),ke=n(138),De=function(){var e=Object(m.a)();return l.a.createElement(ce.Grid,null,l.a.createElement(ce.GridItem,{xs:12},l.a.createElement(ke.Bullseye,null,l.a.createElement(f.Spinner,{size:"lg"}))),l.a.createElement(ce.GridItem,{xs:12},l.a.createElement(ke.Bullseye,null,l.a.createElement(se.TextContent,null,l.a.createElement(oe.Text,{component:oe.TextVariants.small,className:"pf-u-mt-md"},e.formatMessage({id:"sources.removingAuthMessage",defaultMessage:"This authentication is being removed..."}))))))},xe=function(e){var t,n,a=e.id,r=e.fields,i=Object(m.a)(),o=de()().renderForm,s=Object(u.useContext)(Se),c=s.setState,p=s.source;return(null==p||null===(t=p.authentications)||void 0===t||null===(n=t.find((function(e){return e.id===a})))||void 0===n?void 0:n.isDeleting)?l.a.createElement(De,null):l.a.createElement(R.Grid,null,l.a.createElement(S.GridItem,{md:2},l.a.createElement(je.Flex,null,l.a.createElement(je.FlexItem,{className:"pf-u-mr-0"},l.a.createElement(Me.Button,{variant:"plain","aria-label":i.formatMessage({id:"sources.removeAuthAriaLabel",defaultMessage:"Remove authentication with id {id}"},{id:a}),onClick:function(){return c({type:"setAuthRemoving",removingAuth:a})}},l.a.createElement(we.a,null))),l.a.createElement(je.Flex,null,l.a.createElement(Re,{id:a})))),l.a.createElement(S.GridItem,{md:10},o(r)))};xe.propTypes={id:_.a.string.isRequired,fields:_.a.array.isRequired};var Ae=xe;function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ie=function(e){return e.split(".").pop()},Fe=function(e,t){var n;return(null==e||null===(n=e.fields)||void 0===n?void 0:n.filter((function(e){return e.stepKey===t})))||[]},qe=function(e,t){return e.map((function(e){var n=e.name.startsWith("authentication")?function(e,t){return"authentications.a".concat(t,".").concat(e.replace("authentication.",""))}(e.name,t):e.name,a=Ne(Ne({},e),{},{name:n});return"password"===Ie(a.name)&&(a.component="authentication"),a}))},Be=function(e,t,n){return e&&0!==e.length&&t.schema&&t.schema.authentication?e.map((function(e){var a,r,i,o=null==t||null===(a=t.schema)||void 0===a||null===(r=a.authentication)||void 0===r?void 0:r.find((function(t){return t.type===e.authtype}));if(!o)return[];var s=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return B()(he.a,[e,"authentication",t,n,"includeStepKeyFields"],[])}(t.name,e.authtype,n),c=null===(i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return B()(he.a,[e,"authentication",t,n,"additionalSteps"],[])}(t.name,e.authtype,n))||void 0===i?void 0:i.map((function(e){return Ne(Ne({},e),{},{fields:[].concat(N()(e.fields),N()(Fe(o,e.name)))})})).map((function(e){return e.fields.map((function(e){return e.name}))})).flatMap((function(e){return e})),u=o.fields.filter((function(e){return c.includes(e.name)||!e.stepKey||e.stepKey&&s.includes(e.stepKey)})).map((function(a){return Ne(Ne({},a),function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"generic";return B()(he.a,[e,"authentication",t,a,n],{})}(t.name,e.authtype,a.name,n))}));return n||"amazon"!==t.name||(u=u.map((function(t){return function(e,t){return"password"!==Ie(e.name)?e:"arn"===t?Ne(Ne({},e),{},{label:"Cost Management ARN"}):"cloud-meter-arn"===t?Ne(Ne({},e),{},{label:"Subscription Watch ARN"}):e}(t,e.authtype)}))),n?qe(u,e.id):[{name:"authentication-".concat(e.id),component:"description",id:e.id,Content:Ae,fields:qe(u,e.id)}]})):[]},Le="/insights/platform/cost-management",Ge=function(e,t,n){var a;return[].concat(N()(Be(null===(a=n.authentications)||void 0===a?void 0:a.filter((function(e){return Object.keys(e).length>1})),t,null==e?void 0:e.name)),N()((null==e?void 0:e.name)===Le?function(e){return"openshift"===e.name?[{name:"source.source_ref",label:l.a.createElement(Ee.a,{id:"sources.clusterIdentifier",defaultMessage:"Cluster identifier"}),isRequired:!0,validate:[{type:ae.a.REQUIRED}],component:ee.a.TEXT_FIELD}]:[]}(t):[]))},Ve=function(e){return{component:ee.a.PLAIN_TEXT,name:"unused-auth-warning",label:l.a.createElement(Ee.a,{id:"sources.authNotUsed",defaultMessage:"The following {length, plural, one {authentication is not} other {authentications are not}} used by any application.",values:{length:e}})}},Ue=function(e,t,n,a){var r=function(e,t,n){var a,r,i;if(!e||0===e.length)return[];var o=null==t||null===(a=t.schema)||void 0===a||null===(r=a.authentication)||void 0===r||null===(i=r.reduce((function(n,a){var r=a.type,i=e.filter((function(e){var t=e.authtype;return r===t}));return(null==i?void 0:i.length)>0?[].concat(N()(n),N()(Be(i,t))):n}),[]))||void 0===i?void 0:i.filter(Boolean);return o=0!==n?[{fields:[Ve(o.length)].concat(N()(o)),title:t.product_name,name:"unused-auths-tab"}]:[{fields:[Ve(o.length)].concat(N()(o)),component:ee.a.SUB_FORM,name:"unused-auths-group"}]}(a,t,null==e?void 0:e.length);if(e&&0!==e.length){if(1===e.length&&0===r.length){var i=n.find((function(t){return t.id===e[0].application_type_id}));return Ge(i,t,e[0])}return[{component:ee.a.TABS,name:"app-tabs",isBox:!0,fields:[].concat(N()(e.map((function(e){var a=n.find((function(t){return t.id===e.application_type_id}));return{name:null==a?void 0:a.id,title:null==a?void 0:a.display_name,fields:Ge(a,t,e)}}))),N()(r))}]}return r},ze=function(e){var t=e.title,n=e.description;return l.a.createElement(se.TextContent,null,l.a.createElement(k.Title,{headingLevel:"h2",className:"pf-u-mb-0"},t),n&&l.a.createElement(oe.Text,{variant:"p"},n))};ze.propTypes={title:_.a.node.isRequired,description:_.a.node};var We=function(e,t,n,a,r){var i,o;if(0===e.length)i=a.formatMessage({id:"source.editTitleNoApp",defaultMessage:"{type} credentials"},{type:null==t?void 0:t.product_name});else if(1===e.length){var s=n.find((function(t){return t.id===e[0].application_type_id}));i=a.formatMessage({id:"source.editTitleOneApp",defaultMessage:"{type} & {app} credentials"},{type:null==t?void 0:t.product_name,app:null==s?void 0:s.display_name})}else i=a.formatMessage({id:"source.editTitleMoreApps",defaultMessage:"{type} & application credentials"},{type:null==t?void 0:t.product_name}),o=a.formatMessage({id:"source.editDescriptionMoreApps",defaultMessage:"Use the tabs below to view and edit credentials for connected applications."});return{component:"description",name:"edit-title",Content:ze,title:i,description:o,hideField:0===(null==e?void 0:e.length)&&0===(null==r?void 0:r.length)}},Ke=function(e,t,n,a){return{fields:[].concat(N()(ve(e.source.id,a,t,e.applications)),[We(e.applications,t,n,a,e.authentications)],N()(Ue(e.applications,t,n,e.authentications)),[!!(e.endpoints&&e.endpoints.length>0)&&Oe(t)]).filter(Boolean)}};function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He={loading:!0,source:void 0,initialValues:{},sourceType:void 0,schema:void 0,isSubmitting:!1,initialLoad:!0,submitError:!1,isTimeouted:!1},Je=function(e,t){var n=t.type,a=t.source,r=t.sourceType,i=t.appTypes,o=t.intl,s=t.message,c=t.values,u=t.editing,l=t.removingAuth,p=t.authId;switch(n){case"createForm":return Xe(Xe({},e),{},{sourceType:r,initialValues:W(e.source,r.product_name),schema:Ke(e.source,r,i,o),loading:!1});case"setSource":return Xe(Xe({},e),{},{source:a,initialLoad:!1});case"submit":return Xe(Xe({},e),{},{isSubmitting:!0,submitError:!1,values:c,editing:u});case"submitFinished":return Xe(Xe({},e),{},{isSubmitting:!1,source:a,message:s});case"submitFailed":return Xe(Xe({},e),{},{isSubmitting:!1,submitError:!0});case"submitTimetouted":return Xe(Xe({},e),{},{isSubmitting:!1,isTimeouted:!0});case"removeAuthPending":return Xe(Xe({},e),{},{isAuthRemoving:null,source:Xe(Xe({},e.source),{},{authentications:e.source.authentications.map((function(e){return e.id===p?Xe(Xe({},e),{},{isDeleting:!0}):e}))})});case"removeAuthRejected":return Xe(Xe({},e),{},{source:Xe(Xe({},e.source),{},{authentications:e.source.authentications.map((function(e){return e.id===p?Xe(Xe({},e),{},{isDeleting:!1}):e}))})});case"removeAuthFulfill":return Xe(Xe({},e),{},{source:Xe(Xe({},e.source),{},{authentications:e.source.authentications.filter((function(e){return e.id!==p}))})});case"setAuthRemoving":return Xe(Xe({},e),{},{isAuthRemoving:l});case"closeAuthRemoving":return Xe(Xe({},e),{},{isAuthRemoving:null});default:return e}},$e=n(440),Ye=n.n($e),Ze=n(449),et=n.n(Ze),tt=n(564),nt=n(128),at=n(636),rt=function(e){return l.a.createElement(at.Form,r()({},e,{id:"modal-form"}))},it=function(){var e=Object(m.a)(),t=de()(),n=t.onReset,a=t.onCancel;return l.a.createElement(Ye.a,{subscription:{submitting:!0,pristine:!0,invalid:!0,validating:!0}},(function(t){var r=t.pristine,i=t.invalid,o=t.validating,s=t.submitting;return l.a.createElement("div",{className:"pf-c-form"},l.a.createElement(tt.ActionGroup,{className:"pf-u-mt-0"},l.a.createElement(nt.Button,{variant:"primary",form:"modal-form",type:"submit",isDisabled:r||o||s||i},e.formatMessage({id:"sources.save",defaultMessage:"Save"})),l.a.createElement(nt.Button,{variant:"secondary",isDisabled:r,onClick:n,id:"reset-modal"},e.formatMessage({id:"sources.reset",defaultMessage:"Reset"})),l.a.createElement(nt.Button,{variant:"link",onClick:a,id:"cancel-modal"},e.formatMessage({id:"sources.cancel",defaultMessage:"Cancel"}))))}))},ot=function(e){var t=e.ModalProps,n=F()(e,["ModalProps"]);return l.a.createElement(v.Modal,r()({},t,{footer:l.a.createElement(it,null)}),l.a.createElement(et.a,r()({},n,{showFormControls:!1,FormWrapper:rt})))};ot.propTypes={ModalProps:_.a.object};var st=ot,ct=n(575),ut=n.n(ct),lt=function(){var e=Object(m.a)(),t=Object(d.k)();return l.a.createElement("div",{className:"pf-c-form"},l.a.createElement(tt.ActionGroup,{className:"pf-u-mt-0"},l.a.createElement(nt.Button,{variant:"primary",isDisabled:!0},e.formatMessage({id:"sources.save",defaultMessage:"Save"})),l.a.createElement(nt.Button,{variant:"secondary",isDisabled:!0},e.formatMessage({id:"sources.reset",defaultMessage:"Reset"})),l.a.createElement(nt.Button,{variant:"link",onClick:function(){return t.push(J.c.sources.path)}},e.formatMessage({id:"sources.cancel",defaultMessage:"Cancel"}))))},pt=function(e){var t=e.children,n=Object(d.k)(),a=Object($.a)(),r=Object(m.a)();return l.a.createElement(v.Modal,{"aria-label":r.formatMessage({id:"sources.editSource",defaultMessage:"Edit source."}),header:l.a.createElement(x,{name:a.name}),variant:"large",isOpen:!0,onClose:function(){return n.push(J.c.sources.path)},footer:l.a.createElement(lt,null)},t)};pt.propTypes={children:_.a.node.isRequired};var dt=pt,mt=function(){var e=Object(m.a)();return l.a.createElement(dt,null,l.a.createElement(ut.a,{customText:e.formatMessage({id:"sources.editSubmittingTitle",defaultMessage:"Validating edited source credentials"})}))},ft=n(532),vt=n(896),bt=n(416),ht=n(489),gt=n.n(ht),yt=function(){var e=Object(m.a)();return l.a.createElement(dt,null,l.a.createElement(ke.Bullseye,null,l.a.createElement(vt.EmptyState,{variant:vt.EmptyStateVariant.full,className:"pf-u-mt-4xl"},l.a.createElement(bt.EmptyStateIcon,{icon:gt.a,color:"var(--pf-global--Color--200)",className:"pf-u-mb-0"}),l.a.createElement(ft.Title,{headingLevel:"h2",size:"xl",className:"pf-u-mt-xl"},e.formatMessage({id:"sources.editTimetoutedTitle",defaultMessage:"Edit source not yet complete"})),l.a.createElement(vt.EmptyStateBody,null,e.formatMessage({id:"sources.editTimetoutedDescription",defaultMessage:"We are still working to confirm your updated credentials and app settings.{newLine}To track progress, check the Status column in the Sources table."},{newLine:l.a.createElement("br",{key:"br"})})))))},Ot=n(576),Et=n.n(Ot),jt=function(e){var t=e.onRetry,n=Object(m.a)();return l.a.createElement(dt,null,l.a.createElement(Et.a,{onClose:t,customText:n.formatMessage({id:"sources.editErrorDescription",defaultMessage:"There was a problem while trying to edit your source. Please try again. If the error persists, open a support case."}),secondaryActions:l.a.createElement(oe.Text,{component:"a",target:"_blank",href:"https://access.redhat.com/support/cases/#/case/new/open-case?caseCreate=true",rel:"noopener noreferrer"},n.formatMessage({id:"sources.openTicket",defaultMessage:"Open a support case"})),returnButtonTitle:n.formatMessage({id:"sources.retryText",defaultMessage:"Retry"})}))};jt.propTypes={onRetry:_.a.func.isRequired};var Mt=jt,Tt=n(213),wt=n.n(Tt),Pt=n(477),_t=function(e){var t,n,a=e.authId,r=Object(u.useContext)(Se),i=r.setState,o=r.source,s=r.sourceType,c=null==s||null===(t=s.schema)||void 0===t||null===(n=t.authentication)||void 0===n?void 0:n.find((function(e){var t,n;return e.type===(null==o||null===(t=o.authentications)||void 0===t||null===(n=t.find((function(e){return(null==e?void 0:e.id)===a})))||void 0===n?void 0:n.authtype)})),d=Object(p.useDispatch)(),f=Object(m.a)(),b=function(){return i({type:"closeAuthRemoving"})};return l.a.createElement(v.Modal,{isOpen:!0,className:"ins-c-sources__dialog--warning",onClose:b,actions:[l.a.createElement(Me.Button,{id:"deleteSubmit",key:"submit",variant:"danger",type:"button",onClick:function(){return i({type:"removeAuthPending",authId:a}),b(),Object(E.d)(a).then((function(){i({type:"removeAuthFulfill",authId:a}),d(Object(K.b)(f.formatMessage({id:"sources.authRemoveFullfil",defaultMessage:"Authentication was deleted successfully."}),"success"))})).catch((function(e){i({type:"removeAuthRejected",authId:a}),d(Object(K.b)(f.formatMessage({id:"sources.authRemoveRejected",defaultMessage:"Authentication was not deleted successfully."}),"danger",Object(Pt.handleError)(e)))}))}},f.formatMessage({id:"sources.deleteConfirm",defaultMessage:"Remove authentication"})),l.a.createElement(Me.Button,{id:"deleteCancel",key:"cancel",variant:"link",type:"button",onClick:b},f.formatMessage({id:"sources.deleteCancel",defaultMessage:"Cancel"}))],variant:"small","aria-label":f.formatMessage({id:"sources.deleteAuthTitle",defaultMessage:"Remove authentication?"}),header:l.a.createElement(k.Title,{headingLevel:"h1",size:"2xl"},l.a.createElement(wt.a,{size:"sm",className:"ins-m-alert ins-c-source__delete-icon pf-u-mr-sm"}),f.formatMessage({id:"sources.deleteAppTitle",defaultMessage:"Remove authentication?"}))},l.a.createElement(se.TextContent,null,l.a.createElement(oe.Text,{variant:oe.TextVariants.p},f.formatMessage({id:"sources.removeAuthWarning",defaultMessage:"This action will permanently remove {auth} from this source."},{auth:l.a.createElement("b",{key:"b"},null==c?void 0:c.name)}))))};_t.propTypes={authId:_.a.string.isRequired};var Rt=_t;function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(){var e=Object(u.useReducer)(Je,He),t=c()(e,2),n=t[0],a=t[1],i=Object(d.k)(),s=Object($.a)(),h=Object(Y.a)(),g=n.loading,y=n.editing,O=n.source,E=n.initialValues,j=n.schema,M=n.isSubmitting,T=n.initialLoad,P=n.message,_=n.submitError,R=n.isTimeouted,S=n.values,k=n.sourceType,D=n.isAuthRemoving,A=Object(m.a)(),C=Object(p.useSelector)((function(e){return e.sources}),p.shallowEqual),N=C.sourceTypes,I=C.appTypes,F=C.sourceTypesLoaded,q=C.appTypesLoaded,B=Object(p.useDispatch)();Object(u.useEffect)((function(){s&&T&&w(s).then((function(e){e.source.imported&&function(e,t,n,a){e(Object(K.b)(t.formatMessage({id:"sources.importSourceCannotEdited",defaultMessage:"Source { name } is imported."},{name:a}),"danger",t.formatMessage({id:"sources.importedSourcesCannotEdited",defaultMessage:"Imported sources cannot be edited."}))),n.push(J.c.sources.path)}(B,A,i,e.source.name),a({type:"setSource",source:e})}))}),[s,h]),Object(u.useEffect)((function(){if(O&&q&&F){var e=N.find((function(e){return e.id===O.source.source_type_id}));a({type:"createForm",sourceType:e,source:O,appTypes:I,intl:A})}}),[q,O,F]);var L=!q||!F||g,G=function(){return i.push(J.c.sources.path)};return R?l.a.createElement(yt,null):_?l.a.createElement(Mt,{onRetry:function(){return H(S,y,B,O,A,a)}}):M?l.a.createElement(mt,null):L?l.a.createElement(v.Modal,{"aria-label":A.formatMessage({id:"sources.editSource",defaultMessage:"Edit source."}),header:l.a.createElement(x,null),isOpen:!0,variant:"large",onClose:G},l.a.createElement("div",{className:"ins-c-sources__dialog--spinnerContainer"},l.a.createElement(f.Spinner,null))):l.a.createElement(Se.Provider,{value:{setState:a,source:O,sourceType:k}},D&&l.a.createElement(Rt,{authId:D}),l.a.createElement(b.a,{onCancel:G,schema:j,onSubmit:function(e,t){return H(e,t.getState().dirtyFields,B,O,A,a)},FormTemplate:function(e){var t;return l.a.createElement(st,r()({ModalProps:(t={},o()(t,"aria-label",A.formatMessage({id:"sources.editSource",defaultMessage:"Edit source."})),o()(t,"header",l.a.createElement(x,{name:O.source.name})),o()(t,"variant","large"),o()(t,"isOpen",!D),o()(t,"onClose",G),t)},e))},clearedValue:null,initialValues:kt(kt({},E),{},{message:P})}))}}}]);
//# sourceMappingURL=../sourcemaps/edit.js.map