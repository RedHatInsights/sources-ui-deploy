(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{511:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n(2),a=n.n(r),i=n(388),o=n(22),c=n(11);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){return e.url||null===e.url?function(e){if(null===e)return{scheme:null,host:null,port:null,path:null};if(!e)return{};try{var t=new URL(e),n=t.protocol.replace(/:$/,"");return{scheme:n,host:t.hostname,port:""===t.port?Object(i.b)(n):t.port,path:t.pathname}}catch(e){return{}}}(e.url):e.endpoint?e.endpoint:e},d=function(e,t){var n,r,a=[];if(t.source&&a.push(Object(o.k)().updateSource(e.source.id,t.source)),t.endpoint||t.url||null===t.url){var i=l(t),s=i.scheme,d=i.host,p=i.port,m=i.path,f=null===p?null:parseInt(p,10),h=u({scheme:s,host:d,path:m,port:null===f?null:isNaN(f)?void 0:f},t.endpoint);a.push(Object(o.k)().updateEndpoint(e.endpoints[0].id,h))}if(t.authentications&&Object.keys(t.authentications).forEach((function(e){var n=e.replace("a","");a.push(Object(o.k)().updateAuthentication(n,t.authentications[e]))})),t.billing_source||t.credentials){var b={};t.credentials&&(b={authentication:{credentials:t.credentials}}),t.billing_source&&(b=u(u({},b),{},{billing_source:t.billing_source})),a.push((n=e.source.id,r=b,o.a.patch("".concat(c.a,"/sources/").concat(n,"/"),r)))}return Promise.all(a)}},512:function(e,t,n){"use strict";var r=n(91),a=n.n(r),i=n(2),o=n.n(i),c=n(0),s=n.n(c),u=n(395),l=n.n(u),d=n(340),p=n.n(d),m=n(339),f=n.n(m),h=n(385),b=n.n(h),v=n(379),g=n.n(v),y=n(400),O=n.n(y),E=n(493),j=n(38),M=n.n(j),w=n(344),T=n.n(w),P=n(342),S=n(362),D=n(490),R=n.n(D),x=n(338),_=n.n(x),k=n(403),A=n.n(k);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e){var t,n,r=_()(),i=r.getState().values,o=(null==e||null===(t=e.name)||void 0===t?void 0:t.match(/\d+/))||[],u=M()(o,1)[0]||(null===(n=i.authentication)||void 0===n?void 0:n.id),l=T()(i,e.name),d=Object(c.useState)(!u||l),p=M()(d,2),m=p[0],h=p[1],b=Object(c.useRef)(!0),v=Object(c.useRef)(!1);Object(c.useEffect)((function(){v.current&&(!b.current&&r.getState().pristine&&(h(!1),b.current=!0),m&&(b.current=!1))})),Object(c.useEffect)((function(){v.current=!0}),[]);var g=e.validate&&e.validate.filter((function(e){return e.type!==f.a.REQUIRED})),y=I(I({},e),u?{validate:g,resolveProps:A.a}:{});return m?s.a.createElement(R.a,a()({},y,{autoFocus:!0})):s.a.createElement(P.FormGroup,{helperText:y.helperText,label:y.label,onFocus:function(){return h(!0)},isRequired:!0},s.a.createElement(S.TextInput,{"aria-label":"pre-filled-authentication",value:"•••••••••••••"}))};function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){return s.a.createElement(l.a,a()({FormTemplate:g.a,componentMapper:B(B(B({},O.a),E.mapperExtension),{},{authentication:F,"switch-field":O.a[p.a.SWITCH]}),validatorMapper:{"required-validator":b.a[f.a.REQUIRED],"pattern-validator":b.a[f.a.PATTERN],"min-length-validator":b.a[f.a.MIN_LENGTH],"url-validator":b.a[f.a.URL]}},e))}},842:function(e,t,n){"use strict";n.r(t);var r=n(91),a=n.n(r),i=n(2),o=n.n(i),c=n(38),s=n.n(c),u=n(0),l=n.n(u),d=n(30),p=n(10),m=n(194),f=n(100),h=n(420),b=n(512),v=n(70),g=n.n(v),y=n(94),O=n.n(y),E=n(22),j=n(11);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(e){return Promise.all([Object(E.k)().showSource(e.id),Object(E.k)().listSourceEndpoints(e.id),Object(E.f)(e.id),(t=e.id,E.a.get("".concat(j.a,"/sources/").concat(t,"/"))).catch((function(){}))]).then(function(){var t=O()(g.a.mark((function t(n){var r,a,i,o,c,u,l,d,p,m,f,h,b;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=s()(n,4),i=a[0],o=a[1],c=a[2],u=a[3],l=o&&o.data&&o.data[0],d=(null==c||null===(r=c.sources[0])||void 0===r?void 0:r.applications)||[],p={source:w(w({},e),i),applications:d},u&&(p=w(w({},p),{},{billing_source:u.billing_source,credentials:u.authentication.credentials})),m=[],h=[],b=[],d.forEach((function(e){var t;null==e||null===(t=e.authentications)||void 0===t||t.forEach((function(t){(null==t?void 0:t.id)&&(m.push(Object(E.k)().showAuthentication(t.id)),h.push(e.id),b.push(t.id))}))})),!(m.length>0)){t.next=14;break}return t.next=12,Promise.all(m);case 12:f=t.sent,h.forEach((function(e,t){p.applications.find((function(t){return t.id===e})).authentications.push(f[t])}));case 14:if(l){t.next=16;break}return t.abrupt("return",p);case 16:return t.abrupt("return",Object(E.k)().listEndpointAuthentications(l.id).then((function(e){return w(w({},p),{},{endpoints:o.data,authentications:e.data.filter((function(e){var t=e.id;return!b.includes(t)}))})})));case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());var t},P=n(9),S=n.n(P),D=n(346),R=n(347),x=n(155),_=function(e){var t=e.name,n=Object(m.a)();return l.a.createElement(D.Grid,null,l.a.createElement(R.GridItem,{xs:12},l.a.createElement(x.Title,{headingLevel:"h1",size:"3xl"},n.formatMessage({id:"sources.editSource",defaultMessage:"Edit source"}))),t&&l.a.createElement(R.GridItem,{xs:12},n.formatMessage({id:"sources.editSourceDescription",defaultMessage:"Use the form fields below to make desired changes to source {name}."},{name:l.a.createElement("b",{key:"b"},t)})))};_.propTypes={name:S.a.node};var k=_,A=n(450),C=n(36),I=n.n(C),F=n(69),N=n.n(F),B=n(344),G=n.n(B),L=n(759),q=n.n(L),U=n(388);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var z=function(e,t){var n={};return Object.keys(t).filter((function(e){return t[e]})).forEach((function(t){q()(n,t,G()(e,t))})),n},K=function(e,t){var n,r,a=e.endpoints,i=e.authentications,c=e.applications,s=N()(e,["endpoints","authentications","applications"]),u={},l=[].concat(I()(i||[]),I()((null==c?void 0:c.reduce((function(e,t){return[].concat(I()(e),I()(t.authentications))}),[]))||[]));return l.length>0&&l.forEach((function(e){u["a".concat(e.id)]=e})),a&&a.length>0&&(n=a[0]),n&&(r=n.scheme||n.host||n.path||n.port?Object(U.c)(n):void 0),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({source_type:t,endpoint:n,authentications:u,url:r},s)},Q=n(89),W=n(474),X=n(511),H=function(){var e=O()(g.a.mark((function e(t,n,r,a,i,o){var c,s,u,l,d,p;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o({type:"submit",values:t,editing:n}),e.prev=1,e.next=4,Object(X.a)(a,z(t,n));case 4:e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(1),o({type:"submitFailed"}),e.abrupt("return");case 10:return Object(W.a)(a.source.id),r(Object(Q.f)()),e.next=14,T({id:a.source.id});case 14:if(u=e.sent,!((l=(null===(c=a.applications)||void 0===c?void 0:c.map((function(e){var t=e.id;return Object(A.checkAppAvailability)(t)})))||[]).length>0)){e.next=36;break}return e.prev=17,e.next=20,Promise.all(l);case 20:d=e.sent,e.next=27;break;case 23:return e.prev=23,e.t1=e.catch(17),o({type:"submitFailed"}),e.abrupt("return");case 27:if(!(p=d.find((function(e){return e.availability_status===U.a})))){e.next=32;break}return s={title:i.formatMessage({id:"wizard.failEditToastTitle",defaultMessage:"Edit source failed"}),description:p.availability_status_error,variant:"danger"},o({type:"submitFinished",source:u,message:s}),e.abrupt("return");case 32:if(!d.some((function(e){return!e.availability_status}))){e.next=36;break}return o({type:"submitTimetouted"}),e.abrupt("return");case 36:s={title:i.formatMessage({id:"wizard.successEditToastTitle",defaultMessage:"Source ‘{name}’ was edited successfully."},{name:a.source.name}),variant:"success"},o({type:"submitFinished",source:u,message:s});case 38:case"end":return e.stop()}}),e,null,[[1,6],[17,23]])})));return function(t,n,r,a,i,o){return e.apply(this,arguments)}}(),J=n(90),$=n(375),Y=n(411),Z=n(340),ee=n.n(Z),te=n(499),ne=n(339),re=n.n(ne),ae=n(403),ie=n.n(ae),oe=n(152),ce=n(153),se=n(455),ue=function(e){var t=e.sourceType,n=e.applications,r=Object(m.a)(),a=Object(d.useSelector)((function(e){return e.sources.appTypes})),i=null==n?void 0:n.map((function(e){var t,n=e.application_type_id;return null==a||null===(t=a.find((function(e){return e.id===n})))||void 0===t?void 0:t.display_name}));return l.a.createElement(ce.TextContent,null,l.a.createElement(se.Grid,{hasGutter:!0},l.a.createElement(se.GridItem,{md:2},l.a.createElement(oe.Text,{component:oe.TextVariants.h4},r.formatMessage({id:"sources.sourceType",defaultMessage:"Source type"})),l.a.createElement(oe.Text,{component:oe.TextVariants.p,id:"source-edit-type"},t.product_name)),l.a.createElement(se.GridItem,{md:8},l.a.createElement(oe.Text,{component:oe.TextVariants.h4},r.formatMessage({id:"sources.apps",defaultMessage:"Applications"})),l.a.createElement(oe.Text,{component:oe.TextVariants.p,id:"source-edit-apps"},i.length>0?i.join(", "):r.formatMessage({id:"sources.none",defaultMessage:"None"})))))};ue.propTypes={sourceType:S.a.shape({product_name:S.a.string.isRequired}),applications:S.a.arrayOf(S.a.shape({application_type_id:S.a.string.isRequired}))};var le=ue,de=n(338),pe=n.n(de),me=n(163),fe=function(){var e=pe()().getState().values.message;return l.a.createElement(me.Alert,{variant:null==e?void 0:e.variant,isInline:!0,title:null==e?void 0:e.title},null==e?void 0:e.description)},he=function(e,t,n,r){return[{name:"alert",component:"description",Content:fe,condition:{when:"message",isNotEmpty:!0}},{name:"source.name",label:t.formatMessage({id:"sources.sourceName",defaultMessage:"Source name"}),component:ee.a.TEXT_FIELD,validate:[function(n){return Object(te.asyncValidatorDebounced)(n,e,t)},{type:re.a.REQUIRED}],isRequired:!0,resolveProps:ie.a},{name:"additional_info",Content:le,component:"description",sourceType:n,applications:r}]},be=n(561),ve=n.n(be);function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oe=function(e){if(e.schema&&e.schema.endpoint&&!e.schema.endpoint.hidden){var t=e.schema.endpoint.fields.map((function(t){return ye(ye({},t),function(e,t){return G()(ve.a,[e,"endpoint",t],{})}(e.name,t.name))})),n={component:ee.a.SUB_FORM,name:"endpoint"};if("ansible-tower"===e.name){var r,a=t.find((function(e){return"url"===e.name}));return ye(ye({},n),{},{fields:[{component:ee.a.SUB_FORM,name:"receptor_node_group",condition:{when:"endpoint.receptor_node",isNotEmpty:!0},fields:[ye(ye({},a),{},{isRequired:!1,validate:null==a||null===(r=a.validate)||void 0===r?void 0:r.filter((function(e){return e.type!==re.a.REQUIRED}))})]},{component:ee.a.SUB_FORM,name:"hostname_group",condition:{when:"endpoint.receptor_node",isEmpty:!0},fields:t}]})}return ye(ye({},n),{},{fields:t})}},Ee=n(514),je=n(761),Me=n(87),we=n(766),Te=n.n(we),Pe=n(342),Se=function(e){var t=e.id,n=Object(m.a)();return l.a.createElement(Pe.FormGroup,{label:n.formatMessage({id:"sources.authId",defaultMessage:"Authentication ID"})},l.a.createElement(ce.TextContent,null,l.a.createElement(oe.Text,{variant:"p"},t)))};Se.propTypes={id:S.a.string.isRequired};var De=Se,Re=Object(u.createContext)(),xe=n(99),_e=function(){var e=Object(m.a)();return l.a.createElement(se.Grid,null,l.a.createElement(se.GridItem,{xs:12},l.a.createElement(xe.Bullseye,null,l.a.createElement(f.Spinner,{size:"lg"}))),l.a.createElement(se.GridItem,{xs:12},l.a.createElement(xe.Bullseye,null,l.a.createElement(ce.TextContent,null,l.a.createElement(oe.Text,{component:oe.TextVariants.small,className:"pf-u-mt-md"},e.formatMessage({id:"sources.removingAuthMessage",defaultMessage:"This authentication is being removed..."}))))))},ke=function(e){var t,n,r=e.id,a=e.fields,i=Object(m.a)(),o=pe()().renderForm,c=Object(u.useContext)(Re),s=c.setState,d=c.source;return(null==d||null===(t=d.authentications)||void 0===t||null===(n=t.find((function(e){return e.id===r})))||void 0===n?void 0:n.isDeleting)?l.a.createElement(_e,null):l.a.createElement(D.Grid,null,l.a.createElement(R.GridItem,{md:2},l.a.createElement(je.Flex,null,l.a.createElement(je.FlexItem,{className:"pf-u-mr-0"},l.a.createElement(Me.Button,{variant:"plain","aria-label":i.formatMessage({id:"sources.removeAuthAriaLabel",defaultMessage:"Remove authentication with id {id}"},{id:r}),onClick:function(){return s({type:"setAuthRemoving",removingAuth:r})}},l.a.createElement(Te.a,null))),l.a.createElement(je.Flex,null,l.a.createElement(De,{id:r})))),l.a.createElement(R.GridItem,{md:10},o(a)))};ke.propTypes={id:S.a.string.isRequired,fields:S.a.array.isRequired};var Ae=ke;function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fe=function(e,t){var n;return(null==e||null===(n=e.fields)||void 0===n?void 0:n.filter((function(e){return e.stepKey===t})))||[]},Ne=function(e,t){return e.map((function(e){var n=e.name.startsWith("authentication")?function(e,t){return"authentications.a".concat(t,".").concat(e.replace("authentication.",""))}(e.name,t):e.name,r=Ie(Ie({},e),{},{name:n});return"password"===r.name.split(".").pop()&&(r.component="authentication"),r}))},Be=function(e,t,n){return e&&0!==e.length&&t.schema&&t.schema.authentication?e.map((function(e){var r,a,i,o=null==t||null===(r=t.schema)||void 0===r||null===(a=r.authentication)||void 0===a?void 0:a.find((function(t){return t.type===e.authtype}));if(!o)return[];var c=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return G()(ve.a,[e,"authentication",t,n,"includeStepKeyFields"],[])}(t.name,e.authtype,n),s=null===(i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return G()(ve.a,[e,"authentication",t,n,"additionalSteps"],[])}(t.name,e.authtype,n))||void 0===i?void 0:i.map((function(e){return Ie(Ie({},e),{},{fields:[].concat(I()(e.fields),I()(Fe(o,e.name)))})})).map((function(e){return e.fields.map((function(e){return e.name}))})).flatMap((function(e){return e})),u=o.fields.filter((function(e){return s.includes(e.name)||!e.stepKey||e.stepKey&&c.includes(e.stepKey)})).map((function(r){return Ie(Ie({},r),function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"generic";return G()(ve.a,[e,"authentication",t,r,n],{})}(t.name,e.authtype,r.name,n))}));return n?Ne(u,e.id):[{name:"authentication-".concat(e.id),component:"description",id:e.id,Content:Ae,fields:Ne(u,e.id)}]})):[]},Ge="/insights/platform/cost-management",Le=function(e,t,n){var r;return[].concat(I()(Be(null===(r=n.authentications)||void 0===r?void 0:r.filter((function(e){return Object.keys(e).length>1})),t,null==e?void 0:e.name)),I()((null==e?void 0:e.name)===Ge?function(e){return"openshift"===e.name?[{name:"source.source_ref",label:l.a.createElement(Ee.a,{id:"sources.clusterIdentifier",defaultMessage:"Cluster identifier"}),isRequired:!0,validate:[{type:re.a.REQUIRED}],component:ee.a.TEXT_FIELD}]:[]}(t):[]))},qe=function(e){return{component:ee.a.PLAIN_TEXT,name:"unused-auth-warning",label:l.a.createElement(Ee.a,{id:"sources.authNotUsed",defaultMessage:"The following {length, plural, one {authentication is not} other {authentications are not}} used by any application.",values:{length:e}})}},Ue=function(e,t,n,r){var a=function(e,t,n){var r,a,i;if(!e||0===e.length)return[];var o=null==t||null===(r=t.schema)||void 0===r||null===(a=r.authentication)||void 0===a||null===(i=a.reduce((function(n,r){var a=r.type,i=e.filter((function(e){var t=e.authtype;return a===t}));return(null==i?void 0:i.length)>0?[].concat(I()(n),I()(Be(i,t))):n}),[]))||void 0===i?void 0:i.filter(Boolean);return o=0!==n?[{fields:[qe(o.length)].concat(I()(o)),title:t.product_name,name:"unused-auths-tab"}]:[{fields:[qe(o.length)].concat(I()(o)),component:ee.a.SUB_FORM,name:"unused-auths-group"}]}(r,t,null==e?void 0:e.length);if(e&&0!==e.length){if(1===e.length&&0===a.length){var i=n.find((function(t){return t.id===e[0].application_type_id}));return Le(i,t,e[0])}return[{component:ee.a.TABS,name:"app-tabs",fields:[].concat(I()(e.map((function(e){var r=n.find((function(t){return t.id===e.application_type_id}));return{name:null==r?void 0:r.id,title:null==r?void 0:r.display_name,fields:Le(r,t,e)}}))),I()(a))}]}return a},Ve=function(e){var t=e.title,n=e.description;return l.a.createElement(ce.TextContent,null,l.a.createElement(x.Title,{headingLevel:"h2",className:"pf-u-mb-0"},t),n&&l.a.createElement(oe.Text,{variant:"p"},n))};Ve.propTypes={title:S.a.node.isRequired,description:S.a.node};var ze=function(e,t,n,r,a){var i,o;if(0===e.length)i=r.formatMessage({id:"source.editTitleNoApp",defaultMessage:"{type} credentials"},{type:null==t?void 0:t.product_name});else if(1===e.length){var c=n.find((function(t){return t.id===e[0].application_type_id}));i=r.formatMessage({id:"source.editTitleOneApp",defaultMessage:"{type} & {app} credentials"},{type:null==t?void 0:t.product_name,app:null==c?void 0:c.display_name})}else i=r.formatMessage({id:"source.editTitleMoreApps",defaultMessage:"{type} & application credentials"},{type:null==t?void 0:t.product_name}),o=r.formatMessage({id:"source.editDescriptionMoreApps",defaultMessage:"Use the tabs below to view and edit credentials for connected applications."});return{component:"description",name:"edit-title",Content:Ve,title:i,description:o,hideField:0===(null==e?void 0:e.length)&&0===(null==a?void 0:a.length)}},Ke=function(e,t,n,r){return{fields:[].concat(I()(he(e.source.id,r,t,e.applications)),[ze(e.applications,t,n,r,e.authentications)],I()(Ue(e.applications,t,n,e.authentications)),[!!(e.endpoints&&e.endpoints.length>0)&&Oe(t)]).filter(Boolean)}};function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xe={loading:!0,source:void 0,initialValues:{},sourceType:void 0,schema:void 0,isSubmitting:!1,initialLoad:!0,submitError:!1,isTimeouted:!1},He=function(e,t){var n=t.type,r=t.source,a=t.sourceType,i=t.appTypes,o=t.intl,c=t.message,s=t.values,u=t.editing,l=t.removingAuth,d=t.authId;switch(n){case"createForm":return We(We({},e),{},{sourceType:a,initialValues:K(e.source,a.product_name),schema:Ke(e.source,a,i,o),loading:!1});case"setSource":return We(We({},e),{},{source:r,initialLoad:!1});case"submit":return We(We({},e),{},{isSubmitting:!0,submitError:!1,values:s,editing:u});case"submitFinished":return We(We({},e),{},{isSubmitting:!1,source:r,message:c});case"submitFailed":return We(We({},e),{},{isSubmitting:!1,submitError:!0});case"submitTimetouted":return We(We({},e),{},{isSubmitting:!1,isTimeouted:!0});case"removeAuthPending":return We(We({},e),{},{isAuthRemoving:null,source:We(We({},e.source),{},{authentications:e.source.authentications.map((function(e){return e.id===d?We(We({},e),{},{isDeleting:!0}):e}))})});case"removeAuthRejected":return We(We({},e),{},{source:We(We({},e.source),{},{authentications:e.source.authentications.map((function(e){return e.id===d?We(We({},e),{},{isDeleting:!1}):e}))})});case"removeAuthFulfill":return We(We({},e),{},{source:We(We({},e.source),{},{authentications:e.source.authentications.filter((function(e){return e.id!==d}))})});case"setAuthRemoving":return We(We({},e),{},{isAuthRemoving:l});case"closeAuthRemoving":return We(We({},e),{},{isAuthRemoving:null});default:return e}},Je=n(366),$e=n.n(Je),Ye=n(379),Ze=n.n(Ye),et=n(483),tt=n(88),nt=n(531),rt=function(e){return l.a.createElement(nt.Form,a()({},e,{id:"modal-form"}))},at=function(){var e=Object(m.a)(),t=pe()(),n=t.onReset,r=t.onCancel;return l.a.createElement($e.a,{subscription:{submitting:!0,pristine:!0,invalid:!0,validating:!0}},(function(t){var a=t.pristine,i=t.invalid,o=t.validating,c=t.submitting;return l.a.createElement("div",{className:"pf-c-form"},l.a.createElement(et.ActionGroup,{className:"pf-u-mt-0"},l.a.createElement(tt.Button,{variant:"primary",form:"modal-form",type:"submit",isDisabled:a||o||c||i},e.formatMessage({id:"sources.save",defaultMessage:"Save"})),l.a.createElement(tt.Button,{variant:"secondary",isDisabled:a,onClick:n,id:"reset-modal"},e.formatMessage({id:"sources.reset",defaultMessage:"Reset"})),l.a.createElement(tt.Button,{variant:"link",onClick:r,id:"cancel-modal"},e.formatMessage({id:"sources.cancel",defaultMessage:"Cancel"}))))}))},it=function(e){var t=e.ModalProps,n=N()(e,["ModalProps"]);return l.a.createElement(h.Modal,a()({},t,{footer:l.a.createElement(at,null)}),l.a.createElement(Ze.a,a()({},n,{showFormControls:!1,FormWrapper:rt})))};it.propTypes={ModalProps:S.a.object};var ot=it,ct=n(500),st=n.n(ct),ut=function(){var e=Object(m.a)(),t=Object(p.k)();return l.a.createElement("div",{className:"pf-c-form"},l.a.createElement(et.ActionGroup,{className:"pf-u-mt-0"},l.a.createElement(tt.Button,{variant:"primary",isDisabled:!0},e.formatMessage({id:"sources.save",defaultMessage:"Save"})),l.a.createElement(tt.Button,{variant:"secondary",isDisabled:!0},e.formatMessage({id:"sources.reset",defaultMessage:"Reset"})),l.a.createElement(tt.Button,{variant:"link",onClick:function(){return t.push(J.c.sources.path)}},e.formatMessage({id:"sources.cancel",defaultMessage:"Cancel"}))))},lt=function(e){var t=e.children,n=Object(p.k)(),r=Object($.a)(),a=Object(m.a)();return l.a.createElement(h.Modal,{"aria-label":a.formatMessage({id:"sources.editSource",defaultMessage:"Edit source."}),header:l.a.createElement(k,{name:r.name}),variant:"large",isOpen:!0,onClose:function(){return n.push(J.c.sources.path)},footer:l.a.createElement(ut,null)},t)};lt.propTypes={children:S.a.node.isRequired};var dt=lt,pt=function(){var e=Object(m.a)();return l.a.createElement(dt,null,l.a.createElement(st.a,{customText:e.formatMessage({id:"sources.editSubmittingTitle",defaultMessage:"Validating edited source credentials"})}))},mt=n(462),ft=n(771),ht=n(361),bt=n(430),vt=n.n(bt),gt=function(){var e=Object(m.a)();return l.a.createElement(dt,null,l.a.createElement(xe.Bullseye,null,l.a.createElement(ft.EmptyState,{variant:ft.EmptyStateVariant.full,className:"pf-u-mt-4xl"},l.a.createElement(ht.EmptyStateIcon,{icon:vt.a,color:"var(--pf-global--Color--200)",className:"pf-u-mb-0"}),l.a.createElement(mt.Title,{headingLevel:"h2",size:"xl",className:"pf-u-mt-xl"},e.formatMessage({id:"sources.editTimetoutedTitle",defaultMessage:"Edit source not yet complete"})),l.a.createElement(ft.EmptyStateBody,null,e.formatMessage({id:"sources.editTimetoutedDescription",defaultMessage:"We are still working to confirm your updated credentials and app settings.{newLine}To track progress, check the Status column in the Sources table."},{newLine:l.a.createElement("br",{key:"br"})})))))},yt=n(501),Ot=n.n(yt),Et=function(e){var t=e.onRetry,n=Object(m.a)();return l.a.createElement(dt,null,l.a.createElement(Ot.a,{onClose:t,customText:n.formatMessage({id:"sources.editErrorDescription",defaultMessage:"There was a problem while trying to edit your source. Please try again. If the error persists, open a support case."}),secondaryActions:l.a.createElement(oe.Text,{component:"a",target:"_blank",href:"https://access.redhat.com/support/cases/#/case/new/open-case?caseCreate=true",rel:"noopener noreferrer"},n.formatMessage({id:"sources.openTicket",defaultMessage:"Open a support case"})),returnButtonTitle:n.formatMessage({id:"sources.retryText",defaultMessage:"Retry"})}))};Et.propTypes={onRetry:S.a.func.isRequired};var jt=Et,Mt=n(159),wt=n.n(Mt),Tt=n(404),Pt=function(e){var t,n,r=e.authId,a=Object(u.useContext)(Re),i=a.setState,o=a.source,c=a.sourceType,s=null==c||null===(t=c.schema)||void 0===t||null===(n=t.authentication)||void 0===n?void 0:n.find((function(e){var t,n;return e.type===(null==o||null===(t=o.authentications)||void 0===t||null===(n=t.find((function(e){return(null==e?void 0:e.id)===r})))||void 0===n?void 0:n.authtype)})),p=Object(d.useDispatch)(),f=Object(m.a)(),b=function(){return i({type:"closeAuthRemoving"})};return l.a.createElement(h.Modal,{isOpen:!0,className:"ins-c-sources__dialog--warning",onClose:b,actions:[l.a.createElement(Me.Button,{id:"deleteSubmit",key:"submit",variant:"danger",type:"button",onClick:function(){return i({type:"removeAuthPending",authId:r}),b(),Object(E.d)(r).then((function(){i({type:"removeAuthFulfill",authId:r}),p(Object(Q.b)(f.formatMessage({id:"sources.authRemoveFullfil",defaultMessage:"Authentication was deleted successfully."}),"success"))})).catch((function(e){i({type:"removeAuthRejected",authId:r}),p(Object(Q.b)(f.formatMessage({id:"sources.authRemoveRejected",defaultMessage:"Authentication was not deleted successfully."}),"danger",Object(Tt.handleError)(e)))}))}},f.formatMessage({id:"sources.deleteConfirm",defaultMessage:"Remove authentication"})),l.a.createElement(Me.Button,{id:"deleteCancel",key:"cancel",variant:"link",type:"button",onClick:b},f.formatMessage({id:"sources.deleteCancel",defaultMessage:"Cancel"}))],variant:"small","aria-label":f.formatMessage({id:"sources.deleteAuthTitle",defaultMessage:"Remove authentication?"}),header:l.a.createElement(x.Title,{headingLevel:"h1",size:"2xl"},l.a.createElement(wt.a,{size:"sm",className:"ins-m-alert ins-c-source__delete-icon pf-u-mr-sm"}),f.formatMessage({id:"sources.deleteAppTitle",defaultMessage:"Remove authentication?"}))},l.a.createElement(ce.TextContent,null,l.a.createElement(oe.Text,{variant:oe.TextVariants.p},f.formatMessage({id:"sources.removeAuthWarning",defaultMessage:"This action will permanently remove {auth} from this source."},{auth:l.a.createElement("b",{key:"b"},null==s?void 0:s.name)}))))};Pt.propTypes={authId:S.a.string.isRequired};var St=Pt;function Dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(){var e=Object(u.useReducer)(He,Xe),t=s()(e,2),n=t[0],r=t[1],i=Object(p.k)(),c=Object($.a)(),v=Object(Y.a)(),g=n.loading,y=n.editing,O=n.source,E=n.initialValues,j=n.schema,M=n.isSubmitting,w=n.initialLoad,P=n.message,S=n.submitError,D=n.isTimeouted,R=n.values,x=n.sourceType,_=n.isAuthRemoving,A=Object(m.a)(),C=Object(d.useSelector)((function(e){return e.sources}),d.shallowEqual),I=C.sourceTypes,F=C.appTypes,N=C.sourceTypesLoaded,B=C.appTypesLoaded,G=Object(d.useDispatch)();Object(u.useEffect)((function(){c&&w&&T(c).then((function(e){e.source.imported&&function(e,t,n,r){e(Object(Q.b)(t.formatMessage({id:"sources.importSourceCannotEdited",defaultMessage:"Source { name } is imported."},{name:r}),"danger",t.formatMessage({id:"sources.importedSourcesCannotEdited",defaultMessage:"Imported sources cannot be edited."}))),n.push(J.c.sources.path)}(G,A,i,e.source.name),r({type:"setSource",source:e})}))}),[c,v]),Object(u.useEffect)((function(){if(O&&B&&N){var e=I.find((function(e){return e.id===O.source.source_type_id}));r({type:"createForm",sourceType:e,source:O,appTypes:F,intl:A})}}),[B,O,N]);var L=!B||!N||g,q=function(){return i.push(J.c.sources.path)};return D?l.a.createElement(gt,null):S?l.a.createElement(jt,{onRetry:function(){return H(R,y,G,O,A,r)}}):M?l.a.createElement(pt,null):L?l.a.createElement(h.Modal,{"aria-label":A.formatMessage({id:"sources.editSource",defaultMessage:"Edit source."}),header:l.a.createElement(k,null),isOpen:!0,variant:"large",onClose:q},l.a.createElement("div",{className:"ins-c-sources__dialog--spinnerContainer"},l.a.createElement(f.Spinner,null))):l.a.createElement(Re.Provider,{value:{setState:r,source:O,sourceType:x}},_&&l.a.createElement(St,{authId:_}),l.a.createElement(b.a,{onCancel:q,schema:j,onSubmit:function(e,t){return H(e,t.getState().dirtyFields,G,O,A,r)},FormTemplate:function(e){var t;return l.a.createElement(ot,a()({ModalProps:(t={},o()(t,"aria-label",A.formatMessage({id:"sources.editSource",defaultMessage:"Edit source."})),o()(t,"header",l.a.createElement(k,{name:O.source.name})),o()(t,"variant","large"),o()(t,"isOpen",!_),o()(t,"onClose",q),t)},e))},clearedValue:null,initialValues:Rt(Rt({},E),{},{message:P})}))}}}]);
//# sourceMappingURL=../sourcemaps/edit.js.map