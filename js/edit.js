(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{300:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(295),a=n.n(r),o=n(0),i=n.n(o),c=n(3),s=n.n(c),u=n(388),l=n.n(u),p=n(44),d=n(340),f="edit-field",m=function(e){var t=e.isRequired,n=e.label,r=e.helperText,a=e.hideLabel,o=e.meta,c=e.input,s=e.type,u=e.setEdit,f=o.error,m=o.touched&&f,h=c.value;"boolean"==typeof h&&(h=h?"True":"False");var b="password"===s||c.name.includes("password")?"Click to edit":"Click to add";return i.a.createElement(d.FormGroup,{isRequired:t,label:!a&&n,fieldId:c.name,isValid:!m,helperText:r,helperTextInvalid:f,onClick:u?function(){return u(c.name)}:void 0,tabIndex:0,onKeyPress:function(e){32===e.charCode&&u&&(e.preventDefault(),u(c.name))}},i.a.createElement("div",{className:"pf-c-form__horizontal-group ins-c-sources__edit-field-group ".concat(u?"clickable":"")},i.a.createElement(p.TextContent,{className:"ins-c-sources__edit-field-group-text-content ".concat(u?"clickable":"")},i.a.createElement("span",{className:"ins-c-sources__edit-field-value pf-u-mr-sm"},h||(u?b:"")),u&&i.a.createElement(l.a,null))))};m.propTypes={label:s.a.node,isRequired:s.a.bool,helperText:s.a.node,meta:s.a.object.isRequired,FieldProvider:s.a.oneOfType([s.a.node,s.a.func]),input:s.a.shape({value:s.a.any,name:s.a.string.isRequired}).isRequired,hideLabel:s.a.bool,setEdit:s.a.func,type:s.a.string};var h=function(e){var t=e.FieldProvider,n=a()(e,["FieldProvider"]);return i.a.createElement(t,n,(function(e){return i.a.createElement(m,e)}))};h.propTypes={FieldProvider:s.a.oneOfType([s.a.node,s.a.func]).isRequired},t.b=h},386:function(e,t,n){"use strict";var r=n(311),a=n.n(r),o=n(1),i=n.n(o),c=n(0),s=n.n(c),u=n(286),l=n.n(u),p=n(338),d=n(287),f=n(300);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){return s.a.createElement(l.a,a()({layoutMapper:p.layoutMapper,formFieldsMapper:h({},p.formFieldsMapper,{},d.mapperExtension,{"edit-field":f.b})},e))}},711:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(37),i=n.n(o),c=n(0),s=n.n(c),u=n(30),l=n(29),p=n(280),d=n(312),f=n(338),m=n(462),h=n(386),b=n(13),O=n(9);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=n(311),v=n.n(j),E=n(295),P=n.n(E),w=n(3),T=n.n(w),S=n(458),D=function(e){var t=e.children,n=P()(e,["children"]);return s.a.createElement(S.Form,v()({},n,{isHorizontal:!0}),t)};D.propTypes={children:T.a.node};var M=D,C=n(11),R=n(323),_=n(324),x=n(129),A=function(){return s.a.createElement(R.Grid,null,s.a.createElement(_.GridItem,{xs:12},s.a.createElement(x.Title,{headingLevel:x.TitleLevel.h1,size:"3xl"},s.a.createElement(C.a,{id:"sources.editSource",defaultMessage:"Edit source"}))),s.a.createElement(_.GridItem,{xs:12},s.a.createElement(C.a,{id:"sources.editSourceDescription",defaultMessage:"You are editing a source."})))},k=n(296),F=n.n(k),I=n(650),N=n.n(I),q=n(84);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var B=function(e,t){var n,r,o=e.endpoints,i=e.authentications,c=P()(e,["endpoints","authentications"]),s={};return i&&i.length>0&&i.forEach((function(e){s["a".concat(e.id)]=e})),o&&o.length>0&&(n=o[0]),n&&(r=n.scheme||n.host||n.path||n.port?Object(q.b)(n):void 0),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({source_type:t,endpoint:n,authentications:s,url:r},c)},V=n(45),G=n(79),W=n(373),z=function(e,t,n,r,a,o){return n(Object(V.o)(r,function(e,t){var n={};return Object.keys(t).filter((function(e){return t[e]})).forEach((function(t){N()(n,t,F()(e,t))})),n}(e,t),a.formatMessage({id:"sources.modifiedNotificationTitle",defaultMessage:'"{ name }" was modified successfully.'},{name:r.source.name}),a.formatMessage({id:"sources.modifiedNotificationDescription",defaultMessage:"The source was successfully modified."}),{authentication:a.formatMessage({id:"sources.sourceEditAuthFailure",defaultMessage:"Authentication update failure."}),source:a.formatMessage({id:"sources.sourceEditFailure",defaultMessage:"Source update failure."}),endpoint:a.formatMessage({id:"sources.sourceEditEndpointFailure",defaultMessage:"Endpoint update failure."}),costManagement:a.formatMessage({id:"sources.sourceCostmanagementFailure",defaultMessage:"Cost Management update failure."})})).then((function(){Object(W.a)(r.source.id),o(G.c.sources.path),n(Object(V.g)())}))},K=n(291),U=n(313),H=n(24),X=n.n(H),J=n(286),Q=n(287),Y=n(300);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee=function(e,t,n){return[$({name:"source.name",label:s.a.createElement(C.a,{id:"sources.sourceName",defaultMessage:"Source name"}),component:e["source.name"]?J.componentTypes.TEXT_FIELD:Y.a},e["source.name"]?{}:{setEdit:t},{validate:[function(e){return Object(Q.asyncValidator)(e,n)}],isRequired:!0}),{name:"source_type",label:s.a.createElement(C.a,{id:"sources.sourceType",defaultMessage:"Source type"}),isReadOnly:!0,component:Y.a}]},te=n(26),ne=n(44),re=n(62),ae=n(339),oe=n(658),ie=n.n(oe),ce=n(78),se=n(318),ue=n(317),le=n(352),pe=n(83),de=n.n(pe),fe=Object(c.createContext)(),me=function(e){var t,n,r=e.onClose,a=e.appNames,o=e.schemaAuth,i=e.auth,l=a.length>0,d=Object(u.useDispatch)(),f=Object(p.a)(),h=Object(c.useContext)(fe).setState;return l?(t=s.a.createElement(C.a,{id:"sources.removeAuthWarningApps",defaultMessage:"To remove this authentication you have to remove attached {count, plural, one {application} other {applications}}: { appNames }.",values:{appNames:a.join(", "),count:a.length}}),n=[s.a.createElement(ce.Button,{id:"deleteCancel",key:"cancel",variant:"link",type:"button",onClick:r},s.a.createElement(C.a,{id:"sources.close",defaultMessage:"Close"}))]):(t=s.a.createElement(C.a,{id:"sources.removeAuthWarning",defaultMessage:"Do you really want to remove this authentication?"}),n=[s.a.createElement(ce.Button,{id:"deleteSubmit",key:"submit",variant:"danger",type:"button",onClick:function(){return h({type:"removeAuthPending",authId:i.id}),r(),Object(b.d)(i.id).then((function(){h({type:"removeAuthFulfill",authId:i.id}),d(Object(V.b)(f.formatMessage({id:"sources.authRemoveFullfil",defaultMessage:"Authentication was deleted successfully."}),"success"))})).catch((function(e){h({type:"removeAuthRejected",authId:i.id}),d(Object(V.b)(f.formatMessage({id:"sources.authRemoveRejected",defaultMessage:"Authentication was not deleted successfully."}),"danger",Object(Q.handleError)(e)))}))}},s.a.createElement(C.a,{id:"sources.deleteConfirm",defaultMessage:"Delete this authentication"})),s.a.createElement(ce.Button,{id:"deleteCancel",key:"cancel",variant:"link",type:"button",onClick:r},s.a.createElement(C.a,{id:"sources.deleteCancel",defaultMessage:"Do not delete this authentication"}))]),s.a.createElement(m.Modal,{isOpen:!0,className:"ins-c-sources__dialog--warning",isFooterLeftAligned:!0,onClose:r,actions:n,isSmall:!0,title:f.formatMessage({id:"sources.deleteAuthTitle",defaultMessage:"Delete { name }"},{name:o.name})},s.a.createElement(se.Split,{gutter:"md"},s.a.createElement(ue.SplitItem,null,s.a.createElement(de.a,{size:"xl",className:"ins-m-alert ins-c-source__delete-icon"})),s.a.createElement(ue.SplitItem,{isFilled:!0},s.a.createElement(le.Stack,{gutter:"md"},s.a.createElement(ne.TextContent,null,s.a.createElement(te.Text,{variant:te.TextVariants.p},t))))))};me.propTypes={onClose:T.a.func.isRequired,appNames:T.a.arrayOf(T.a.string),schemaAuth:T.a.shape({name:T.a.string.isRequired}).isRequired,auth:T.a.shape({id:T.a.string.isRequired}).isRequired};var he=me,be=function(e){var t=e.schemaAuth,n=e.auth,r=e.appTypes,a=e.isDeleting,o=Object(c.useContext)(fe).source,u=Object(c.useState)(!1),l=i()(u,2),p=l[0],d=l[1],f=o.source.applications.filter((function(e){return e.authentications.find((function(e){return e.id===n.id}))})).map((function(e){var t=e.application_type_id;return t?r.find((function(e){return e.id===t})):void 0})).filter(Boolean).map((function(e){return e.display_name}));return s.a.createElement(s.a.Fragment,null,p&&s.a.createElement(he,{auth:n,onClose:function(){return d(!1)},appNames:f,schemaAuth:t}),s.a.createElement(ae.GridItem,{sm:12},s.a.createElement(x.Title,{size:"xl"},t.name," ",!a&&s.a.createElement(re.Button,{variant:"plain","aria-label":"Remove authentication",onClick:function(){return d(!p)}},s.a.createElement(ie.a,null))),s.a.createElement(ne.TextContent,null,s.a.createElement(te.Text,{component:te.TextVariants.small,className:"pf-u-mb-0"},s.a.createElement(C.a,{id:"sources.removeAuthDescription",defaultMessage:"id: {authid} { appNames}",values:{authid:n.id,appNames:f.length>0?s.a.createElement(C.a,{id:"sources.removeAuthWithApps",defaultMessage:"used by {appNames}",values:{appNames:f.join(", ")}}):s.a.createElement(C.a,{id:"sources.removeAuthNoApps",defaultMessage:"not used by any app"})}})," "))))};be.propTypes={isDeleting:T.a.bool,appTypes:T.a.arrayOf(T.a.object),schemaAuth:T.a.shape({name:T.a.string.isRequired}).isRequired,auth:T.a.shape({id:T.a.string.isRequired}).isRequired};var Oe=be,ye=n(327),ge=function(){return s.a.createElement(ae.Grid,null,s.a.createElement(ae.GridItem,{xs:12},s.a.createElement(ye.Bullseye,null,s.a.createElement(d.Spinner,{size:"lg"}))),s.a.createElement(ae.GridItem,{xs:12},s.a.createElement(ye.Bullseye,null,s.a.createElement(ne.TextContent,null,s.a.createElement(te.Text,{component:te.TextVariants.small,className:"pf-u-mt-md"},s.a.createElement(C.a,{id:"sources.removingAuthMessage",defaultMessage:"This authentication is being removed..."}))))))};function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ee=function(e,t,n,r){return e.map((function(e){var a=e.name.startsWith("authentication")?function(e,t){return"authentications.a".concat(t,".").concat(e.replace("authentication.",""))}(e.name,t):e.name,o=n[a],i=ve({},e,{name:a,component:o?e.component:Y.a});return o||(i.setEdit=r),"password"===i.name.split(".").pop()&&(i.helperText=s.a.createElement(C.a,{id:"sources.passwordResetHelperText",defaultMessage:"Changing this resets your current { label }.",values:{label:i.label}}),i.isRequired=!1,i.validate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.filter((function(e){return e.type!==J.validatorTypes.REQUIRED}))}(i.validate)),i}))},Pe=function(e,t,n,r,a){return e&&0!==e.length&&t.schema&&t.schema.authentication?e.map((function(e){var o,i=e.isDeleting,c=P()(e,["isDeleting"]),u=t.schema.authentication.find((function(e){return e.type===c.authtype}));if(!u)return o=c.authtype,{component:"description",name:"".concat(o,"-unsupported"),Content:function(){return s.a.createElement(ne.TextContent,null,s.a.createElement(te.Text,{component:te.TextVariants.p},s.a.createElement(C.a,{id:"sources.unsupportedAuthType",defaultMessage:"Authentication type of { type } is no longer supported.",values:{type:o}})))}};var l=function(e,t){return F()(Q.hardcodedSchemas,[e,"authentication",t,"generic","includeStepKeyFields"],[])}(t.name,c.authtype),p=u.fields.filter((function(e){return!e.stepKey||l.includes(e.stepKey)})).map((function(e){return ve({},e,{},function(e,t,n){return F()(Q.hardcodedSchemas,[e,"authentication",t,"generic",n],{})}(t.name,c.authtype,e.name))}));return{component:J.componentTypes.SUB_FORM,name:u.name,fields:[{component:"description",name:"".concat(c.id,"-authentication-management"),Content:Oe,schemaAuth:u,appTypes:a,auth:c,isDeleting:i},i?{component:"description",name:"".concat(c.id,"-remove-spinner"),Content:ge}:Ee(p,c.id,n,r)]}})):[]};function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Te=[J.componentTypes.CHECKBOX,J.componentTypes.SWITCH],Se=function(e,t,n){return e.map((function(e){var r=t[e.name],o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{component:r||Te.includes(e.component)?e.component:Y.a});return r||Te.includes(e.component)||(o.setEdit=n),o}))};function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Me=function(e,t,n){if(e.schema&&e.schema.endpoint&&!e.schema.endpoint.hidden){var r=e.schema.endpoint.fields.map((function(t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{},function(e,t){return F()(Q.hardcodedSchemas,[e,"endpoint",t],{})}(e.name,t.name))}));return{component:J.componentTypes.SUB_FORM,title:s.a.createElement(C.a,{id:"sources.endpoint",defaultMessage:"Endpoint"}),name:"endpoint",fields:Se(r,t,n)}}};function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _e="/insights/platform/cost-management",xe=["billing_source","credentials"],Ae=function(e){var t=e.name;return xe.some((function(e){return t.startsWith(e)}))},ke=function(e){return Object.keys(e).map((function(t){return e[t].fields.filter(Ae)})).flatMap((function(e){return e}))},Fe=function(e,t,n){var r=void 0;return n.forEach((function(n){var a=r?{}:F()(Q.hardcodedSchemas,[e,"authentication",n],{});Object.keys(a).find((function(a){var o=F()(Q.hardcodedSchemas,[e,"authentication",n,a,t],void 0);if(o)return r=o,!0}))})),r||{}},Ie=function(e,t,n){return"openshift"===n.name?[Re({name:"source.source_ref",label:s.a.createElement(C.a,{id:"sources.clusterIdentifier",defaultMessage:"Cluster identifier"}),isRequired:!0},e["source.source_ref"]?{}:{setEdit:t},{validate:[{type:J.validatorTypes.REQUIRED}],component:e["source.source_ref"]?J.componentTypes.TEXT_FIELD:Y.a})]:[]},Ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,i=a.find((function(e){return e.name===_e}));if(i){var c=e.find((function(e){return e.application_type_id===i.id}));if(c){var s=ke(t.schema.authentication),u=o.authentications?o.authentications.map((function(e){return e.authtype})):[],l=s.map((function(e){return Re({},e,{},Fe(t.name,e.name,u))}));return{component:J.componentTypes.SUB_FORM,title:i.display_name,name:i.display_name,fields:[].concat(X()(Se(l,n,r)),X()(Ie(n,r,t)))}}}},qe=function(e,t,n,r,a,o){return[Ne(e,t,n,r,a,o)]},Le=function(e,t,n,r,a){return{fields:[].concat(X()(ee(t,n,e.source.id)),X()(Pe(e.authentications,r,t,n,a)),X()(qe(e.applications,r,t,n,a,e)),[!!(e.endpoints&&e.endpoints.length>0)&&Me(r,t,n)]).filter(Boolean)}};function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ge={loading:!0,editing:{},source:void 0,initialValues:{},sourceType:void 0,schema:void 0},We=function(e,t){var n=t.type,r=t.source,o=t.name,i=t.sourceType,c=t.setEdit,s=t.appTypes,u=t.authId;switch(n){case"createForm":return Ve({},e,{sourceType:i,initialValues:B(e.source,i.product_name),schema:Le(e.source,e.editing,c,i,s),loading:!1});case"refreshSchema":return Ve({},e,{schema:Le(e.source,e.editing,c,e.sourceType,s)});case"setSource":return Ve({},e,{source:r});case"reset":return Ve({},e,{editing:{}});case"setEdit":return Ve({},e,{editing:Ve({},e.editing,a()({},o,!e.editing[o]))});case"removeAuthPending":return Ve({},e,{source:Ve({},e.source,{authentications:e.source.authentications.map((function(e){return e.id===u?Ve({},e,{isDeleting:!0}):e}))})});case"removeAuthRejected":return Ve({},e,{source:Ve({},e.source,{authentications:e.source.authentications.map((function(e){return e.id===u?Ve({},e,{isDeleting:!1}):e}))})});case"removeAuthFulfill":return Ve({},e,{source:Ve({},e.source,{authentications:e.source.authentications.filter((function(e){return e.id!==u}))})});default:return e}};function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(){var e=Object(c.useReducer)(We,Ge),t=i()(e,2),n=t[0],r=t[1],a=Object(l.f)(),o=Object(K.a)(),y=Object(U.a)(),j=n.loading,v=n.editing,E=n.source,P=n.initialValues,w=n.schema,T=Object(p.a)(),S=Object(u.useSelector)((function(e){return e.sources}),u.shallowEqual),D=S.sourceTypes,C=S.appTypes,R=S.sourceTypesLoaded,_=S.appTypesLoaded,x=Object(u.useDispatch)();Object(c.useEffect)((function(){o&&function(e){return Promise.all([Object(b.j)().showSource(e.id),Object(b.j)().listSourceEndpoints(e.id),Object(b.j)().listSourceApplications(e.id),(t=e.id,b.a.get("".concat(O.a,"/sources/").concat(t,"/"))).catch((function(){}))]).then((function(t){var n=i()(t,4),r=n[0],a=n[1],o=n[2],c=n[3],s=a&&a.data&&a.data[0],u={source:g({},e,{},r),applications:o.data};return c&&(u=g({},u,{billing_source:c.billing_source,credentials:c.authentication.credentials})),s?Object(b.j)().listEndpointAuthentications(s.id).then((function(e){return g({},u,{endpoints:a.data,authentications:e.data})})):u}));var t}(o).then((function(e){e.source.imported&&function(e,t,n,r){e(Object(V.b)(t.formatMessage({id:"sources.importSourceCannotEdited",defaultMessage:"Source { name } is imported."},{name:r}),"danger",t.formatMessage({id:"sources.importedSourcesCannotEdited",defaultMessage:"Imported sources cannot be edited."}))),n.push(G.c.sources.path)}(x,T,a,e.source.name),r({type:"setSource",source:e})}))}),[o,y]);var k=function(e){return r({type:"setEdit",name:e})};Object(c.useEffect)((function(){if(E&&_&&R){var e=D.find((function(e){return e.id===E.source.source_type_id}));r({type:"createForm",sourceType:e,source:E,setEdit:k,appTypes:C})}}),[_,E,R]),Object(c.useEffect)((function(){E&&!j&&r({type:"refreshSchema",setEdit:k,appTypes:C})}),[v]);var F=function(){return a.push(G.c.sources.path)};return!_||!R||j?s.a.createElement(m.Modal,{title:T.formatMessage({id:"sources.editSource",defaultMessage:"Edit source."}),header:s.a.createElement(A,null),isOpen:!0,isLarge:!0,onClose:F},s.a.createElement("div",{className:"ins-c-sources__dialog--spinnerContainer"},s.a.createElement(d.Spinner,null))):s.a.createElement(m.Modal,{title:T.formatMessage({id:"sources.editSource",defaultMessage:"Edit source."}),header:s.a.createElement(A,null),isOpen:!0,isLarge:!0,onClose:F},s.a.createElement(fe.Provider,{value:{setState:r,source:E}},s.a.createElement(h.a,{onCancel:F,schema:w,onSubmit:function(e,t){return z(e,t.getState().dirtyFields,x,E,T,a.push)},layoutMapper:Ke({},f.layoutMapper,{FormWrapper:M}),clearedValue:null,canReset:!0,disableSubmit:["submitting"],onReset:function(){return r({type:"reset"})},initialValues:P,buttonsLabels:{submitLabel:T.formatMessage({id:"sources.save",defaultMessage:"Save"})}})))}}}]);
//# sourceMappingURL=../sourcemaps/edit.js.map