(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{441:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(156),o=n(94),c=n(277),s=n(36),u=n(120),l=n(121),p=n(507),d=n(842),m=n(845),f=n(846),b=n(847),O=n(454),g=n(62),y=function(){var e=Object(c.a)(),t=Object(O.a)(),n=Object(s.useSelector)((function(e){return e.sources.sourceTypes}),s.shallowEqual);return a.a.createElement(u.Card,{className:"pf-m-selectable pf-m-selected card summary-card pf-u-m-lg pf-u-mr-sm-on-md"},a.a.createElement(p.CardTitle,null,e.formatMessage({id:"detail.summary.title",defaultMessage:"Source Summary"})),a.a.createElement(l.CardBody,null,a.a.createElement(d.DescriptionList,{columnModifier:{default:"2Col"}},a.a.createElement(m.DescriptionListGroup,null,a.a.createElement(f.DescriptionListTerm,null,e.formatMessage({id:"detail.summary.type",defaultMessage:"Source type"})),a.a.createElement(b.DescriptionListDescription,null,Object(g.i)(t.source_type_id,void 0,{sourceTypes:n}))),a.a.createElement(m.DescriptionListGroup,null,a.a.createElement(f.DescriptionListTerm,null,e.formatMessage({id:"detail.summary.lastChecked",defaultMessage:"Last availability check"})),a.a.createElement(b.DescriptionListDescription,null,t.last_checked_at||t.last_available_at?Object(g.d)(t.last_checked_at||t.last_available_at):e.formatMessage({id:"detail.summary.notChecked",defaultMessage:"Not checked yet"}))),a.a.createElement(m.DescriptionListGroup,null,a.a.createElement(f.DescriptionListTerm,null,e.formatMessage({id:"detail.summary.dateAdded",defaultMessage:"Date added"})),a.a.createElement(b.DescriptionListDescription,null,Object(g.d)(t.created_at))),a.a.createElement(m.DescriptionListGroup,null,a.a.createElement(f.DescriptionListTerm,null,e.formatMessage({id:"detail.summary.lastModified",defaultMessage:"Last modified"})),a.a.createElement(b.DescriptionListDescription,null,Object(g.d)(t.updated_at))))))},h=n(13),v=n(596),j=n(455),E=n(595),w=n.n(E),P=n(82),D=n(477),S=function(){var e=Object(c.a)(),t=Object(O.a)(),n=Object(h.k)().push,r=Object(s.useSelector)((function(e){return e.sources.sourceTypes}),s.shallowEqual),i=Object(s.useSelector)((function(e){return e.sources.appTypes}),s.shallowEqual),o=Object(D.a)(),d=r.find((function(e){return e.id===t.source_type_id})),m=null==d?void 0:d.name,f=i.filter((function(e){return e.supported_source_types.includes(m)})).filter(w.a);return a.a.createElement(u.Card,{className:"card applications-card pf-u-p-lg pf-u-pl-sm-on-md"},a.a.createElement(p.CardTitle,null,e.formatMessage({id:"detail.applications.title",defaultMessage:"Applications"})),a.a.createElement(l.CardBody,null,!o&&a.a.createElement("div",{className:"pf-u-mb-md",id:"no-permissions-applications"},e.formatMessage({id:"sources.notAdminButton",defaultMessage:"To perform this adding/removing applications, you must be granted write permissions from your Organization Administrator."})),a.a.createElement("div",{className:"pf-c-form"},f.map((function(e){var r=t.applications.find((function(t){return t.application_type_id===e.id}));return a.a.createElement(j.FormGroup,{key:e.id},a.a.createElement(v.Switch,{id:"app-switch-".concat(e.id),label:e.display_name,isChecked:Boolean(r),isDisabled:(null==r?void 0:r.isDeleting)||!o,onChange:function(a){return n(a?Object(P.b)(P.c.sourcesDetailAddApp.path,t.id).replace(":app_type_id",e.id):Object(P.b)(P.c.sourcesDetailRemoveApp.path,t.id).replace(":app_id",r.id))}}))})))))},T=n(464),M=n(460),_=n(471),k=n(152),R=n(851),x=n.n(R),A=function(){var e=Object(c.a)();return a.a.createElement(T.EmptyState,null,a.a.createElement(M.EmptyStateIcon,{icon:x.a}),a.a.createElement(k.Title,{headingLevel:"h4",size:"lg"},e.formatMessage({id:"detail.noapplications.title",defaultMessage:"No connected applications"})),a.a.createElement(_.EmptyStateBody,{className:"empty-state-body"},e.formatMessage({id:"detail.noapplications.description",defaultMessage:"You have not connected any applications to this source. Use the switches above to add applications."})))},C=n(852),L=n.n(C),F=function(){var e=Object(c.a)();return a.a.createElement(T.EmptyState,null,a.a.createElement(M.EmptyStateIcon,{icon:L.a}),a.a.createElement(k.Title,{headingLevel:"h4",size:"lg"},e.formatMessage({id:"detail.nopermissions.title",defaultMessage:"Missing permissions"})),a.a.createElement(_.EmptyStateBody,{className:"empty-state-body"},e.formatMessage({id:"detail.nopermissions.description",defaultMessage:"To perform this action, you must be granted write permissions from your Organization Administrator."})))},N=n(4),I=n.n(N),B=n(155),q=n.n(B),z=n(45),G=n.n(z),U=n(139),V=n(164),K=n(497),Q=n.n(K),W=n(627),J=n(127),H=n.n(J),X=n(160),Y=n.n(X),$=n(43),Z=n(17);function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=function(e,t){return Promise.all([Object($.j)().showSource(e.id),Object($.j)().listSourceEndpoints(e.id),Object($.e)(e.id),t&&(n=e.id,$.a.get("".concat(Z.a,"/sources/").concat(n,"/"))).catch((function(){}))]).then(function(){var t=Y()(H.a.mark((function t(n){var r,a,i,o,c,s,u,l,p,d,m,f,b;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=G()(n,4),i=a[0],o=a[1],c=a[2],s=a[3],u=o&&o.data&&o.data[0],l=(null==c||null===(r=c.sources[0])||void 0===r?void 0:r.applications)||[],p={source:te(te({},e),i),applications:l},s&&(p=te(te({},p),{},{billing_source:s.billing_source,credentials:s.authentication.credentials})),d=[],f=[],b=[],l.forEach((function(e){var t;null==e||null===(t=e.authentications)||void 0===t||t.forEach((function(t){(null==t?void 0:t.id)&&(d.push(Object($.j)().showAuthentication(t.id)),f.push(e.id),b.push(t.id))}))})),!(d.length>0)){t.next=14;break}return t.next=12,Promise.all(d);case 12:m=t.sent,f.forEach((function(e,t){p.applications.find((function(t){return t.id===e})).authentications.push(m[t])}));case 14:if(u){t.next=16;break}return t.abrupt("return",p);case 16:return t.abrupt("return",Object($.j)().listEndpointAuthentications(u.id).then((function(e){return te(te({},p),{},{endpoints:o.data,authentications:e.data.filter((function(e){var t=e.id;return!b.includes(t)}))})})));case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());var n},re=n(561),ae=n(37),ie=n.n(ae),oe=n(122),ce=n.n(oe),se=n(457),ue=n.n(se),le=n(929),pe=n.n(le),de=n(452),me=n.n(de),fe=n(453),be=n.n(fe),Oe=n(25),ge=n(703),ye=n.n(ge);function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var je=function(e){return e.split(".").pop()},Ee=function(e,t){var n;return(null==e||null===(n=e.fields)||void 0===n?void 0:n.filter((function(e){return e.stepKey===t})))||[]},we=function(e,t,n){return e&&0!==e.length&&t.schema&&t.schema.authentication?e.map((function(e){var r,a,i,o=null==t||null===(r=t.schema)||void 0===r||null===(a=r.authentication)||void 0===a?void 0:a.find((function(t){return t.type===e.authtype}));if(!o)return[];var c,s,u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return ue()(ye.a,[e,"authentication",t,n,"includeStepKeyFields"],[])}(t.name,e.authtype,n),l=null===(i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return ue()(ye.a,[e,"authentication",t,n,"additionalSteps"],[])}(t.name,e.authtype,n))||void 0===i?void 0:i.map((function(e){return ve(ve({},e),{},{fields:[].concat(ie()(e.fields),ie()(Ee(o,e.name)))})})).map((function(e){return e.fields.map((function(e){return e.name}))})).flatMap((function(e){return e})),p=o.fields.filter((function(e){return l.includes(e.name)||!e.stepKey||e.stepKey&&u.includes(e.stepKey)})).map((function(r){return ve(ve({},r),function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"generic";return ue()(ye.a,[e,"authentication",t,r,n],{})}(t.name,e.authtype,r.name,n))}));return n||"amazon"!==t.name||(p=p.map((function(t){return function(e,t){return"password"!==je(e.name)?e:"arn"===t?ve(ve({},e),{},{label:"Cost Management ARN"}):"cloud-meter-arn"===t?ve(ve({},e),{},{label:"Subscription Watch ARN"}):e}(t,e.authtype)}))),c=p,s=e.id,c.map((function(e){var t=e.name.startsWith("authentication")?function(e,t){return"authentications.a".concat(t,".").concat(e.replace("authentication.",""))}(e.name,s):e.name,n=ve(ve({},e),{},{name:t});return"password"===je(n.name)&&(n.component="authentication"),n}))})):[]},Pe="/insights/platform/cost-management",De=function(e,t,n){var r;return[].concat(ie()(we(null===(r=n.authentications)||void 0===r?void 0:r.filter((function(e){return Object.keys(e).length>1})),t,null==e?void 0:e.name)),ie()((null==e?void 0:e.name)===Pe?function(e){return"openshift"===e.name?[{name:"source.source_ref",label:a.a.createElement(Oe.a,{id:"sources.clusterIdentifier",defaultMessage:"Cluster identifier"}),isRequired:!0,validate:[{type:be.a.REQUIRED}],component:me.a.TEXT_FIELD}]:[]}(t):[]))},Se=function(e,t,n){return[{component:me.a.TABS,name:"app-tabs",isBox:!0,fields:ie()(e.map((function(e){var r=n.find((function(t){return t.id===e.application_type_id}));return{name:null==r?void 0:r.id,title:null==r?void 0:r.display_name,fields:De(r,t,e)}})))}]};function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Me=function(e,t){var n={};return Object.keys(t).filter((function(e){return t[e]})).forEach((function(t){pe()(n,t,ue()(e,t))})),n},_e=function(e,t){var n,r,a=e.endpoints,i=e.authentications,o=e.applications,c=ce()(e,["endpoints","authentications","applications"]),s={},u=[].concat(ie()(i||[]),ie()((null==o?void 0:o.reduce((function(e,t){return[].concat(ie()(e),ie()(t.authentications))}),[]))||[]));return u.length>0&&u.forEach((function(e){s["a".concat(e.id)]=e})),a&&a.length>0&&(n=a[0]),n&&(r=n.scheme||n.host||n.path||n.port?Object(g.f)(n):void 0),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({source_type:t,endpoint:n,authentications:s,url:r},c)},ke=function(e,t){var n;return e.applications.map((function(e){return e.application_type_id})).includes(null===(n=t.find((function(e){return e.name===Pe})))||void 0===n?void 0:n.id)},Re=n(67),xe=n(704),Ae=n(727),Ce=function(){var e=Y()(H.a.mark((function e(t,n,r,a,i,o,c){var s,u,l,p,d,m,f,b,O;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o({type:"submit",values:t,editing:n}),p=new Date,e.prev=2,e.next=5,Object(Ae.a)(a,Me(t,n));case 5:e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(2),r(Object(Re.f)()),o({type:"submitFailed"}),e.abrupt("return");case 12:return Object(xe.a)(a.source.id),e.next=15,ne({id:a.source.id},c);case 15:if(m=e.sent,f=(null===(s=a.applications)||void 0===s?void 0:s.map((function(e){var t=e.id;return Object(re.checkAppAvailability)(t,void 0,void 0,void 0,p)})))||[],(null===(u=a.endpoints)||void 0===u||null===(l=u[0])||void 0===l?void 0:l.id)&&f.push(Object(re.checkAppAvailability)(a.endpoints[0].id,void 0,void 0,"getEndpoint",p)),!(f.length>0)){e.next=41;break}return e.prev=19,e.next=22,Promise.all(f);case 22:b=e.sent,e.next=30;break;case 25:return e.prev=25,e.t1=e.catch(19),r(Object(Re.f)()),o({type:"submitFailed"}),e.abrupt("return");case 30:if(!(O=b.find((function(e){return e.availability_status===g.a})))){e.next=36;break}return d={title:i.formatMessage({id:"wizard.failEditToastTitle",defaultMessage:"Edit source failed"}),description:O.availability_status_error,variant:"danger"},o({type:"submitFinished",source:m,message:d}),r(Object(Re.f)()),e.abrupt("return");case 36:if(!b.some((function(e){return!e.availability_status}))){e.next=41;break}return o({type:"submitTimetouted",source:m}),r(Object(Re.f)()),e.abrupt("return");case 41:d={title:i.formatMessage({id:"wizard.successEditToastTitle",defaultMessage:"Source ‘{name}’ was edited successfully."},{name:a.source.name}),variant:"success"},o({type:"submitFinished",source:m,message:d}),r(Object(Re.f)());case 44:case"end":return e.stop()}}),e,null,[[2,7],[19,25]])})));return function(t,n,r,a,i,o,c){return e.apply(this,arguments)}}(),Le=n(491);function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ie=function(e){if(e.schema&&e.schema.endpoint&&!e.schema.endpoint.hidden){var t=e.schema.endpoint.fields.map((function(t){return Ne(Ne({},t),function(e,t){return ue()(ye.a,[e,"endpoint",t],{})}(e.name,t.name))})),n={component:me.a.SUB_FORM,name:"endpoint"};if("ansible-tower"===e.name){var r,a=t.find((function(e){return"url"===e.name}));return Ne(Ne({},n),{},{fields:[{component:me.a.SUB_FORM,name:"receptor_node_group",condition:{when:"endpoint.receptor_node",isNotEmpty:!0},fields:[Ne(Ne({},a),{},{isRequired:!1,validate:null==a||null===(r=a.validate)||void 0===r?void 0:r.filter((function(e){return e.type!==be.a.REQUIRED}))})]},{component:me.a.SUB_FORM,name:"hostname_group",condition:{when:"endpoint.receptor_node",isEmpty:!0},fields:t}]})}return Ne(Ne({},n),{},{fields:t})}},Be=n(451),qe=n.n(Be),ze=n(248),Ge=function(){var e=qe()().getState().values.message;return a.a.createElement(ze.Alert,{variant:null==e?void 0:e.variant,isInline:!0,title:null==e?void 0:e.title},null==e?void 0:e.description)},Ue=function(e,t,n,r){return{description:r.formatMessage({id:"sources.editFormDescripiton",defaultMessage:"Use the form fields to edit application credentials."}),fields:[{name:"alert",component:"description",Content:Ge,condition:{when:"message",isNotEmpty:!0}}].concat(ie()(Se(e.applications,t,n)),[!!(e.endpoints&&e.endpoints.length>0)&&Ie(t)]).filter(Boolean)}};function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qe={loading:!0,source:void 0,initialValues:{},sourceType:void 0,schema:void 0,isSubmitting:!1,initialLoad:!0,submitError:!1,isTimeouted:!1},We=function(e,t){var n=t.type,r=t.source,a=t.sourceType,i=t.appTypes,o=t.intl,c=t.message,s=t.values,u=t.editing;switch(n){case"createForm":return Ke(Ke({},e),{},{sourceType:a,initialValues:_e(e.source,a.product_name),schema:Ue(e.source,a,i,o),loading:!1});case"setSource":return Ke(Ke({},e),{},{source:r,initialLoad:!1});case"submit":return Ke(Ke({},e),{},{isSubmitting:!0,submitError:!1,values:s,editing:u});case"submitFinished":return Ke(Ke({},e),{},{isSubmitting:!1,source:r,message:c});case"submitFailed":return Ke(Ke({},e),{},{isSubmitting:!1,submitError:!0});case"submitTimetouted":return Ke(Ke({},e),{},{source:r,isSubmitting:!1,isTimeouted:!0});case"cancelTimetouted":return Ke(Ke({},e),{},{isTimeouted:!1});case"sourceChanged":return Ke(Ke({},e),{},{initialLoad:!0,loading:!0});default:return e}},Je=n(618),He=n.n(Je),Xe=function(){var e=Object(c.a)();return a.a.createElement(He.a,{customText:e.formatMessage({id:"sources.editSubmittingTitle",defaultMessage:"Validating edited source credentials"})})},Ye=n(14),$e=n.n(Ye),Ze=n(263),et=n(93),tt=n(931),nt=n(543),rt=n.n(nt),at=function(e){var t=e.setState,n=Object(c.a)();return a.a.createElement(V.Bullseye,null,a.a.createElement(tt.EmptyState,{variant:tt.EmptyStateVariant.full,className:"pf-u-mt-4xl"},a.a.createElement(M.EmptyStateIcon,{icon:rt.a,color:"var(--pf-global--Color--200)",className:"pf-u-mb-0"}),a.a.createElement(Ze.Title,{headingLevel:"h2",size:"xl",className:"pf-u-mt-xl"},n.formatMessage({id:"sources.editTimetoutedTitle",defaultMessage:"Edit source not yet complete"})),a.a.createElement(tt.EmptyStateBody,null,n.formatMessage({id:"sources.editTimetoutedDescription",defaultMessage:"We are still working to confirm your updated credentials and app settings.{newLine}To track progress, check the Status column in the Sources table."},{newLine:a.a.createElement("br",{key:"br"})})),a.a.createElement(et.Button,{variant:"primary",onClick:function(){return t({type:"cancelTimetouted"})},className:"pf-u-mt-xl"},n.formatMessage({id:"sources.edit",defaultMessage:"Edit"}))))};at.propTypes={setState:$e.a.func.isRequired};var it=at,ot=n(59),ct=n(619),st=n.n(ct),ut=function(e){var t=e.onRetry,n=Object(c.a)();return a.a.createElement(st.a,{onClose:t,customText:n.formatMessage({id:"sources.editErrorDescription",defaultMessage:"There was a problem while trying to edit your source. Please try again. If the error persists, open a support case."}),secondaryActions:a.a.createElement(ot.Text,{component:"a",target:"_blank",href:"https://access.redhat.com/support/cases/#/case/new/open-case?caseCreate=true",rel:"noopener noreferrer"},n.formatMessage({id:"sources.openTicket",defaultMessage:"Open a support case"})),returnButtonTitle:n.formatMessage({id:"sources.retryText",defaultMessage:"Retry"})})};ut.propTypes={onRetry:$e.a.func.isRequired};var lt=ut;function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mt=function(){var e,t=Object(r.useReducer)(We,Qe),n=G()(t,2),i=n[0],o=n[1],u=Object(O.a)(),l=Object(Le.a)(),p=i.loading,d=i.editing,m=i.source,f=i.initialValues,b=i.schema,g=i.isSubmitting,y=i.initialLoad,h=i.message,v=i.submitError,j=i.isTimeouted,E=i.values,w=Object(c.a)(),P=Object(s.useSelector)((function(e){return e.sources}),s.shallowEqual),D=P.sourceTypes,S=P.appTypes,T=P.sourceTypesLoaded,M=P.appTypesLoaded,_=Object(s.useDispatch)();Object(r.useEffect)((function(){y||o({type:"sourceChanged"})}),[u,null==u||null===(e=u.applications)||void 0===e?void 0:e.length]),Object(r.useEffect)((function(){u&&y&&M&&ne(u,ke(u,S)).then((function(e){o({type:"setSource",source:e})}))}),[u,l,M,y]),Object(r.useEffect)((function(){if(m&&M&&T){var e=D.find((function(e){return e.id===m.source.source_type_id}));o({type:"createForm",sourceType:e,source:m,appTypes:S,intl:w})}}),[M,m,T]);var k=!M||!T||p;return j?a.a.createElement(it,{setState:o}):v?a.a.createElement(lt,{onRetry:function(){return Ce(E,d,_,m,w,o,ke(u,S))}}):g?a.a.createElement(Xe,null):k?a.a.createElement(V.Bullseye,{className:"pf-u-m-2xl"},a.a.createElement(U.Spinner,null)):a.a.createElement(W.a,{schema:b,onSubmit:function(e,t){return Ce(e,t.getState().dirtyFields,_,m,w,o,ke(u,S))},FormTemplate:function(e){return a.a.createElement(Q.a,q()({canReset:!0,submitLabel:"Save changes",disableSubmit:["pristine","invalid"]},e))},clearedValue:null,initialValues:dt(dt({},f),{},{message:h})})},ft=function(){var e=Object(c.a)(),t=Object(O.a)(),n=Object(D.a)();return a.a.createElement(u.Card,{className:"card pf-u-m-lg pf-u-mt-0"},a.a.createElement(p.CardTitle,null,e.formatMessage({id:"detail.resources.title",defaultMessage:"Manage connected applications"})),a.a.createElement(l.CardBody,null,!n&&a.a.createElement(F,null),n&&0===t.applications.length&&a.a.createElement(A,null),n&&t.applications.length>0&&a.a.createElement(mt,null)))},bt=n(544),Ot=n(161),gt=n(628),yt=n(105),ht=n(91),vt=n(610),jt=n(611),Et=n(66),wt=n(933),Pt=n(936),Dt=function(){var e=Object(c.a)(),t=Object(O.a)();return a.a.createElement(wt.Breadcrumb,null,a.a.createElement(Pt.BreadcrumbItem,{component:function(e){var t=e.href,n=ce()(e,["href"]);return a.a.createElement(Et.Link,q()({to:t},n))},to:P.c.sources.path},e.formatMessage({id:"sources.sources",defaultMessage:"Sources"})),a.a.createElement(Pt.BreadcrumbItem,{isActive:!0},t.name))},St=n(244),Tt=n(245),Mt=n(258),_t=function(){var e=Object(r.useState)(!1),t=G()(e,2),n=t[0],i=t[1],o=Object(c.a)(),s=Object(h.k)().push,u=Object(O.a)(),l=Object(D.a)(),p={tooltip:o.formatMessage({id:"sources.notAdminButton",defaultMessage:"To perform this action, you must be granted write permissions from your Organization Administrator."}),isDisabled:!0,className:"ins-c-sources__disabled-drodpown-item"};return a.a.createElement(St.Dropdown,{toggle:a.a.createElement(Mt.KebabToggle,{onToggle:function(){return i(!n)},id:"toggle-id-6"}),isOpen:n,isPlain:!0,position:"right",dropdownItems:[a.a.createElement(Tt.DropdownItem,q()({},!l&&p,{key:"rename",onClick:function(){return s(Object(P.b)(P.c.sourcesDetailRename.path,u.id))}}),o.formatMessage({id:"detail.rename.button",defaultMessage:"Rename"})),a.a.createElement(Tt.DropdownItem,q()({},!l&&p,{key:"remove",onClick:function(){return s(Object(P.b)(P.c.sourcesDetailRemove.path,u.id))}}),o.formatMessage({id:"detail.remove.button",defaultMessage:"Remove"}))]})},kt=function(){var e=Object(c.a)(),t=Object(O.a)(),n=Object(s.useSelector)((function(e){return e.sources.appTypes}),s.shallowEqual);return a.a.createElement(yt.PageHeader,null,a.a.createElement(Dt,null),a.a.createElement(vt.Flex,{className:"pf-u-mb-sm"},a.a.createElement(jt.FlexItem,null,a.a.createElement(k.Title,{headingLevel:"h1",size:"2xl"},t.name)),a.a.createElement(jt.FlexItem,null,Object(g.c)(void 0,t,{appTypes:n})),a.a.createElement(jt.FlexItem,{align:{default:"alignRight"}},a.a.createElement(_t,null))),a.a.createElement(ht.TextContent,null,a.a.createElement(ot.Text,null,e.formatMessage({id:"detail.description",defaultMessage:"View details and manage connections for this source."}))))},Rt=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(9)]).then(n.bind(null,970))})),xt=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(13),n.e(6)]).then(n.bind(null,980))})),At=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(8)]).then(n.bind(null,978))})),Ct=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(10)]).then(n.bind(null,979))}));t.default=function(){var e=Object(O.a)();return e?a.a.createElement("div",{className:"ins-c-sources__detail-page"},a.a.createElement(r.Suspense,{fallback:null},a.a.createElement(gt.a,{exact:!0,route:P.c.sourcesDetailRemove,Component:Rt,componentProps:{backPath:Object(P.b)(P.c.sourcesDetail.path,e.id)}}),a.a.createElement(gt.a,{exact:!0,route:P.c.sourcesDetailAddApp,Component:xt}),a.a.createElement(gt.a,{exact:!0,route:P.c.sourcesDetailRemoveApp,Component:At}),a.a.createElement(gt.a,{exact:!0,route:P.c.sourcesDetailRename,Component:Ct})),a.a.createElement(kt,null),a.a.createElement(i.Grid,null,a.a.createElement(o.GridItem,{md:"6"},a.a.createElement(y,null)),a.a.createElement(o.GridItem,{md:"6"},a.a.createElement(S,null)),a.a.createElement(o.GridItem,{md:"12"},a.a.createElement(ft,null)))):a.a.createElement(a.a.Fragment,null,a.a.createElement(Ot.b,null),a.a.createElement(bt.a,null))}},454:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(36),a=n(13),i=function(){var e=Object(a.m)().id;return Object(r.useSelector)((function(t){return t.sources.entities.find((function(t){return t.id===e}))}))}},477:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(36),a=function(){var e=Object(r.useSelector)((function(e){var t=e.user;return{orgAdmin:null==t?void 0:t.isOrgAdmin,writePermissions:null==t?void 0:t.writePermissions}})),t=e.orgAdmin,n=e.writePermissions;if("boolean"==typeof t||"boolean"==typeof n)return!!t||!!n}},491:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(36),a=function(){return Object(r.useSelector)((function(e){return e.sources.loaded}))<=0}},544:function(e,t,n){"use strict";var r=n(45),a=n.n(r),i=n(0),o=n.n(i),c=n(36),s=n(13),u=n(277),l=n(67),p=n(43),d=n(491),m=n(82),f=n(454);t.a=function(){var e=Object(s.m)().id,t=Object(u.a)(),n=Object(f.a)(),r=Object(d.a)(),b=Object(c.useSelector)((function(e){return e.sources}),c.shallowEqual),O=b.appTypesLoaded,g=b.sourceTypesLoaded,y=Object(c.useDispatch)(),h=Object(i.useState)(!1),v=a()(h,2),j=v[0],E=v[1];return Object(i.useEffect)((function(){r&&O&&g&&Object(p.h)(e).then((function(e){var t=a()(e.sources,1)[0];return y(Object(l.a)(t)),t})).then((function(n){n||y(Object(l.b)(t.formatMessage({id:"sources.sourceNotFoundTitle",defaultMessage:"Requested source was not found"}),"danger",t.formatMessage({id:"sources.sourceNotFoundTitleDescription",defaultMessage:"Source with { id } was not found. Try it again later."},{id:e}))),E(!0)}))}),[r,O,g]),j&&!n?o.a.createElement(s.c,{to:m.c.sources.path}):null}},627:function(e,t,n){"use strict";var r=n(155),a=n.n(r),i=n(4),o=n.n(i),c=n(0),s=n.n(c),u=n(551),l=n.n(u),p=n(497),d=n.n(p),m=n(556),f=n.n(m),b=n(892),O=n(45),g=n.n(O),y=n(457),h=n.n(y),v=n(455),j=n(481),E=n(681),w=n.n(E),P=n(451),D=n.n(P),S=n(453),T=n.n(S),M=n(531),_=n.n(M);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=function(e){var t,n,r=D()(),i=r.getState().values,o=(null==e||null===(t=e.name)||void 0===t?void 0:t.match(/\d+/))||[],u=g()(o,1)[0]||(null===(n=i.authentication)||void 0===n?void 0:n.id),l=h()(i,e.name),p=Object(c.useState)(!u||l),d=g()(p,2),m=d[0],f=d[1],b=Object(c.useRef)(!0),O=Object(c.useRef)(!1);Object(c.useEffect)((function(){O.current&&(!b.current&&r.getState().pristine&&(f(!1),b.current=!0),m&&(b.current=!1))})),Object(c.useEffect)((function(){O.current=!0}),[]);var y=e.validate&&e.validate.filter((function(e){return e.type!==T.a.REQUIRED})),E=R(R({},e),u?{validate:y,resolveProps:_.a}:{});return!m&&u?s.a.createElement(v.FormGroup,{helperText:E.helperText,label:E.label,onFocus:function(){return f(!0)},isRequired:!0},s.a.createElement(j.TextInput,{"aria-label":"pre-filled-authentication",value:"•••••••••••••"})):s.a.createElement(w.a,a()({},E,{autoFocus:!0}))};function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){return s.a.createElement(l.a,a()({FormTemplate:d.a,componentMapper:C(C(C({},f.a),b.mapperExtension),{},{authentication:x})},e))}},628:function(e,t,n){"use strict";var r=n(155),a=n.n(r),i=n(122),o=n.n(i),c=n(0),s=n.n(c),u=n(13),l=n(14),p=n.n(l),d=n(36),m=n(277),f=n(67),b=n(477),O=n(82),g=function(){var e=Object(m.a)(),t=Object(b.a)(),n=Object(d.useDispatch)();return Object(c.useEffect)((function(){if(!1===t){var r=e.formatMessage({id:"sources.insufficietnPerms",defaultMessage:"Insufficient permissions"}),a=e.formatMessage({id:"sources.notAdminButton",defaultMessage:"To perform this action, you must be granted write permissions from your Organization Administrator."});n(Object(f.b)(r,"danger",a))}}),[t]),!1===t?s.a.createElement(u.c,{to:O.c.sources.path}):null},y=n(454),h=n(544),v=function(e){var t=e.route,n=e.children;return!(t.redirectNoId&&Object(y.a)())&&t.redirectNoId?s.a.createElement(h.a,null):s.a.createElement(s.a.Fragment,null,t.writeAccess&&s.a.createElement(g,null),n)};v.propTypes={route:p.a.shape({path:p.a.string.isRequired,redirectNoId:p.a.bool,writeAccess:p.a.bool}).isRequired,children:p.a.node.isRequired};var j=function(e){var t=e.route,n=e.componentProps,r=e.Component,i=o()(e,["route","componentProps","Component"]);return s.a.createElement(u.d,a()({},i,{path:t.path}),s.a.createElement(v,{route:t},s.a.createElement(r,n)))};j.propTypes={route:p.a.shape({path:p.a.string.isRequired,redirectNoId:p.a.bool,writeAccess:p.a.bool}).isRequired,componentProps:p.a.any,Component:p.a.oneOfType([p.a.func,p.a.object]).isRequired};t.a=j},704:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(43),a=function(e){return Object(r.j)().checkAvailabilitySource(e).catch((function(){}))}},727:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return p}));var r=n(4),a=n.n(r),i=n(62),o=n(43),c=n(17);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){return e.url||null===e.url?function(e){if(null===e)return{scheme:null,host:null,port:null,path:null};if(!e)return{};try{var t=new URL(e),n=t.protocol.replace(/:$/,"");return{scheme:n,host:t.hostname,port:""===t.port?Object(i.e)(n):t.port,path:t.pathname}}catch(e){return{}}}(e.url):e.endpoint?e.endpoint:e},p=function(e,t){var n,r,a=[];if(t.source&&a.push(Object(o.j)().updateSource(e.source.id,t.source)),t.endpoint||t.url||null===t.url){var i=l(t),s=i.scheme,p=i.host,d=i.port,m=i.path,f=null===d?null:parseInt(d,10),b=u({scheme:s,host:p,path:m,port:null===f?null:isNaN(f)?void 0:f},t.endpoint);a.push(Object(o.j)().updateEndpoint(e.endpoints[0].id,b))}if(t.authentications&&Object.keys(t.authentications).forEach((function(e){var n=e.replace("a","");a.push(Object(o.j)().updateAuthentication(n,t.authentications[e]))})),t.billing_source||t.credentials){var O={};t.credentials&&(O={authentication:{credentials:t.credentials}}),t.billing_source&&(O=u(u({},O),{},{billing_source:t.billing_source})),a.push((n=e.source.id,r=O,o.a.patch("".concat(c.a,"/sources/").concat(n,"/"),r)))}return Promise.all(a)}}}]);
//# sourceMappingURL=../sourcemaps/sourceDetail.js.map