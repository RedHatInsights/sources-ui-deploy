(self.webpackChunksources_ui=self.webpackChunksources_ui||[]).push([[6818],{69949:(e,t,n)=>{"use strict";n.d(t,{K_:()=>c,yH:()=>l});var r=n(59713),a=n.n(r),i=n(26351),o=n(45857);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var c=function(e){return e.url||null===e.url?function(e){if(null===e)return{scheme:null,host:null,port:null,path:null};if(!e)return{};try{var t=new URL(e),n=t.protocol.replace(/:$/,"");return{scheme:n,host:t.hostname,port:""===t.port?(0,i.bF)(n):t.port,path:t.pathname}}catch(e){return{}}}(e.url):e.endpoint?e.endpoint:e},l=function(e,t,n){var r=[];if(t.source&&r.push((0,o.Rj)().updateSource(e.source.id,t.source)),t.endpoint||t.url||null===t.url){var i=c(t),l=i.scheme,u=i.host,p=i.port,d=i.path,f=null===p?null:parseInt(p,10),m=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({scheme:l,host:u,path:d,port:null===f?null:isNaN(f)?void 0:f},t.endpoint);r.push((0,o.Rj)().updateEndpoint(e.endpoints[0].id,m))}return t.authentications&&Object.keys(t.authentications).forEach((function(e){var n=e.replace("a","");r.push((0,o.Rj)().updateAuthentication(n,t.authentications[e]))})),t.applications&&Object.keys(t.applications).forEach((function(e){var t=e.replace("a","");r.push((0,o.Rj)().updateApplication(t,{extra:n.applications[e].extra}))})),Promise.all(r)}},94851:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Lt});var r=n(80150),a=n.n(r),i=n(50693),o=n(16475),s=n(86896),c=n(61084),l=n(45697),u=n.n(l),p=n(32203),d=n(62394),f=n(70),m=n(91921),y=n(58844),b=n(10550),g=n(3025),h=n(66187),v=n(26351),O=n(87757),E=n.n(O),j=n(48926),w=n.n(j),P=n(63038),_=n.n(P),M=n(7766),T=n(47173),D=n(2372),k=n(93323),S=n(39324);const Z=function(){var e=(0,h.L)(),t=(0,s.Z)(),n=(0,c.useDispatch)(),i=(0,r.useState)(!1),o=_()(i,2),l=o[0],u=o[1];return a().createElement(T.zx,{variant:"plain","aria-label":t.formatMessage({id:"sources.checkavailability",defaultMessage:"Check source availability"}),onClick:w()(E().mark((function r(){return E().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u(!0),r.next=3,(0,k.Z)(e.id);case 3:u(!1),n((0,S.Hz)({title:t.formatMessage({id:"sources.checkavailability.notificationTitle",defaultMessage:"Request to check source status was sent"}),variant:"info",description:t.formatMessage({id:"sources.checkavailability.notificationDescription",defaultMessage:"Check this page later for updates"})}));case 5:case"end":return r.stop()}}),r)}))),isDisabled:l},!l&&a().createElement(M.ZP,null),l&&a().createElement(D.$,{size:"md"}))};var R=function(e){var t=e.term,n=e.description;return a().createElement(y.g,null,a().createElement(b.M,null,t),a().createElement(g.b,null,n))};R.propTypes={term:u().node,description:u().node};const x=function(){var e,t=(0,s.Z)(),n=(0,h.L)(),r=(0,c.useSelector)((function(e){return e.sources.sourceTypes}),c.shallowEqual),i=r.find((function(e){return e.id===n.source_type_id}));if("amazon"===i.name){var o,l,u,y=null===(o=n.authentications)||void 0===o?void 0:o.find((function(e){return e.authtype.includes("arn")}));null!=y&&y.username&&(e=null===(l=y.username.match(/:\d+/))||void 0===l||null===(u=l[0])||void 0===u?void 0:u.replace(/:/g,""))}return a().createElement(p.Z,{className:"pf-m-selectable pf-m-selected card summary-card pf-u-m-lg pf-u-mr-sm-on-md"},a().createElement(f.l,null,t.formatMessage({id:"detail.summary.title",defaultMessage:"Source summary"})),a().createElement(d.e,null,a().createElement(m.o,{columnModifier:{default:"2Col"}},a().createElement(R,{term:t.formatMessage({id:"detail.summary.type",defaultMessage:"Source type"}),description:(0,v.P5)(n.source_type_id,void 0,{sourceTypes:r})}),a().createElement(R,{term:t.formatMessage({id:"detail.summary.lastChecked",defaultMessage:"Last availability check"}),description:a().createElement(a().Fragment,null,n.last_checked_at||n.last_available_at?(0,v.vh)(n.last_checked_at||n.last_available_at):t.formatMessage({id:"detail.summary.notChecked",defaultMessage:"Not checked yet"}),a().createElement(Z,null))}),a().createElement(R,{term:t.formatMessage({id:"detail.summary.dateAdded",defaultMessage:"Date added"}),description:(0,v.vh)(n.created_at)}),a().createElement(R,{term:t.formatMessage({id:"detail.summary.lastModified",defaultMessage:"Last modified"}),description:(0,v.vh)(n.updated_at)}),n.app_creation_workflow&&a().createElement(R,{term:t.formatMessage({id:"detail.summary.configurationMode",defaultMessage:"Configuration mode"}),description:(0,v.Z3)(n.app_creation_workflow,n,{intl:t,sourceType:i})}),e&&a().createElement(R,{term:t.formatMessage({id:"detail.summary.awsAccountNumber",defaultMessage:"AWS account number"}),description:e}))))};var A=n(59713),N=n.n(A),C=n(334),L=n(13946),B=n(59775),z=n(11405),F=n(29499),q=n(69174),H=n(37377),V=function(e){var t=e.app,n=(0,s.Z)(),r=(0,h.L)(),i=(0,c.useSelector)((function(e){return e.sources.appTypes})),o=(0,v.GH)(t,r,i);return a().createElement(H.J,{showClose:!1,"aria-label":"".concat(o.display_name," popover"),bodyContent:(0,v.dE)(o.availability_status,o.availability_status_error,n)},a().createElement(q._,{className:"pf-u-ml-sm clickable",color:(0,v.z2)(o.availability_status)},(0,v.li)(o.availability_status)))};V.propTypes={app:u().shape({availability_status:u().string,availability_status_error:u().string,display_name:u().string}).isRequired};const U=V;var I=n(56855),W=n(45857),$=n(12871),G=n(51863);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){N()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q={selectedApps:{}},X=function(e,t){var n=t.type,r=t.id;switch(n){case"addApp":return J(J({},e),{},{selectedApps:J(J({},e.selectedApps),{},N()({},r,!0))});case"removeApp":return J(J({},e),{},{selectedApps:J(J({},e.selectedApps),{},N()({},r,!1))});case"clean":return J(J({},e),{},{selectedApps:J(J({},e.selectedApps),{},N()({},r,void 0))})}};const Y=function(){var e=(0,s.Z)(),t=(0,h.L)(),n=(0,C.useHistory)().push,i=(0,c.useSelector)((function(e){return e.sources.sourceTypes}),c.shallowEqual),o=(0,c.useSelector)((function(e){return e.sources.appTypes}),c.shallowEqual),l=(0,F.E)(),u=(0,c.useDispatch)(),m=(0,r.useReducer)(X,Q),y=_()(m,2),b=y[0].selectedApps,g=y[1],v=i.find((function(e){return e.id===t.source_type_id})),O=null==v?void 0:v.name,j=o.filter((function(e){return e.supported_source_types.includes(O)})).filter(G.Z),P=function(e){return n((0,z.yS)(z._j.sourcesDetailRemoveApp.path,t.id).replace(":app_id",e))},M=function(e){return n((0,z.yS)(z._j.sourcesDetailAddApp.path,t.id).replace(":app_type_id",e))};return(0,I.Z)(t)&&(P=function(){var e=w()(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("boolean"==typeof b[n]){e.next=7;break}return g({type:"removeApp",id:n}),e.next=4,(0,W.Rj)().deleteApplication(t);case 4:return e.next=6,u((0,S.il)());case 6:g({type:"clean",id:n});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),M=function(){var e=w()(E().mark((function e(n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("boolean"==typeof b[n]){e.next=7;break}return g({type:"addApp",id:n}),e.next=4,(0,W.Cu)({source_id:t.id,application_type_id:n});case 4:return e.next=6,u((0,S.il)());case 6:g({type:"clean",id:n});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a().createElement(p.Z,{className:"card applications-card pf-u-p-lg pf-u-pl-sm-on-md"},a().createElement(f.l,null,e.formatMessage({id:"detail.applications.title",defaultMessage:"Applications"})),a().createElement(d.e,null,!l&&a().createElement("div",{className:"pf-u-mb-md",id:"no-permissions-applications"},e.formatMessage({id:"sources.notAdminButton",defaultMessage:"To perform this adding/removing applications, you must be granted write permissions from your Organization Administrator."})),a().createElement("div",{className:"pf-c-form"},j.map((function(n){var r=t.applications.find((function(e){return e.application_type_id===n.id})),i=function(e,t){var n;return(n={},N()(n,$.fB.COST_MANAGAMENT,t.formatMessage({id:"cost.app.description",defaultMessage:"Analyze, forecast, and optimize your Red Hat OpenShift cluster costs in hybrid cloud environments."})),N()(n,$.fB.CLOUD_METER,t.formatMessage({id:"cost.app.description",defaultMessage:"Includes access to Red Hat Gold Images, high precision subscription watch data, autoregistration, and Red Hat Connector."})),n)[e]}(n.name,e);return a().createElement(B.c,{key:n.id},a().createElement(L.r,{id:"app-switch-".concat(n.id),label:n.display_name,isChecked:"boolean"==typeof b[n.id]?b[n.id]:Boolean(r),isDisabled:(null==r?void 0:r.isDeleting)||!l,onChange:function(e){return e?M(n.id):P(r.id,n.id)}}),Boolean(r)&&a().createElement(U,{app:r}),i&&a().createElement("div",{className:"pf-c-switch pf-u-mt-sm"},a().createElement("span",{className:"pf-c-switch__toggle ins-c-sources__hide-me"}),a().createElement("div",{className:"pf-c-switch__label ins-c-sources__switch-description"},i)))})))))};var ee=n(9947),te=n(38424),ne=n(75106),re=n(60485),ae=n(7081);const ie=function(){var e=(0,s.Z)();return a().createElement(ee.u,null,a().createElement(te.k,{icon:ae.ZP}),a().createElement(re.D,{headingLevel:"h4",size:"lg"},e.formatMessage({id:"detail.noapplications.title",defaultMessage:"No connected applications"})),a().createElement(ne.B,{className:"empty-state-body"},e.formatMessage({id:"detail.noapplications.description",defaultMessage:"You have not connected any applications to this source. Use the switches above to add applications."})))};var oe=n(8705);const se=function(){var e=(0,s.Z)();return a().createElement(ee.u,null,a().createElement(te.k,{icon:oe.ZP}),a().createElement(re.D,{headingLevel:"h4",size:"lg"},e.formatMessage({id:"detail.nopermissions.title",defaultMessage:"Missing permissions"})),a().createElement(ne.B,{className:"empty-state-body"},e.formatMessage({id:"detail.nopermissions.description",defaultMessage:"To perform this action, you must be granted write permissions from your Organization Administrator."})))};var ce=n(67154),le=n.n(ce),ue=n(52643),pe=n(81554),de=n(41252);function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){N()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ye=function(e,t,n){return Promise.all([(0,W.Rj)().showSource(e.id),(0,W.Rj)().listSourceEndpoints(e.id),(0,W.ye)(e.id,t,n)]).then(function(){var t=w()(E().mark((function t(n){var r,a,i,o,s,c,l,u,p,d,f,m;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=_()(n,3),i=a[0],o=a[1],s=a[2],c=o&&o.data&&o.data[0],l=(null==s||null===(r=s.sources[0])||void 0===r?void 0:r.applications)||[],u={source:me(me({},e),i),applications:l},p=[],f=[],m=[],l.forEach((function(e){var t;null==e||null===(t=e.authentications)||void 0===t||t.forEach((function(t){null!=t&&t.id&&(p.push((0,W.Rj)().showAuthentication(t.id)),f.push(e.id),m.push(t.id))}))})),!(p.length>0)){t.next=13;break}return t.next=11,Promise.all(p);case 11:d=t.sent,f.forEach((function(e,t){u.applications.find((function(t){return t.id===e})).authentications.push(d[t])}));case 13:if(c){t.next=15;break}return t.abrupt("return",u);case 15:return t.abrupt("return",(0,W.Rj)().listEndpointAuthentications(c.id).then((function(e){return me(me({},u),{},{endpoints:o.data,authentications:e.data.filter((function(e){var t=e.id;return!m.includes(t)}))})})));case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},be=n(319),ge=n.n(be),he=n(6479),ve=n.n(he),Oe=n(27361),Ee=n.n(Oe),je=n(36968),we=n.n(je);function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){N()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Me="check-endpoint",Te=function(e,t){var n={};return Object.keys(t).filter((function(e){return t[e]})).forEach((function(t){we()(n,t,Ee()(e,t))})),n},De=function(e,t){var n,r,a=e.endpoints,i=e.authentications,o=e.applications,s=ve()(e,["endpoints","authentications","applications"]),c={},l=[].concat(ge()(i||[]),ge()((null==o?void 0:o.reduce((function(e,t){return[].concat(ge()(e),ge()(t.authentications))}),[]))||[]));l.length>0&&l.forEach((function(e){c["a".concat(e.id)]=e})),a&&a.length>0&&(n=a[0]),n&&(r=n.scheme||n.host||n.path||n.port?(0,v.Fd)(n):void 0);var u={};return(null==o?void 0:o.length)>0&&o.forEach((function(e){e.extra&&Object.keys(e.extra).length>0&&(u["a".concat(e.id)]={extra:e.extra})})),_e(_e({source_type:t,endpoint:n,authentications:c,url:r},Object.keys(u).length&&{applications:u}),s)},ke=function(e,t){return!e.includes(t)&&e.push(t)},Se=function(e,t){var n=[];return Object.keys(t).forEach((function(r){if(t[r]){var a,i,o=null===(a=r.match(/.a\d+/))||void 0===a||null===(i=a[0])||void 0===i?void 0:i.replace(".a","");r.startsWith("applications")&&ke(n,o),r.startsWith("authentications")&&e.applications.forEach((function(e){return e.authentications.forEach((function(t){var r=t.id,a=t.resource_type;return a&&r===o&&ke(n,"Application"===a?e.id:"".concat(Me,"-").concat(e.id))}))})),(r.startsWith("url")||r.startsWith("endpoint"))&&e.applications.forEach((function(e){return e.authentications.forEach((function(t){return"Endpoint"===t.resource_type&&ke(n,"".concat(Me,"-").concat(e.id))}))}))}})),n.filter(Boolean)},Ze=n(69949),Re=n(8772);function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){N()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne=function(){var e=w()(E().mark((function e(t,n,r,a,i,o){var s,c,l,u,p;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o({type:"submit",values:t,editing:n}),s=new Date,e.prev=2,e.next=5,(0,Ze.yH)(a,Te(t,n),t);case 5:e.next=13;break;case 7:return e.prev=7,e.t0=e.catch(2),e.next=11,r((0,S.il)());case 11:return o({type:"submitFailed"}),e.abrupt("return");case 13:if((0,k.n)(a.source.id),c={},l=Se(a,n),u=[],l.forEach((function(e){e.includes(Me)?u.push((0,Re.h)(a.endpoints[0].id,void 0,void 0,"getEndpoint",s).then((function(t){return Ae(Ae({},t),{},{id:e.replace("".concat(Me,"-"),"")})}))):u.push((0,Re.h)(e,void 0,void 0,void 0,s))})),!(u.length>0)){e.next=32;break}return e.prev=19,e.next=22,Promise.all(u);case 22:p=e.sent,e.next=31;break;case 25:return e.prev=25,e.t1=e.catch(19),e.next=29,r((0,S.il)());case 29:return o({type:"submitFailed"}),e.abrupt("return");case 31:p.forEach((function(e){var t=e.availability_status,n=e.availability_status_error,r=e.id;t===v.Rl&&(c[r]={title:i.formatMessage({id:"wizard.successEditToastTitle",defaultMessage:"Application credentials were edited successfully."}),description:n,variant:"success"}),t===v.nZ&&(c[r]={title:i.formatMessage({id:"wizard.failEditToastTitle",defaultMessage:"Edit application credentials failed."}),description:n,variant:"danger"}),t||(c[r]={title:i.formatMessage({id:"wizard.timeoutEditToastTitle",defaultMessage:"Edit in progress"}),description:i.formatMessage({id:"wizard.timeoutEditToastDescription",defaultMessage:"We are still working to confirm your updated credentials. Changes will be reflected in this table when complete."}),variant:"warning"})}));case 32:return e.next=34,r((0,S.il)());case 34:o({type:"submitFinished",messages:c});case 35:case"end":return e.stop()}}),e,null,[[2,7],[19,25]])})));return function(t,n,r,a,i,o){return e.apply(this,arguments)}}(),Ce=n(17254),Le=n(87242),Be=n(24154),ze=n(99584);function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){N()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=function(e){if(e.schema&&e.schema.endpoint&&!e.schema.endpoint.hidden){var t=e.schema.endpoint.fields.map((function(t){return qe(qe({},t),function(e,t){return Ee()(ze.Z,[e,"endpoint",t],{})}(e.name,t.name))})),n={component:Le.Z.SUB_FORM,name:"endpoint"};if("ansible-tower"===e.name){var r,a=t.find((function(e){return"url"===e.name}));return qe(qe({},n),{},{fields:[{component:Le.Z.SUB_FORM,name:"receptor_node_group",condition:{when:"endpoint.receptor_node",isNotEmpty:!0},fields:[qe(qe({},a),{},{isRequired:!1,validate:null==a||null===(r=a.validate)||void 0===r?void 0:r.filter((function(e){return e.type!==Be.Z.REQUIRED}))})]},{component:Le.Z.SUB_FORM,name:"hostname_group",condition:{when:"endpoint.receptor_node",isEmpty:!0},fields:t}]})}return qe(qe({},n),{},{fields:t})}},Ve=function(e,t,n,r){return{description:r.formatMessage({id:"sources.editFormDescripiton",defaultMessage:"Use the form fields to edit application credentials."}),fields:[].concat(ge()((0,$.JT)(e.applications,t,n)),[!!(e.endpoints&&e.endpoints.length>0)&&He(t)]).filter(Boolean)}};function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){N()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var We={loading:!0,source:void 0,initialValues:{},sourceType:void 0,schema:void 0,isSubmitting:!1,initialLoad:!0,submitError:!1};const $e=function(e,t){var n=t.type,r=t.source,a=t.sourceType,i=t.appTypes,o=t.intl,s=t.values,c=t.editing,l=t.messages;switch(n){case"createForm":return Ie(Ie({},e),{},{sourceType:a,initialValues:De(e.source,a.product_name),schema:Ve(e.source,a,i,o),loading:!1});case"setSource":return Ie(Ie({},e),{},{messages:Ie(Ie({},l),e.messages),source:r,initialLoad:!1});case"submit":return Ie(Ie({},e),{},{isSubmitting:!0,submitError:!1,values:s,editing:c});case"submitFinished":return Ie(Ie({},e),{},{isSubmitting:!1,source:r,messages:l});case"submitFailed":return Ie(Ie({},e),{},{isSubmitting:!1,submitError:!0,messages:void 0});case"sourceChanged":return Ie(Ie({},e),{},{initialLoad:!0,loading:!0});default:return e}};var Ge=n(97864);const Ke=function(){var e=(0,s.Z)();return a().createElement(Ge.Z,{customText:e.formatMessage({id:"sources.editSubmittingTitle",defaultMessage:"Validating edited source credentials"})})};var Je=n(68340),Qe=n(76690),Xe=function(e){var t=e.onRetry,n=(0,s.Z)();return a().createElement(Qe.Z,{onClose:t,customText:n.formatMessage({id:"sources.editErrorDescription",defaultMessage:"There was a problem while trying to edit your source. Please try again. If the error persists, open a support case."}),secondaryActions:a().createElement(Je.x,{component:"a",target:"_blank",href:"https://access.redhat.com/support/cases/#/case/new/open-case?caseCreate=true",rel:"noopener noreferrer"},n.formatMessage({id:"sources.openTicket",defaultMessage:"Open a support case"})),returnButtonTitle:n.formatMessage({id:"sources.retryText",defaultMessage:"Retry"})})};Xe.propTypes={onRetry:u().func.isRequired};const Ye=Xe;function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach((function(t){N()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const nt=function(){var e,t=(0,r.useReducer)($e,We),n=_()(t,2),i=n[0],o=n[1],l=(0,h.L)(),u=(0,Ce.W)(),p=i.loading,d=i.editing,f=i.source,m=i.initialValues,y=i.schema,b=i.isSubmitting,g=i.initialLoad,O=i.message,E=i.messages,j=i.submitError,w=i.values,P=(0,s.Z)(),M=(0,c.useSelector)((function(e){return e.sources}),c.shallowEqual),T=M.sourceTypes,k=M.appTypes,S=M.sourceTypesLoaded,Z=M.appTypesLoaded,R=(0,c.useDispatch)();(0,r.useEffect)((function(){g||o({type:"sourceChanged"})}),[l,null==l||null===(e=l.applications)||void 0===e?void 0:e.length]),(0,r.useEffect)((function(){l&&g&&Z&&ye(l,k,T).then((function(e){var t=function(e,t){var n,r,a={};return e.applications.forEach((function(e){var n=e.id,r=e.availability_status_error;e.availability_status===v.nZ&&(a[n]={title:t.formatMessage({id:"wizard.failEditToastTitleBeforeEdit",defaultMessage:"This application is unavailable"}),description:r,variant:"danger"})})),null!==(n=e.endpoints)&&void 0!==n&&null!==(r=n[0])&&void 0!==r&&r.availability_status_error&&e.applications.map((function(e){return e.authentications.find((function(e){return"Endpoint"===e.resource_type}))?e.id:void 0})).filter(Boolean).forEach((function(n){var r,i;a[n]={title:t.formatMessage({id:"wizard.failEditToastTitleBeforeEdit",defaultMessage:"This application is unavailable"}),description:null===(r=e.endpoints)||void 0===r||null===(i=r[0])||void 0===i?void 0:i.availability_status_error,variant:"danger"}})),a}(e,P);o({type:"setSource",source:e,messages:t})}))}),[l,u,Z,g]),(0,r.useEffect)((function(){if(f&&Z&&S){var e=T.find((function(e){return e.id===f.source.source_type_id}));o({type:"createForm",sourceType:e,source:f,appTypes:k,intl:P})}}),[Z,f,S]);var x=!Z||!S||p;return j?a().createElement(Ye,{onRetry:function(){return Ne(w,d,R,f,P,o)}}):b?a().createElement(Ke,null):x?a().createElement(ue.b,{className:"pf-u-m-2xl"},a().createElement(D.$,null)):a().createElement(de.Z,{schema:y,onSubmit:function(e,t){return Ne(e,t.getState().dirtyFields,R,f,P,o)},FormTemplate:function(e){return a().createElement(pe.ZP,le()({canReset:!0,submitLabel:"Save changes",disableSubmit:["pristine","invalid"]},e))},clearedValue:null,initialValues:tt(tt({},m),{},{message:O,messages:E})})},rt=function(){var e=(0,s.Z)(),t=(0,h.L)(),n=(0,F.E)();return a().createElement(p.Z,{className:"card pf-u-m-lg pf-u-mt-0"},a().createElement(f.l,null,e.formatMessage({id:"detail.resources.title",defaultMessage:"Manage connected applications"})),a().createElement(d.e,null,!n&&a().createElement(se,null),n&&0===t.applications.length&&a().createElement(ie,null),n&&t.applications.length>0&&a().createElement(nt,null)))};var at=n(77334),it=n(97752),ot=n(99338),st=n(48716),ct=n(68774),lt=n(28191),ut=n(92298),pt=n(64029),dt=n(32835);const ft=function(){var e=(0,s.Z)(),t=(0,h.L)();return a().createElement(pt.a,null,a().createElement(dt.g,{component:function(e){var t=e.href,n=ve()(e,["href"]);return a().createElement(C.Link,le()({to:t},n))},to:z._j.sources.path},e.formatMessage({id:"sources.sources",defaultMessage:"Sources"})),a().createElement(dt.g,{isActive:!0},t.name))};var mt=n(56787),yt=n(84457),bt=n(80737);const gt=function(){var e=(0,r.useState)(!1),t=_()(e,2),n=t[0],i=t[1],o=(0,s.Z)(),c=(0,C.useHistory)().push,l=(0,h.L)(),u=(0,F.E)(),p={tooltip:o.formatMessage({id:"sources.notAdminButton",defaultMessage:"To perform this action, you must be granted write permissions from your Organization Administrator."}),isDisabled:!0,className:"ins-c-sources__disabled-drodpown-item"};return a().createElement(mt.L,{toggle:a().createElement(bt.a,{onToggle:function(){return i(!n)},id:"toggle-id-6"}),isOpen:n,isPlain:!0,position:"right",dropdownItems:[a().createElement(yt.h,le()({},!u&&p,{key:"rename",onClick:function(){return c((0,z.yS)(z._j.sourcesDetailRename.path,l.id))}}),o.formatMessage({id:"detail.rename.button",defaultMessage:"Rename"})),a().createElement(yt.h,le()({},!u&&p,{key:"remove",onClick:function(){return c((0,z.yS)(z._j.sourcesDetailRemove.path,l.id))}}),o.formatMessage({id:"detail.remove.button",defaultMessage:"Remove"}))]})},ht=function(){var e=(0,s.Z)(),t=(0,h.L)(),n=(0,c.useSelector)((function(e){return e.sources.appTypes}),c.shallowEqual);return a().createElement(st.Z,null,a().createElement(ft,null),a().createElement(lt.k,{className:"pf-u-mb-sm"},a().createElement(ut.B,null,a().createElement(re.D,{headingLevel:"h1",size:"2xl"},t.name)),a().createElement(ut.B,null,(0,v.BN)(void 0,t,{appTypes:n})),a().createElement(ut.B,{align:{default:"alignRight"}},a().createElement(gt,null))),a().createElement(ct.D,null,a().createElement(Je.x,null,e.formatMessage({id:"detail.description",defaultMessage:"View details and manage connections for this source."}))))};var vt=n(51851),Ot=n(5913),Et=n(90832),jt=n(48099),wt=n(29873),Pt=n(63523);function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){N()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tt=function(e){var t=e.applicationName,n=(0,s.Z)();return a().createElement(ue.b,null,a().createElement(ee.u,{variant:ee.I.small},a().createElement(te.k,{icon:Ot.ZP}),a().createElement(re.D,{headingLevel:"h2",size:"lg"},n.formatMessage({id:"resourceTable.emptyStateTitle",defaultMessage:"No application resources"})),a().createElement(ne.B,null,n.formatMessage({id:"resourceTable.emptyStateDescription",defaultMessage:"{applicationName} resources will appear here when created."},{applicationName:t}))))};Tt.propTypes={applicationName:u().string.isRequired};var Dt=function(e){return[e.formatMessage({id:"resourceTable.resourceType",defaultMessage:"Resource type"}),e.formatMessage({id:"resourceTable.resourceValue",defaultMessage:"Value"})]},kt=function(e,t,n){return e.applications.reduce((function(r,i){var o,s,c,l=t.find((function(e){return e.id===i.application_type_id})),u=(s=(0,Pt.Hx)(null===(o=i.authentications)||void 0===o?void 0:o.filter((function(e){return Object.keys(e).length>1})),n,null==l?void 0:l.name,i.id),c=De(e,n.product_name),s.flatMap((function(e){return e})).map((function(e){return!e.hideField&&[a().createElement(a().Fragment,{key:"label"},e.label),Ee()(c,e.name)]})).filter(Boolean));return Mt(Mt({},r),{},N()({},i.id,u))}),{})},St=function(e,t){var n=t.type,r=t.intl,a=t.source,i=t.activeTab,o=t.appTypes,s=t.sourceType;switch(n){case"loaded":return Mt(Mt({},e),{},{columns:Dt(r),applicationsRows:kt(a,o,s),loading:!1,activeTab:a.applications[0].id});case"switchTab":return Mt(Mt({},e),{},{activeTab:i})}};const Zt=function(){var e,t=(0,s.Z)(),n=(0,h.L)(),i=(0,Ce.W)(),o=(0,c.useSelector)((function(e){return e.sources}),c.shallowEqual),l=o.sourceTypes,u=o.appTypes,m=o.sourceTypesLoaded,y=o.appTypesLoaded,b=(0,r.useReducer)(St,function(e){var t;return{loading:Boolean(null===(t=e.applications)||void 0===t?void 0:t.length),columns:[],applicationsRows:{},activeTab:0}}(n)),g=_()(b,2),v=g[0],O=v.activeTab,E=v.loading,j=v.columns,w=v.applicationsRows,P=g[1];return(0,r.useEffect)((function(){var e;n&&i&&y&&m&&null!=n&&null!==(e=n.applications)&&void 0!==e&&e.length&&ye(n,u,l).then((function(e){var n=l.find((function(t){return t.id===e.source.source_type_id}));P({type:"loaded",source:e,intl:t,sourceType:n,appTypes:u})}))}),[null==n||null===(e=n.applications)||void 0===e?void 0:e.length,i,y,m]),a().createElement(p.Z,{className:"card pf-u-m-lg pf-u-mt-0"},a().createElement(f.l,null,t.formatMessage({id:"resourceTable.title",defaultMessage:"Connected application resources"})),a().createElement(d.e,null,E&&a().createElement(ue.b,{className:"pf-u-m-2xl"},a().createElement(D.$,null)),!E&&!n.applications.length&&a().createElement(ie,null),!E&&n.applications.length>0&&a().createElement(a().Fragment,null,a().createElement(Je.x,{className:"pf-u-mb-md"},t.formatMessage({id:"resourceTable.description",defaultMessage:"View resources for your connected applications."})),a().createElement(Et.m,{isBox:!0,activeKey:O,onSelect:function(e,t){return P({type:"switchTab",activeTab:t})}},n.applications.map((function(e){var n,r,i=(null===(n=u.find((function(t){return t.id===e.application_type_id})))||void 0===n?void 0:n.display_name)||e.application_type_id;return a().createElement(jt.O,{eventKey:e.id,key:e.id,title:a().createElement(wt.T,null,i)},null!==(r=w[e.id])&&void 0!==r&&r.length?a().createElement(vt.Table,{"aria-label":t.formatMessage({id:"resourceTable.title",defaultMessage:"Connected application resources"}),variant:"compact",cells:j,rows:w[e.id],className:"pf-u-mt-md"},a().createElement(vt.TableHeader,null),a().createElement(vt.TableBody,null)):a().createElement(Tt,{applicationName:i}))}))))))};var Rt=(0,r.lazy)((function(){return n.e(8490).then(n.bind(n,2453))})),xt=(0,r.lazy)((function(){return Promise.all([n.e(6410),n.e(7115),n.e(6090),n.e(1609),n.e(9972),n.e(1240),n.e(7647),n.e(3973),n.e(7533),n.e(5180)]).then(n.bind(n,98788))})),At=(0,r.lazy)((function(){return Promise.all([n.e(7533),n.e(3744)]).then(n.bind(n,28794))})),Nt=(0,r.lazy)((function(){return Promise.all([n.e(9166),n.e(1438),n.e(1240),n.e(1062),n.e(8291)]).then(n.bind(n,95981))})),Ct=(0,r.lazy)((function(){return Promise.all([n.e(1438),n.e(8331)]).then(n.bind(n,64108))}));const Lt=function(){var e=(0,h.L)();if(!e)return a().createElement(a().Fragment,null,a().createElement(it.X6,null),a().createElement(at.Z,null));var t=(0,I.Z)(e);return a().createElement("div",{className:"ins-c-sources__detail-page"},a().createElement(r.Suspense,{fallback:null},a().createElement(ot.Z,{exact:!0,route:z._j.sourcesDetailRemove,Component:Rt,componentProps:{backPath:(0,z.yS)(z._j.sourcesDetail.path,e.id)}}),a().createElement(ot.Z,{exact:!0,route:z._j.sourcesDetailAddApp,Component:xt}),a().createElement(ot.Z,{exact:!0,route:z._j.sourcesDetailRemoveApp,Component:At}),a().createElement(ot.Z,{exact:!0,route:z._j.sourcesDetailRename,Component:Nt}),a().createElement(ot.Z,{exact:!0,route:z._j.sourcesDetailEditCredentials,Component:Ct})),a().createElement(ht,null),a().createElement(i.r,null,a().createElement(o.P,{md:"6"},a().createElement(x,null)),a().createElement(o.P,{md:"6"},a().createElement(Y,null)),a().createElement(o.P,{md:"12"},t?a().createElement(Zt,null):a().createElement(rt,null))))}},41252:(e,t,n)=>{"use strict";n.d(t,{Z:()=>D});var r=n(67154),a=n.n(r),i=n(59713),o=n.n(i),s=n(80150),c=n.n(s),l=n(97593),u=n(81554),p=n(83862),d=n(63038),f=n.n(d),m=n(27361),y=n.n(m),b=n(59775),g=n(92607),h=n(28517),v=n(58860),O=n(24154),E=n(9481);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const P=function(e){var t,n,r=(0,v.Z)(),i=r.getState().values,o=(null==e||null===(t=e.name)||void 0===t?void 0:t.match(/\d+/))||[],l=f()(o,1)[0]||(null===(n=i.authentication)||void 0===n?void 0:n.id),u=y()(i,e.name),p=(0,s.useState)(!l||u),d=f()(p,2),m=d[0],j=d[1],P=(0,s.useRef)(!0),_=(0,s.useRef)(!1);(0,s.useEffect)((function(){_.current&&(!P.current&&r.getState().pristine&&(j(!1),P.current=!0),m&&(P.current=!1))})),(0,s.useEffect)((function(){_.current=!0}),[]);var M=e.validate&&e.validate.filter((function(e){return e.type!==O.Z.REQUIRED})),T=w(w({},e),l?{validate:M,resolveProps:E.Z}:{});return!m&&l?c().createElement(b.c,{helperText:T.helperText,label:T.label,onFocus:function(){return j(!0)},isRequired:!0},c().createElement(g.oi,{"aria-label":"pre-filled-authentication",value:"•••••••••••••"})):c().createElement(h.Z,a()({},T,{autoFocus:!0}))};var _=n(34686);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const D=function(e){return c().createElement(l.Z,a()({FormTemplate:u.ZP,componentMapper:T(T(T({},p.ZP),_.x),{},{authentication:P})},e))}}}]);
//# sourceMappingURL=sourceDetail.651e991063133a59d7a5.js.map