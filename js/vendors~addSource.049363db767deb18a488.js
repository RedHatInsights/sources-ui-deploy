(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{495:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));var n=r(463),a=Object(n.a)((function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function c(e,t,r,n){var a=t&&t.prototype instanceof h?t:h,i=Object.create(a.prototype),o=new M(n||[]);return i._invoke=function(e,t,r){var n=l;return function(a,i){if(n===d)throw new Error("Generator is already running");if(n===f){if("throw"===a)throw i;return R()}for(r.method=a,r.arg=i;;){var o=r.delegate;if(o){var s=S(o,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var c=u(e,t,r);if("normal"===c.type){if(n=r.done?f:p,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=f,r.method="throw",r.arg=c.arg)}}}(e,r,o),i}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l="suspendedStart",p="suspendedYield",d="executing",f="completed",m={};function h(){}function y(){}function b(){}var g={};g[i]=function(){return this};var v=Object.getPrototypeOf,O=v&&v(v(x([])));O&&O!==r&&n.call(O,i)&&(g=O);var w=b.prototype=h.prototype=Object.create(g);function j(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function E(e,t){function r(a,i,o,s){var c=u(e[a],e,i);if("throw"!==c.type){var l=c.arg,p=l.value;return p&&"object"==typeof p&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(p).then((function(e){l.value=e,o(l)}),(function(e){return r("throw",e,o,s)}))}s(c.arg)}var a;this._invoke=function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}}function S(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=u(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function x(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:R}}function R(){return{value:t,done:!0}}return y.prototype=w.constructor=b,b.constructor=y,b[s]=y.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},j(E.prototype),E.prototype[o]=function(){return this},e.AsyncIterator=E,e.async=function(t,r,n,a,i){void 0===i&&(i=Promise);var o=new E(c(t,r,n,a),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},j(w),w[s]="Generator",w[i]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=x,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return s.type="throw",s.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;_(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:x(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));function i(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}var o=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,c,"next",e)}function c(e){i(o,n,a,s,c,"throw",e)}s(void 0)}))}}},557:function(e,t,r){"use strict";r.d(t,"a",(function(){return B}));r(463);var n=r(464),a=(r(94),r(85)),i=r(0),o=r.n(i),s=r(6),c=r.n(s),u=r(22),l=r(11),p=r(13),d=r(167),f=r(97),m=(r(60),r(3)),h=r(15),y=(r(138),r(95)),b=r(106),g=r(28),v=r(163),O=r(449),w=r(495),j=r(496),E=r(478),S=(r(460),r(494)),T=r(519),_=r(520),M=r(146),x=r(81),R=r(189),k=function(e){var t=e.name,r=Object(b.a)();return Object(i.useEffect)((function(){return setTimeout((function(){return r.change(t,"1")})),function(){return r.change(t,"")}}),[]),null};k.propTypes={name:c.a.string.isRequired};var z=function(e){var t=e.title,r=e.description,a=e.isEnabled,i=Object(n.a)(e,["title","description","isEnabled"]);return o.a.createElement(x.a,i,o.a.createElement(T.a,null,o.a.createElement(_.a,{spacer:{default:"spacerSm"}},o.a.createElement(R.a,{fill:a?"#3E8635":"#6A6E73"})),o.a.createElement(_.a,null,o.a.createElement(m.a,{className:"pf-u-mb-xs ins-c-sources__wizard--rhel-desc-title"},t),o.a.createElement(m.a,null,r))))};z.propTypes={title:c.a.string.isRequired,description:c.a.string.isRequired,isEnabled:c.a.bool};var A=function(e){var t,r=e.id,n=Object(u.a)(),a=(null===(t=(0,Object(b.a)().getState)().values.application)||void 0===t?void 0:t.application_type_id)===r;return o.a.createElement(M.a,null,o.a.createElement(z,{title:n.formatMessage({id:"rhelbundle.goldImages.title",defaultMessage:"Red Hat Gold Images"}),description:n.formatMessage({id:"rhelbundle.goldImages.description",defaultMessage:"Unlock cloud images in AWS and bring your own subscription instead of paying hourly."}),className:"pf-u-mb-sm",isEnabled:a}),o.a.createElement(z,{title:n.formatMessage({id:"rhelbundle.subwatch.title",defaultMessage:"High precision subscription watch data"}),description:n.formatMessage({id:"rhelbundle.subwatch.description",defaultMessage:"View precise public cloud usage data in subscription watch."}),className:"pf-u-mb-sm",isEnabled:a}),o.a.createElement(z,{title:n.formatMessage({id:"rhelbundle.autoregistration.title",defaultMessage:"Autoregistration"}),description:n.formatMessage({id:"rhelbundle.goldImages.description",defaultMessage:"Cloud instances automatically connect to cloud.redhat.com when provisioned."}),isEnabled:a}))};function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}A.propTypes={id:c.a.string.isRequired};var L,q=(L=Object(w.a)(w.b.mark((function e(t){var r,n,a,i=arguments;return w.b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:void 0,n=i.length>2?i[2]:void 0,t){e.next=4;break}return e.abrupt("return",void 0);case 4:return e.prev=4,e.next=7,Object(v.d)(t);case 7:a=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),console.error(Object(E.a)(e.t0)),e.abrupt("return",void 0);case 14:if(!a.data.sources.find((function(e){return e.id!==r}))){e.next=16;break}throw n.formatMessage({defaultMessage:"That name is taken. Try another.",id:"wizard.nameTaken"});case 16:return e.abrupt("return",void 0);case 17:case"end":return e.stop()}}),e,null,[[4,10]])}))),function(e){return L.apply(this,arguments)}),D=!0,N=function(e){return D=e},B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{onlyResolvesLast:!1};return Object(j.a)(e,t,r)}(q),F=function(e){return D?(N(!1),function(t,r){return t?q(t,r,e):void 0}):B},I=function(e){return Object(d.a)(e.map((function(e){return C({},e,{product_name:"Red Hat"===e.vendor?e.product_name.replace("Red Hat ",""):e.product_name})})).sort((function(e,t){return e.product_name.localeCompare(t.product_name)})).map((function(e){return{value:e.name,label:e.product_name}})))},G=function(e,t){var r;return(r={},Object(a.a)(r,g.c,t.formatMessage({id:"cost.app.description",defaultMessage:"Analyze, forecast, and optimize your Red Hat OpenShift cluster costs in hybrid cloud environments."})),Object(a.a)(r,g.b,o.a.createElement(A,{id:e.id})),r)[e.name]},W=function(e,t){return Object(a.a)({},g.b,o.a.createElement("span",{className:"ins-c-sources__wizard--rhel-mag-label"},"RHEL management ",o.a.createElement(f.a,{className:"pf-u-ml-sm",color:"purple"},t.formatMessage({id:"sub.bundle",defaultMessage:"Bundle"}))))[e.name]},V=function(e,t){return[].concat(Object(d.a)(e.sort((function(e,t){return e.display_name.localeCompare(t.display_name)})).map((function(e){return{value:e.id,label:W(e,t)||e.display_name,description:G(e,t)}}))),Object(d.a)(Object(y.g)()!==y.d?[{label:t.formatMessage({id:"wizard.noApplication",defaultMessage:"No application"}),value:y.c}]:[]))},H=function(e){return function(t,r){var n=r.getState().values.source_type,a=e.find((function(e){return e.id===t.value}));if(!n||!a||a.supported_source_types.includes(n))return t}},U=function(e,t){return function(r,n){var a=n.getState().values.application?n.getState().values.application.application_type_id:void 0,i=e.find((function(e){return e.id===a})),o=!i||i.supported_source_types.includes(t.find((function(e){return e.product_name===r.label})).name);return C({},r,{isDisabled:!o})}},Y={amazon:"/apps/frontend-assets/partners-icons/aws.svg","ansible-tower":"/apps/frontend-assets/red-hat-logos/stacked.svg",azure:"/apps/frontend-assets/partners-icons/microsoft-azure-short.svg",openshift:"/apps/frontend-assets/red-hat-logos/stacked.svg",satellite:"/apps/frontend-assets/red-hat-logos/stacked.svg",google:"/apps/frontend-assets/partners-icons/google-cloud-short.svg"},Q=function(e){return function(t){var r=e.find((function(e){return e.name===t}));return!r||r.icon_url&&!Y[t]?null:function(){return o.a.createElement("img",{src:Y[t]||r.icon_url,alt:r.product_name,className:"ins-c-sources__wizard--icon ".concat("Red Hat"===r.vendor?"redhat-icon":"pf-u-mb-sm")})}}},X=function(e){var t=e.values,r=t.application,n=t.source_type,a=r&&r.application_type_id!==y.c&&r.application_type_id;return a?"".concat(n,"-").concat(a):n},J=function(e){var t=e.intl,r=e.sourceTypes;return e.applicationTypes,{component:"card-select",name:"source_type",isRequired:!0,label:t.formatMessage({id:"wizard.selectYourSourceType",defaultMessage:"A. Select your source type"}),iconMapper:Q(r),validate:[{type:p.a.REQUIRED}],options:I(r)}},Z=function(e){var t=e.intl,r=e.sourceTypes,n=e.applicationTypes,a=e.disableAppSelection;return[C({},J({intl:t,sourceTypes:r,applicationTypes:n}),{mutator:U(n,r)}),{component:"enhanced-radio",name:"application.application_type_id",label:t.formatMessage({id:"wizard.selectYourApplication",defaultMessage:"B. Select an application"}),options:V(n,t),mutator:H(n),isDisabled:a,placeholder:t.formatMessage({id:"wizard.chooseApp",defaultMessage:"Choose application"}),menuIsPortal:!0}]},$=function(e){var t=e.intl,r=e.sourceTypes,n=e.applicationTypes,a=e.disableAppSelection;return[J({intl:t,sourceTypes:r,applicationTypes:n}),{component:"enhanced-radio",name:"application.application_type_id",label:t.formatMessage({id:"wizard.selectApplication",defaultMessage:"B. Application"}),options:V(n,t),mutator:H(n),isDisabled:a,isRequired:!0,validate:[{type:p.a.REQUIRED}],condition:{when:"source_type",isNotEmpty:!0}}]},K=function(e,t,r){return{name:"types_step",title:r.formatMessage({id:"wizard.selectApplication",defaultMessage:"Select application"}),nextStep:X,fields:[{component:l.a.PLAIN_TEXT,name:"app-description",label:r.formatMessage({id:"wizard.applicationDescription",defaultMessage:"Select an application to connect to your source. You can connect additional applications after source creation."})},{component:"enhanced-radio",name:"application.application_type_id",options:V(e.filter((function(e){return e.supported_source_types.includes(t)})),r),mutator:H(e),menuIsPortal:!0},{component:l.a.TEXT_FIELD,name:"source_type",hideField:!0}]}},ee=function(e,t,r,n){return{title:n.formatMessage({id:"wizard.chooseAppAndType",defaultMessage:"Source type and application"}),name:"types_step",nextStep:X,fields:[].concat(Object(d.a)(Object(y.g)()===y.d?$({intl:n,sourceTypes:e,applicationTypes:t,disableAppSelection:r}):Z({intl:n,sourceTypes:e,applicationTypes:t,disableAppSelection:r})),[{component:"description",name:"fixasyncvalidation",Content:k}])}},te=function(){var e=Object(u.a)();return o.a.createElement(h.a,{key:"step1"},o.a.createElement(m.a,{component:m.b.p},e.formatMessage({id:"wizard.nameDescription",defaultMessage:"To import data for an application, you need to connect to a data source. Enter a name, then proceed to select your application and source type."})))},re=function(e){return{title:e.formatMessage({id:"wizard.nameSource",defaultMessage:"Name source"}),name:"name_step",nextStep:"types_step",fields:[{component:"description",name:"description-summary",Content:te},{component:l.a.TEXT_FIELD,name:"source.name",type:"text",label:e.formatMessage({id:"wizard.name",defaultMessage:"Name"}),placeholder:"Source_1",isRequired:!0,validate:[function(t){return F(e)(t,void 0,e)},{type:p.a.REQUIRED}],resolveProps:S.a}]}},ne=function(){var e=Object(u.a)();return o.a.createElement(h.a,null,o.a.createElement(m.a,{component:m.b.p},e.formatMessage({id:"wizard.summaryDescription",defaultMessage:"Review the information below and click <b>Add</b> to add your source. To edit details in previous steps, click <b>Back</b>."},{b:function(e){return o.a.createElement("b",{key:"b-".concat(e.length,"-").concat(Math.floor(1e3*Math.random()))},e)}})))},ae=function(e,t,r){return{fields:[{component:"description",name:"description-summary",Content:ne},{name:"summary",component:"summary",sourceTypes:e,applicationTypes:t}],name:"summary",title:r.formatMessage({id:"wizard.reviewDetails",defaultMessage:"Review details"})}};t.b=function(e,t,r,n,a,i,o){return N(!0),{fields:[{component:l.a.WIZARD,name:"wizard",title:Object(y.e)(),inModal:!0,description:Object(y.f)(),buttonLabels:{submit:a.formatMessage({id:"sources.add",defaultMessage:"Add"}),back:a.formatMessage({id:"wizard.back",defaultMessage:"Back"}),cancel:a.formatMessage({id:"wizard.cancel",defaultMessage:"Cancel"}),next:a.formatMessage({id:"wizard.next",defaultMessage:"Next"})},container:n,showTitles:!0,initialState:o,crossroads:["application.application_type_id","source_type","auth_select"],fields:[re(a),i?K(t,i,a):ee(e,t,r,a)].concat(Object(d.a)(Object(O.n)(e,t)),[ae(e,t,a)])}]}}},771:function(e,t,r){"use strict";r.r(t),r.d(t,"AddSourceButton",(function(){return ee})),r.d(t,"AddSourceWizard",(function(){return K}));r(463);var n=r(606),a=r(464),i=r(94),o=r(85),s=r(0),c=r.n(s),u=r(75),l=r(6),p=r.n(l),d=r(556),f=r.n(d),m=r(22),h=r(9),y=r(623),b=(r(561),r(11),r(13),r(546),r(480),r(560),r(167),r(60),r(3)),g=r(15),v=(r(138),r(95)),O=(r(106),r(28)),w=r(163),j=(r(449),r(607),r(605)),E=(r(453),r(608),r(553),r(495)),S=(r(496),r(557)),T=r(478),_=(r(460),r(494),r(554)),M=r(498),x=r(570),R=r(558),k=r(555),z=r(612),A=r(614),P=r(538),C=r(104),L=r(518);function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var N,B=function(e){return e.url?function(e){if(!e)return{};try{var t=new URL(e);return{scheme:t.protocol.replace(/:$/,""),host:t.hostname,port:t.port,path:t.pathname}}catch(e){return console.log(e),{}}}(e.url):e},F=(N=Object(E.a)(E.b.mark((function e(t,r){var n,a,o,s,c,u,l,p,d,f,m,h,y,b,g,O,j,S,_,M,x,R,k,z,A,P=arguments;return E.b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=P.length>2&&void 0!==P[2]?P[2]:[],e.prev=1,c=r.find((function(e){return e.name===t.source_type})).id,e.next=5,Object(w.e)().createSource(D({},t.source,{source_type_id:c}));case 5:return a=e.sent,u=[],t.endpoint?(l=B(t),p=l.scheme,d=l.host,f=l.port,m=l.path,h=parseInt(f,10),y=D({},t.endpoint,{default:!0,source_id:a.id,scheme:p,host:d,port:isNaN(h)?void 0:h,path:m}),u.push(Object(w.e)().createEndpoint(y))):u.push(Promise.resolve(void 0)),t.application&&t.application.application_type_id&&t.application.application_type_id!==v.c?(b=D({},t.application,{source_id:a.id}),u.push(Object(w.e)().createApplication(b))):u.push(Promise.resolve(void 0)),e.next=11,Promise.all(u);case 11:if(g=e.sent,O=Object(i.a)(g,2),j=O[0],S=O[1],!(j||t.authentication&&(null===(o=S)||void 0===o?void 0:o.id))){e.next=20;break}return k=D({},t.authentication,{resource_id:(null===(M=j)||void 0===M?void 0:M.id)||(null===(x=S)||void 0===x?void 0:x.id),resource_type:(null===(R=j)||void 0===R?void 0:R.id)?"Endpoint":"Application",source_id:a.id}),e.next=19,Object(w.e)().createAuthentication(k);case 19:_=e.sent;case 20:if(!_||!S){e.next=24;break}return z={application_id:S.id,authentication_id:_.id},e.next=24,Object(w.e)().createAuthApp(z);case 24:if((null===(s=a)||void 0===s?void 0:s.id)&&Object(w.e)().checkAvailabilitySource(a.id),!S){e.next=30;break}return A=n.includes(S.application_type_id)?1e4:0,e.next=29,Object(L.a)(S.id,A);case 29:S=e.sent;case 30:if(!j){e.next=34;break}return e.next=33,Object(L.a)(j.id,void 0,void 0,"getEndpoint");case 33:j=e.sent;case 34:return e.abrupt("return",D({},a,{endpoint:[j],applications:[S]}));case 37:return e.prev=37,e.t0=e.catch(1),e.next=41,Object(T.a)(e.t0,a?a.id:void 0);case 41:throw e.sent;case 43:case"end":return e.stop()}}),e,null,[[1,37]])}))),function(e,t){return N.apply(this,arguments)}),I=r(615);function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var V={schema:{},sourceTypes:[],isLoading:!0},H=function(e,t){var r=t.type,n=t.sourceTypes,a=t.applicationTypes,i=t.container,o=t.disableAppSelection,s=t.intl,c=t.selectedType,u=t.initialWizardState;switch(r){case"loaded":return W({},e,{schema:Object(S.b)(n.filter(x.a).filter(x.b),a.filter(M.a).filter(Object(M.b)(n)),o,i,s,c,u),isLoading:!1,sourceTypes:n})}},U=function(e){var t=e.sourceTypes,r=e.applicationTypes,n=e.disableAppSelection,a=e.isCancelling,o=e.onCancel,u=e.values,l=e.onSubmit,p=e.selectedType,d=e.initialWizardState,f=Object(s.useReducer)(H,V),h=Object(i.a)(f,2),b=h[0],g=b.schema,O=b.sourceTypes,E=b.isLoading,S=h[1],T=Object(s.useRef)(!1),M=Object(s.useRef)(document.createElement("div")),x=Object(m.a)();return Object(s.useEffect)((function(){T.current=!0;var e=[];return t||e.push(Object(w.c)()),r||e.push(Object(w.b)()),Promise.all(e).then((function(e){var a=e.find((function(e){return e.hasOwnProperty("sourceTypes")})),i=e.find((function(e){return e.hasOwnProperty("applicationTypes")}));T.current&&S({type:"loaded",sourceTypes:t||a.sourceTypes,applicationTypes:r||i.applicationTypes,disableAppSelection:n,container:M.current,intl:x,selectedType:p,initialWizardState:d})})),function(){T.current=!1}}),[]),Object(s.useEffect)((function(){M.current.hidden=a}),[a]),E?c.a.createElement(y.a,{isOpen:!0,onClose:o,title:Object(v.e)(),description:Object(v.f)(),steps:[{name:"Loading",component:c.a.createElement(_.a,{onClose:function(){return o()}}),isFinishedStep:!0}]}):c.a.createElement(j.a,{initialValues:W({},u,{},p&&{source_type:p}),schema:g,onSubmit:function(e,t,r){return l(e,O,r)},onCancel:o})};U.propTypes={onCancel:p.a.func.isRequired,onSubmit:p.a.func.isRequired,sourceTypes:p.a.arrayOf(p.a.shape({id:p.a.string.isRequired,name:p.a.string.isRequired,product_name:p.a.string.isRequired,schema:p.a.shape({authentication:p.a.array,endpoint:p.a.object})})),applicationTypes:p.a.arrayOf(p.a.shape({id:p.a.string.isRequired,name:p.a.string.isRequired,display_name:p.a.string.isRequired})),values:p.a.object,disableAppSelection:p.a.bool,isCancelling:p.a.bool,selectedType:p.a.string,initialWizardState:p.a.object},U.defaultProps={values:{},disableAppSelection:!1};var Y=function(e){var t=e.id,r=Object(m.a)().formatMessage({id:"wizard.editSource",defaultMessage:"Edit source"});return"sources"===insights.chrome.getApp()?c.a.createElement(C.b,{to:"/sources/detail/".concat(t)},c.a.createElement(u.a,{variant:"primary",className:"pf-u-mt-xl"},r)):c.a.createElement(u.a,{variant:"primary",className:"pf-u-mt-xl",component:"a",target:"_blank",href:"".concat(Object(R.b)(),"/detail/").concat(t),rel:"noopener noreferrer"},r)};Y.propTypes={id:p.a.string.isRequired};var Q=function(e){var t,r,n,a,o,l,p=e.afterSubmit,d=e.afterError,f=e.isFinished,h=e.isErrored,O=e.successfulMessage,j=e.hideSourcesButton,E=e.returnButtonTitle,S=e.reset,T=e.createdSource,M=void 0===T?{}:T,x=e.tryAgain,C=e.afterSuccess,L=e.sourceTypes,q=Object(s.useState)(),D=Object(i.a)(q,2),N=D[0],B=D[1],F=Object(s.useState)(),I=Object(i.a)(F,2),G=I[0],W=I[1],V=Object(m.a)(),H=c.a.createElement(u.a,{variant:"link",onClick:S},V.formatMessage({id:"wizard.addAnotherSource",defaultMessage:"Add another source"}));if(G)l=c.a.createElement(R.a,{onClose:p,title:V.formatMessage({id:"wizard.removeSourceSuccessTitle",defaultMessage:"Removing successful"}),successfulMessage:V.formatMessage({id:"wizard.removeSourceSuccessDescription",defaultMessage:"Source was successfully removed."}),hideSourcesButton:j,returnButtonTitle:E,secondaryActions:H});else if(N)l=c.a.createElement(_.a,{customText:V.formatMessage({id:"wizard.removingSource",defaultMessage:"Removing source"})});else if(f)switch(Object(P.a)(M)){case"unavailable":l=c.a.createElement(k.a,{onClose:p,secondaryActions:c.a.createElement(u.a,{variant:"link",onClick:function(){return B(!0),Object(w.e)().removeSource(M.id).then((function(){C&&C(),W(!0)})).catch((function(){return B(!1)}))}},V.formatMessage({id:"wizard.removeSource",defaultMessage:"Remove source"})),Component:function(){return c.a.createElement(Y,{id:M.id})},message:(null===(t=M.applications)||void 0===t||null===(r=t[0])||void 0===r?void 0:r.availability_status_error)||(null===(n=M.endpoint)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.availability_status_error)||V.formatMessage({id:"wizard.unknownError",defaultMessage:"Unknown error"}),title:V.formatMessage({id:"wizard.configurationUnsuccessful",defaultMessage:"Configuration unsuccessful"})});break;case"timeout":l=c.a.createElement(z.a,{onClose:p,returnButtonTitle:E,secondaryActions:H});break;default:l=M.source_type_id===(null===(o=L.find((function(e){return"amazon"===e.name})))||void 0===o?void 0:o.id)?c.a.createElement(A.a,{onClose:p}):c.a.createElement(R.a,{onClose:p,successfulMessage:O,hideSourcesButton:j,returnButtonTitle:E,secondaryActions:H})}else l=h?c.a.createElement(k.a,{onClose:d,primaryAction:x,secondaryActions:c.a.createElement(b.a,{component:"a",target:"_blank",href:"https://access.redhat.com/support/cases/#/case/new/open-case?caseCreate=true",rel:"noopener noreferrer"},V.formatMessage({id:"wizard.openTicket",defaultMessage:"Open a support case"})),returnButtonTitle:V.formatMessage({id:"wizard.retryText",defaultMessage:"Retry"})}):c.a.createElement(_.a,{customText:V.formatMessage({id:"wizard.loadingText",defaultMessage:"Validating credentials"}),description:c.a.createElement(g.a,null,c.a.createElement(b.a,{className:"pf-u-mb-md"},V.formatMessage({id:"wizard.loadingDescription-a",defaultMessage:"This might take some time. You'll receive a notification if you are still in the Sources application when the process completes. Otherwise, you can check the status in the main sources table at any time."})),c.a.createElement(b.a,null,V.formatMessage({id:"wizard.loadingDescription-b",defaultMessage:"In the meantime, you can close this window while the validation process continues."}))),onClose:d,cancelTitle:V.formatMessage({id:"wizard.close",defaultMessage:"Close"})});return c.a.createElement(y.a,{isOpen:!0,onClose:f?p:d,title:Object(v.e)(),description:Object(v.f)(),steps:[{name:"Finish",component:l,isFinishedStep:!0}]})};function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Q.propTypes={afterSubmit:p.a.func.isRequired,afterError:p.a.func.isRequired,isFinished:p.a.bool.isRequired,isErrored:p.a.bool.isRequired,successfulMessage:p.a.node.isRequired,hideSourcesButton:p.a.bool,returnButtonTitle:p.a.node.isRequired,errorMessage:p.a.node,reset:p.a.func,createdSource:p.a.object,tryAgain:p.a.func,afterSuccess:p.a.func,sourceTypes:p.a.arrayOf(p.a.shape({id:p.a.string.isRequired,name:p.a.string.isRequired}))};var Z=function(e){return{isSubmitted:!1,isFinished:!1,isErrored:!1,isCancelling:!1,values:e,createdSource:{},error:void 0}},$=function(e,t){var r=t.type,n=t.values,a=t.data,i=t.error,o=t.initialValues,s=t.sourceTypes;switch(r){case"reset":return Z(o);case"prepareSubmitState":return J({},e,{isFinished:!1,isErrored:!1,error:void 0,isSubmitted:!0,values:n,sourceTypes:s});case"setSubmitted":return J({},e,{isFinished:!0,createdSource:a});case"setErrored":return J({},e,{isErrored:!0,error:i.toString()});case"onStay":return J({},e,{isCancelling:!1});case"showCancelModal":return J({},e,{isCancelling:!0,values:n})}},K=function(e){var t=e.successfulMessage,r=e.isOpen,n=e.sourceTypes,o=e.applicationTypes,u=e.disableAppSelection,l=e.hideSourcesButton,p=e.returnButtonTitle,d=e.initialValues,m=e.onClose,h=e.afterSuccess,y=e.selectedType,b=e.initialWizardState,g=e.submitCallback,v=Object(s.useReducer)($,Z(d)),w=Object(i.a)(v,2),j=w[0],E=j.isErrored,S=j.isFinished,T=j.isSubmitted,_=j.values,M=j.error,x=j.isCancelling,R=j.createdSource,k=Object(a.a)(j,["isErrored","isFinished","isSubmitted","values","error","isCancelling","createdSource"]),z=w[1],A=function(e,t,r){return z({type:"prepareSubmitState",values:e,sourceTypes:t}),F(e,t,Object(O.e)(o)).then((function(e){h&&h(e),g&&g({isSubmitted:!0,createdSource:e,sourceTypes:t}),z({type:"setSubmitted",data:e})})).catch((function(n){g&&g({isErrored:!0,error:n,values:e,sourceTypes:t,wizardState:r}),z({type:"setErrored",error:n})}))};return r?T?c.a.createElement(Q,{afterSubmit:function(){m(void 0,R),z({type:"reset",initialValues:d})},afterError:function(){return m({})},isFinished:S,isErrored:E,successfulMessage:t,hideSourcesButton:l,returnButtonTitle:p,errorMessage:M,reset:function(){return z({type:"reset",initialValues:d})},createdSource:R,tryAgain:function(){return A(_,k.sourceTypes)},afterSuccess:h,sourceTypes:k.sourceTypes}):c.a.createElement(c.a.Fragment,null,c.a.createElement(I.a,{isOpen:x,onExit:function(){return m(_)},onStay:function(){return z({type:"onStay"})}}),c.a.createElement(U,{isCancelling:x,values:_,onSubmit:A,onCancel:function(e){return f()(e)?m({}):z({type:"showCancelModal",values:e})},sourceTypes:n,applicationTypes:o,disableAppSelection:u,selectedType:y,initialWizardState:b})):null};K.propTypes={afterSuccess:p.a.func,sourceTypes:p.a.arrayOf(p.a.shape({id:p.a.string.isRequired,name:p.a.string.isRequired,product_name:p.a.string.isRequired,schema:p.a.shape({authentication:p.a.array,endpoint:p.a.object})})),applicationTypes:p.a.arrayOf(p.a.shape({id:p.a.string.isRequired,name:p.a.string.isRequired,display_name:p.a.string.isRequired})),onClose:p.a.func.isRequired,isOpen:p.a.bool.isRequired,successfulMessage:p.a.node,initialValues:p.a.shape(Object(o.a)({},p.a.string,p.a.oneOf([p.a.string,p.a.array,p.a.number,p.a.bool]))),disableAppSelection:p.a.bool,hideSourcesButton:p.a.bool,returnButtonTitle:p.a.node,selectedType:p.a.string,initialWizardState:p.a.object,submitCallback:p.a.func},K.defaultProps={successfulMessage:c.a.createElement(h.a,{id:"wizard.successfulMessage",defaultMessage:"Your source was successfully added."}),initialValues:{},returnButtonTitle:c.a.createElement(h.a,{id:"wizard.goBackToSources",defaultMessage:"Go back to Sources"})};var ee=function(e){var t=Object(s.useState)(!1),r=Object(i.a)(t,2),a=r[0],o=r[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.a,{variant:"primary",onClick:function(){return o(!0)}},Object(v.e)()),c.a.createElement(K,Object(n.b)({isOpen:a,onClose:function(){return o(!1)}},e)))}}}]);
//# sourceMappingURL=../sourcemaps/vendors~addSource.js.map