(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{577:function(e,t,r){"use strict";var n=r(539).createCommonjsModule((function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function c(e,t,r,n){var a=t&&t.prototype instanceof y?t:y,o=Object.create(a.prototype),i=new A(n||[]);return o._invoke=function(e,t,r){var n=l;return function(a,o){if(n===d)throw new Error("Generator is already running");if(n===f){if("throw"===a)throw o;return x()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var s=S(i,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var c=u(e,t,r);if("normal"===c.type){if(n=r.done?f:p,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=f,r.method="throw",r.arg=c.arg)}}}(e,r,i),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l="suspendedStart",p="suspendedYield",d="executing",f="completed",m={};function y(){}function h(){}function g(){}var v={};v[o]=function(){return this};var b=Object.getPrototypeOf,_=b&&b(b(R([])));_&&_!==r&&n.call(_,o)&&(v=_);var w=g.prototype=y.prototype=Object.create(v);function E(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function T(e,t){function r(a,o,i,s){var c=u(e[a],e,o);if("throw"!==c.type){var l=c.arg,p=l.value;return p&&"object"==typeof p&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(p).then((function(e){l.value=e,i(l)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}var a;this._invoke=function(e,n){function o(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(o,o):o()}}function S(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=u(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var o=a.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function R(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}return{next:x}}function x(){return{value:t,done:!0}}return h.prototype=w.constructor=g,g.constructor=h,g[s]=h.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},E(T.prototype),T.prototype[i]=function(){return this},e.AsyncIterator=T,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new T(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(w),w[s]="Generator",w[o]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=R,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return s.type="throw",s.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:R(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));function a(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}t._asyncToGenerator=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){a(i,n,o,s,c,"next",e)}function c(e){a(i,n,o,s,c,"throw",e)}s(void 0)}))}},t._regeneratorRuntime=n},678:function(e,t,r){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0}),r(539);var a=r(540);r(162);var o=r(248),i=r(0),s=n(i);r(122);var c=n(r(7)),u=r(58),l=n(r(93)),p=n(r(77)),d=r(251),f=r(99);r(46),r(249),r(259),r(96);var m=r(22),y=r(63);r(97),r(78),r(68),r(260);var h=r(252),g=n(r(124));r(161);var v=r(160),b=r(247);r(261),r(262),r(263);var _=r(559),w=r(577),E=n(r(578)),T=r(560);r(258),r(536);var S=r(576),M=r(615),O=r(616),A=r(111),R=r(43),x=n(r(253)),P=function(e){var t=e.name,r=g();return i.useEffect((function(){return setTimeout((function(){return r.change(t,"1")})),function(){return r.change(t,"")}}),[]),null};P.propTypes={name:c.string.isRequired};var j=function(e){var t=e.title,r=e.description,n=e.isEnabled,o=a._objectWithoutProperties(e,["title","description","isEnabled"]);return s.createElement(R.StackItem,o,s.createElement(M.Flex,null,s.createElement(O.FlexItem,{spacer:{default:"spacerSm"}},s.createElement(x,{fill:n?"#3E8635":"#6A6E73"})),s.createElement(O.FlexItem,null,s.createElement(m.Text,{className:"pf-u-mb-xs ins-c-sources__wizard--rhel-desc-title"},t),s.createElement(m.Text,null,r))))};j.propTypes={title:c.string.isRequired,description:c.string.isRequired,isEnabled:c.bool};var C=function(e){var t,r=e.id,n=u.useIntl(),a=(null===(t=(0,g().getState)().values.application)||void 0===t?void 0:t.application_type_id)===r;return s.createElement(A.Stack,null,s.createElement(j,{title:n.formatMessage({id:"rhelbundle.goldImages.title",defaultMessage:"Red Hat Gold Images"}),description:n.formatMessage({id:"rhelbundle.goldImages.description",defaultMessage:"Unlock cloud images in AWS and bring your own subscription instead of paying hourly."}),className:"pf-u-mb-sm",isEnabled:a}),s.createElement(j,{title:n.formatMessage({id:"rhelbundle.subwatch.title",defaultMessage:"High precision subscription watch data"}),description:n.formatMessage({id:"rhelbundle.subwatch.description",defaultMessage:"View precise public cloud usage data in subscription watch."}),className:"pf-u-mb-sm",isEnabled:a}),s.createElement(j,{title:n.formatMessage({id:"rhelbundle.autoregistration.title",defaultMessage:"Autoregistration"}),description:n.formatMessage({id:"rhelbundle.goldImages.description",defaultMessage:"Cloud instances automatically connect to cloud.redhat.com when provisioned."}),isEnabled:a}))};function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){o._defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}C.propTypes={id:c.string.isRequired};var L=function(){var e=w._asyncToGenerator(w._regeneratorRuntime.mark((function e(t){var r,n,a,o=arguments;return w._regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:void 0,n=o.length>2?o[2]:void 0,t){e.next=4;break}return e.abrupt("return",void 0);case 4:return e.prev=4,e.next=7,b.findSource(t);case 7:a=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),console.error(T.handleError(e.t0)),e.abrupt("return",void 0);case 14:if(!a.data.sources.find((function(e){return e.id!==r}))){e.next=16;break}throw n.formatMessage({defaultMessage:"That name is taken. Try another.",id:"wizard.nameTaken"});case 16:return e.abrupt("return",void 0);case 17:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}(),z=!0,I=function(e){return z=e},N=function(){return z},q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{onlyResolvesLast:!1};return E(e,t,r)}(L),F=function(e){return N()?(I(!1),function(t,r){return t?L(t,r,e):void 0}):q},B=function(e){return d._toConsumableArray(e.map((function(e){return D({},e,{product_name:"Red Hat"===e.vendor?e.product_name.replace("Red Hat ",""):e.product_name})})).sort((function(e,t){return e.product_name.localeCompare(t.product_name)})).map((function(e){return{value:e.name,label:e.product_name}})))},V=function(e,t){var r;return(r={},o._defineProperty(r,v.COST_MANAGEMENT_APP_NAME,t.formatMessage({id:"cost.app.description",defaultMessage:"Analyze, forecast, and optimize your Red Hat OpenShift cluster costs in hybrid cloud environments."})),o._defineProperty(r,v.CLOUD_METER_APP_NAME,s.createElement(C,{id:e.id})),r)[e.name]},W=function(e,t){return o._defineProperty({},v.CLOUD_METER_APP_NAME,s.createElement("span",{className:"ins-c-sources__wizard--rhel-mag-label"},"RHEL management ",s.createElement(f.Label,{className:"pf-u-ml-sm",color:"purple"},t.formatMessage({id:"sub.bundle",defaultMessage:"Bundle"}))))[e.name]},G=function(e,t){return[].concat(d._toConsumableArray(e.sort((function(e,t){return e.display_name.localeCompare(t.display_name)})).map((function(e){return{value:e.id,label:W(e,t)||e.display_name,description:V(e,t)}}))),d._toConsumableArray(h.getActiveVendor()!==h.REDHAT_VENDOR?[{label:t.formatMessage({id:"wizard.noApplication",defaultMessage:"No application"}),value:""}]:[]))},H=function(e){return function(t,r){var n=r.getState().values.source_type,a=e.find((function(e){return e.display_name===t.label}));if(!n||!a||a.supported_source_types.includes(n))return t}},U=function(e,t){return function(r,n){var a=n.getState().values.application?n.getState().values.application.application_type_id:void 0,o=e.find((function(e){return e.id===a})),i=!o||o.supported_source_types.includes(t.find((function(e){return e.product_name===r.label})).name);return D({},r,{isDisabled:!i})}},Z={amazon:"/apps/frontend-assets/partners-icons/aws.svg","ansible-tower":"/apps/frontend-assets/red-hat-logos/stacked.svg",azure:"/apps/frontend-assets/partners-icons/microsoft-azure-short.svg",openshift:"/apps/frontend-assets/red-hat-logos/stacked.svg",satellite:"/apps/frontend-assets/red-hat-logos/stacked.svg",google:"/apps/frontend-assets/partners-icons/google-cloud-short.svg"},Y=function(e){return function(t){var r=e.find((function(e){return e.name===t}));return!r||r.icon_url&&!Z[t]?null:function(){return s.createElement("img",{src:Z[t]||r.icon_url,alt:r.product_name,className:"ins-c-sources__wizard--icon ".concat("Red Hat"===r.vendor?"redhat-icon":"pf-u-mb-sm")})}}},Q=function(e){var t=e.values,r=t.application,n=t.source_type,a=r&&r.application_type_id;return a?"".concat(n,"-").concat(a):n},X=function(e){var t=e.intl,r=e.sourceTypes;return e.applicationTypes,{component:"card-select",name:"source_type",isRequired:!0,label:t.formatMessage({id:"wizard.selectYourSourceType",defaultMessage:"A. Select your source type"}),iconMapper:Y(r),validate:[{type:p.REQUIRED}],options:B(r)}},J=function(e){var t=e.intl,r=e.sourceTypes,n=e.applicationTypes,a=e.disableAppSelection;return[D({},X({intl:t,sourceTypes:r,applicationTypes:n}),{mutator:U(n,r)}),{component:"enhanced-radio",name:"application.application_type_id",label:t.formatMessage({id:"wizard.selectYourApplication",defaultMessage:"B. Select an application"}),options:G(n,t),mutator:H(n),isDisabled:a,placeholder:t.formatMessage({id:"wizard.chooseApp",defaultMessage:"Choose application"}),menuIsPortal:!0}]},$=function(e){var t=e.intl,r=e.sourceTypes,n=e.applicationTypes,a=e.disableAppSelection;return[X({intl:t,sourceTypes:r,applicationTypes:n}),{component:"enhanced-radio",name:"application.application_type_id",label:t.formatMessage({id:"wizard.selectApplication",defaultMessage:"B. Application"}),options:G(n,t),mutator:H(n),isDisabled:a,isRequired:!0,validate:[{type:p.REQUIRED}],condition:{when:"source_type",isNotEmpty:!0}}]},K=function(e,t,r){return{name:"types_step",title:r.formatMessage({id:"wizard.selectApplication",defaultMessage:"Select application"}),nextStep:Q,fields:[{component:l.PLAIN_TEXT,name:"app-description",label:r.formatMessage({id:"wizard.applicationDescription",defaultMessage:"Select an application to connect to your source. You can connect additional applications after source creation."})},{component:"enhanced-radio",name:"application.application_type_id",options:G(e.filter((function(e){return e.supported_source_types.includes(t)})),r),mutator:H(e),menuIsPortal:!0},{component:l.TEXT_FIELD,name:"source_type",hideField:!0}]}},ee=function(e,t,r,n){return{title:n.formatMessage({id:"wizard.chooseAppAndType",defaultMessage:"Source type and application"}),name:"types_step",nextStep:Q,fields:[].concat(d._toConsumableArray(h.getActiveVendor()===h.REDHAT_VENDOR?$({intl:n,sourceTypes:e,applicationTypes:t,disableAppSelection:r}):J({intl:n,sourceTypes:e,applicationTypes:t,disableAppSelection:r})),[{component:"description",name:"fixasyncvalidation",Content:P}])}},te=function(){var e=u.useIntl();return s.createElement(y.TextContent,{key:"step1"},s.createElement(m.Text,{component:m.TextVariants.p},e.formatMessage({id:"wizard.nameDescription",defaultMessage:"To import data for an application, you need to connect to a data source. Enter a name, then proceed to select your application and source type."})))},re=function(e){return{title:e.formatMessage({id:"wizard.nameSource",defaultMessage:"Name source"}),name:"name_step",nextStep:"types_step",fields:[{component:"description",name:"description-summary",Content:te},{component:l.TEXT_FIELD,name:"source.name",type:"text",label:e.formatMessage({id:"wizard.name",defaultMessage:"Name"}),placeholder:"Source_1",isRequired:!0,validate:[function(t){return F(e)(t,void 0,e)},{type:p.REQUIRED}],resolveProps:S.default}]}},ne=function(){var e=u.useIntl();return s.createElement(y.TextContent,null,s.createElement(m.Text,{component:m.TextVariants.p},e.formatMessage({id:"wizard.summaryDescription",defaultMessage:"Review the information below and click <b>Add</b> to add your source. To edit details in previous steps, click <b>Back</b>."},{b:function(e){return s.createElement("b",{key:"b-".concat(e.length,"-").concat(Math.floor(1e3*Math.random()))},e)}})))},ae=function(e,t,r){return{fields:[{component:"description",name:"description-summary",Content:ne},{name:"summary",component:"summary",sourceTypes:e,applicationTypes:t}],name:"summary",title:r.formatMessage({id:"wizard.reviewDetails",defaultMessage:"Review details"})}};t.NameDescription=te,t.SummaryDescription=ne,t.appMutatorRedHat=H,t.applicationStep=K,t.asyncValidator=L,t.asyncValidatorDebounced=q,t.asyncValidatorDebouncedWrapper=F,t.compileAllApplicationComboOptions=G,t.compileAllSourcesComboOptions=B,t.default=function(e,t,r,n,a,o){return I(!0),{fields:[{component:l.WIZARD,name:"wizard",title:h.WIZARD_TITLE(),inModal:!0,description:h.WIZARD_DESCRIPTION(),buttonLabels:{submit:a.formatMessage({id:"sources.add",defaultMessage:"Add"}),back:a.formatMessage({id:"wizard.back",defaultMessage:"Back"}),cancel:a.formatMessage({id:"wizard.cancel",defaultMessage:"Cancel"}),next:a.formatMessage({id:"wizard.next",defaultMessage:"Next"})},container:n,showTitles:!0,crossroads:["application.application_type_id","source_type","auth_select"],fields:[re(a),o?K(t,o,a):ee(e,t,r,a)].concat(d._toConsumableArray(_.schemaBuilder(e,t)),[ae(e,t,a)])}]}},t.descriptionMapper=V,t.getFirstValidated=N,t.iconMapper=Y,t.labelMapper=W,t.nextStep=Q,t.setFirstValidated=I,t.sourceTypeMutator=U,t.typesStep=ee},944:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(539);var n=r(162),a=r(248);r(46),r(161),r(160);var o=r(247),i=r(577),s=r(560),c=r(614);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){a._defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=function(e){if(!e)return{};try{var t=new URL(e);return{scheme:t.protocol.replace(/:$/,""),host:t.hostname,port:t.port,path:t.pathname}}catch(e){return console.log(e),{}}},d=function(e){return e.url?p(e.url):e},f=function(){var e=i._asyncToGenerator(i._regeneratorRuntime.mark((function e(t,r){var a,u,p,f,m,y,h,g,v,b,_,w,E,T,S,M,O,A,R,x,P,j,C,k,D,L=arguments;return i._regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=L.length>2&&void 0!==L[2]?L[2]:[],e.prev=1,m=r.find((function(e){return e.name===t.source_type})).id,e.next=5,o.getSourcesApi().createSource(l({},t.source,{source_type_id:m}));case 5:return u=e.sent,y=[],t.endpoint?(h=d(t),g=h.scheme,v=h.host,b=h.port,_=h.path,w=parseInt(b,10),E=l({},t.endpoint,{default:!0,source_id:u.id,scheme:g,host:v,port:isNaN(w)?void 0:w,path:_}),y.push(o.getSourcesApi().createEndpoint(E))):y.push(Promise.resolve(void 0)),t.application&&t.application.application_type_id?(T=l({},t.application,{source_id:u.id}),y.push(o.getSourcesApi().createApplication(T))):y.push(Promise.resolve(void 0)),e.next=11,Promise.all(y);case 11:if(S=e.sent,M=n._slicedToArray(S,2),O=M[0],A=M[1],!(O||t.authentication&&(null===(p=A)||void 0===p?void 0:p.id))){e.next=20;break}return C=l({},t.authentication,{resource_id:(null===(x=O)||void 0===x?void 0:x.id)||(null===(P=A)||void 0===P?void 0:P.id),resource_type:(null===(j=O)||void 0===j?void 0:j.id)?"Endpoint":"Application",source_id:u.id}),e.next=19,o.getSourcesApi().createAuthentication(C);case 19:R=e.sent;case 20:if(!R||!A){e.next=24;break}return k={application_id:A.id,authentication_id:R.id},e.next=24,o.getSourcesApi().createAuthApp(k);case 24:if((null===(f=u)||void 0===f?void 0:f.id)&&o.getSourcesApi().checkAvailabilitySource(u.id),!A){e.next=30;break}return D=a.includes(A.application_type_id)?1e4:0,e.next=29,c.checkAppAvailability(A.id,D);case 29:A=e.sent;case 30:if(!O){e.next=34;break}return e.next=33,c.checkAppAvailability(O.id,void 0,void 0,"getEndpoint");case 33:O=e.sent;case 34:return e.abrupt("return",l({},u,{endpoint:[O],applications:[A]}));case 37:return e.prev=37,e.t0=e.catch(1),e.next=41,s.handleError(e.t0,u?u.id:void 0);case 41:throw e.sent;case 43:case"end":return e.stop()}}),e,null,[[1,37]])})));return function(t,r){return e.apply(this,arguments)}}();t.doCreateSource=f,t.handleErrorWrapper=function(e){return function(){var t=i._asyncToGenerator(i._regeneratorRuntime.mark((function t(r){return i._regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.handleError(r,e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},t.parseUrl=p,t.urlOrHost=d},979:function(e,t,r){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0}),r(539);var a=r(749),o=r(540),i=r(162),s=r(248),c=r(0),u=n(c),l=r(122),p=n(r(7)),d=n(r(677)),f=r(58),m=r(761);r(662),r(93),r(77),r(665),r(554),r(666),r(251),r(132),r(605),r(606),r(607),r(603),r(99),r(46),r(249),r(259),r(96);var y=r(22);r(63),r(97),r(78),r(68),r(260);var h=r(252);r(124),r(161);var g=r(160),v=r(247);r(261),r(262),r(263),r(559),r(750);var b=r(748);r(518),r(94),r(50),r(552),r(519),r(544),r(751),r(674),r(577),r(578);var _=r(678);r(560),r(258),r(536),r(576),r(615),r(616),r(111),r(43),r(253),r(522),r(546),r(246),r(523),r(159),r(524);var w=r(675),E=r(580),T=r(689),S=r(762);r(268);var M=r(676);r(763);var O=r(764),A=r(765),R=r(766),x=r(64);r(614);var P=r(944);r(547),r(256);var j=r(767);function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){s._defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var D={schema:{},sourceTypes:[],isLoading:!0},L=function(e,t){var r=t.type,n=t.sourceTypes,a=t.applicationTypes,o=t.container,i=t.disableAppSelection,s=t.intl,c=t.selectedType;switch(r){case"loaded":return k({},e,{schema:_.default(n.filter(T.default).filter(T.filterVendorTypes),a.filter(E.default).filter(E.filterVendorAppTypes(n)),i,o,s,c),isLoading:!1,sourceTypes:n})}},z=function(e){var t=e.sourceTypes,r=e.applicationTypes,n=e.disableAppSelection,a=e.isCancelling,o=e.onCancel,s=e.values,l=e.onSubmit,p=e.selectedType,d=c.useReducer(L,D),y=i._slicedToArray(d,2),g=y[0],_=g.schema,E=g.sourceTypes,T=g.isLoading,S=y[1],M=c.useRef(!1),O=c.useRef(document.createElement("div")),A=f.useIntl();return c.useEffect((function(){M.current=!0;var e=[];return t||e.push(v.doLoadSourceTypes()),r||e.push(v.doLoadApplicationTypes()),Promise.all(e).then((function(e){var a=e.find((function(e){return e.hasOwnProperty("sourceTypes")})),o=e.find((function(e){return e.hasOwnProperty("applicationTypes")}));M.current&&S({type:"loaded",sourceTypes:t||a.sourceTypes,applicationTypes:r||o.applicationTypes,disableAppSelection:n,container:O.current,intl:A,selectedType:p})})),function(){M.current=!1}}),[]),c.useEffect((function(){O.current.hidden=a}),[a]),T?u.createElement(m.Wizard,{isOpen:!0,onClose:o,title:h.WIZARD_TITLE(),description:h.WIZARD_DESCRIPTION(),steps:[{name:"Loading",component:u.createElement(w.default,{onClose:function(){return o()}}),isFinishedStep:!0}]}):u.createElement(b.default,{initialValues:k({},s,{},p&&{source_type:p}),schema:_,onSubmit:function(e){return l(e,E)},onCancel:o})};z.propTypes={onCancel:p.func.isRequired,onSubmit:p.func.isRequired,sourceTypes:p.arrayOf(p.shape({id:p.string.isRequired,name:p.string.isRequired,product_name:p.string.isRequired,schema:p.shape({authentication:p.array,endpoint:p.object})})),applicationTypes:p.arrayOf(p.shape({id:p.string.isRequired,name:p.string.isRequired,display_name:p.string.isRequired})),values:p.object,disableAppSelection:p.bool,isCancelling:p.bool,selectedType:p.string},z.defaultProps={values:{},disableAppSelection:!1};var I=function(e){var t=e.id,r=f.useIntl().formatMessage({id:"wizard.editSource",defaultMessage:"Edit source"});return"sources"===insights.chrome.getApp()?u.createElement(x.Link,{to:"/sources/detail/".concat(t)},u.createElement(l.Button,{variant:"primary",className:"pf-u-mt-xl"},r)):u.createElement(l.Button,{variant:"primary",className:"pf-u-mt-xl",component:"a",target:"_blank",href:"".concat(S.computeSourcesUrl(),"/detail/").concat(t),rel:"noopener noreferrer"},r)};I.propTypes={id:p.string.isRequired};var N=function(e){var t,r,n,a,o,s,p=e.afterSubmit,d=e.afterError,g=e.isFinished,b=e.isErrored,_=e.successfulMessage,E=e.hideSourcesButton,T=e.returnButtonTitle,x=e.reset,P=e.createdSource,j=void 0===P?{}:P,C=e.tryAgain,k=e.afterSuccess,D=e.sourceTypes,L=c.useState(),z=i._slicedToArray(L,2),N=z[0],q=z[1],F=c.useState(),B=i._slicedToArray(F,2),V=B[0],W=B[1],G=f.useIntl(),H=u.createElement(l.Button,{variant:"link",onClick:x},G.formatMessage({id:"wizard.addAnotherSource",defaultMessage:"Add another source"}));if(V)s=u.createElement(S.FinishedStep,{onClose:p,title:G.formatMessage({id:"wizard.removeSourceSuccessTitle",defaultMessage:"Removing successful"}),successfulMessage:G.formatMessage({id:"wizard.removeSourceSuccessDescription",defaultMessage:"Source was successfully removed."}),hideSourcesButton:E,returnButtonTitle:T,secondaryActions:H});else if(N)s=u.createElement(w.default,{customText:G.formatMessage({id:"wizard.removingSource",defaultMessage:"Removing source"})});else if(g)switch(R.default(j)){case"unavailable":s=u.createElement(M.default,{onClose:p,secondaryActions:u.createElement(l.Button,{variant:"link",onClick:function(){return q(!0),v.getSourcesApi().removeSource(j.id).then((function(){k&&k(),W(!0)})).catch((function(){return q(!1)}))}},G.formatMessage({id:"wizard.removeSource",defaultMessage:"Remove source"})),Component:function(){return u.createElement(I,{id:j.id})},message:(null===(t=j.applications)||void 0===t||null===(r=t[0])||void 0===r?void 0:r.availability_status_error)||(null===(n=j.endpoint)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.availability_status_error)||G.formatMessage({id:"wizard.unknownError",defaultMessage:"Unknown error"}),title:G.formatMessage({id:"wizard.configurationUnsuccessful",defaultMessage:"Configuration unsuccessful"})});break;case"timeout":s=u.createElement(O.default,{onClose:p,returnButtonTitle:T,secondaryActions:H});break;default:s=j.source_type_id===(null===(o=D.find((function(e){return"amazon"===e.name})))||void 0===o?void 0:o.id)?u.createElement(A.default,{onClose:p}):u.createElement(S.FinishedStep,{onClose:p,successfulMessage:_,hideSourcesButton:E,returnButtonTitle:T,secondaryActions:H})}else s=b?u.createElement(M.default,{onClose:d,primaryAction:C,secondaryActions:u.createElement(y.Text,{component:"a",target:"_blank",href:"https://access.redhat.com/support/cases/#/case/new/open-case?caseCreate=true",rel:"noopener noreferrer"},G.formatMessage({id:"wizard.openTicket",defaultMessage:"Open a support case"})),returnButtonTitle:G.formatMessage({id:"wizard.retryText",defaultMessage:"Retry"})}):u.createElement(w.default,{customText:G.formatMessage({id:"wizard.loadingText",defaultMessage:"Validating credentials"}),description:G.formatMessage({id:"wizard.loadingDescription",defaultMessage:"This could take a minute. If you prefer not to wait, close this dialog and the process will continue."}),onClose:d,cancelTitle:G.formatMessage({id:"wizard.close",defaultMessage:"Close"})});return u.createElement(m.Wizard,{isOpen:!0,onClose:g?p:d,title:h.WIZARD_TITLE(),description:h.WIZARD_DESCRIPTION(),steps:[{name:"Finish",component:s,isFinishedStep:!0}]})};function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){s._defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}N.propTypes={afterSubmit:p.func.isRequired,afterError:p.func.isRequired,isFinished:p.bool.isRequired,isErrored:p.bool.isRequired,successfulMessage:p.node.isRequired,hideSourcesButton:p.bool,returnButtonTitle:p.node.isRequired,errorMessage:p.node,reset:p.func,createdSource:p.object,tryAgain:p.func,afterSuccess:p.func,sourceTypes:p.arrayOf(p.shape({id:p.string.isRequired,name:p.string.isRequired}))};var B=function(e){return{isSubmitted:!1,isFinished:!1,isErrored:!1,isCancelling:!1,values:e,createdSource:{},error:void 0}},V=function(e,t){var r=t.type,n=t.values,a=t.data,o=t.error,i=t.initialValues,s=t.sourceTypes;switch(r){case"reset":return B(i);case"prepareSubmitState":return F({},e,{isFinished:!1,isErrored:!1,error:void 0,isSubmitted:!0,values:n,sourceTypes:s});case"setSubmitted":return F({},e,{isFinished:!0,createdSource:a});case"setErrored":return F({},e,{isErrored:!0,error:o.toString()});case"onStay":return F({},e,{isCancelling:!1});case"showCancelModal":return F({},e,{isCancelling:!0,values:n})}},W=function(e){var t=e.successfulMessage,r=e.isOpen,n=e.sourceTypes,a=e.applicationTypes,s=e.disableAppSelection,l=e.hideSourcesButton,p=e.returnButtonTitle,f=e.initialValues,m=e.onClose,y=e.afterSuccess,h=e.selectedType,v=c.useReducer(V,B(f)),b=i._slicedToArray(v,2),_=b[0],w=_.isErrored,E=_.isFinished,T=_.isSubmitted,S=_.values,M=_.error,O=_.isCancelling,A=_.createdSource,R=o._objectWithoutProperties(_,["isErrored","isFinished","isSubmitted","values","error","isCancelling","createdSource"]),x=b[1],C=function(e,t){return x({type:"prepareSubmitState",values:e,sourceTypes:t}),P.doCreateSource(e,t,g.timeoutedApps(a)).then((function(e){y&&y(e),x({type:"setSubmitted",data:e})})).catch((function(e){x({type:"setErrored",error:e})}))};return r?T?u.createElement(N,{afterSubmit:function(){m(void 0,A),x({type:"reset",initialValues:f})},afterError:function(){return m({})},isFinished:E,isErrored:w,successfulMessage:t,hideSourcesButton:l,returnButtonTitle:p,errorMessage:M,reset:function(){return x({type:"reset",initialValues:f})},createdSource:A,tryAgain:function(){return C(S,R.sourceTypes)},afterSuccess:y,sourceTypes:R.sourceTypes}):u.createElement(u.Fragment,null,u.createElement(j.default,{isOpen:O,onExit:function(){return m(S)},onStay:function(){return x({type:"onStay"})}}),u.createElement(z,{isCancelling:O,values:S,onSubmit:C,onCancel:function(e){return d(e)?m({}):x({type:"showCancelModal",values:e})},sourceTypes:n,applicationTypes:a,disableAppSelection:s,selectedType:h})):null};W.propTypes={afterSuccess:p.func,sourceTypes:p.arrayOf(p.shape({id:p.string.isRequired,name:p.string.isRequired,product_name:p.string.isRequired,schema:p.shape({authentication:p.array,endpoint:p.object})})),applicationTypes:p.arrayOf(p.shape({id:p.string.isRequired,name:p.string.isRequired,display_name:p.string.isRequired})),onClose:p.func.isRequired,isOpen:p.bool.isRequired,successfulMessage:p.node,initialValues:p.shape(s._defineProperty({},p.string,p.oneOf([p.string,p.array,p.number,p.bool]))),disableAppSelection:p.bool,hideSourcesButton:p.bool,returnButtonTitle:p.node,selectedType:p.string},W.defaultProps={successfulMessage:u.createElement(f.FormattedMessage,{id:"wizard.successfulMessage",defaultMessage:"Your source was successfully added."}),initialValues:{},returnButtonTitle:u.createElement(f.FormattedMessage,{id:"wizard.goBackToSources",defaultMessage:"Go back to Sources"})},t.AddSourceButton=function(e){var t=c.useState(!1),r=i._slicedToArray(t,2),n=r[0],o=r[1];return u.createElement(u.Fragment,null,u.createElement(l.Button,{variant:"primary",onClick:function(){return o(!0)}},h.WIZARD_TITLE()),u.createElement(W,a._extends({isOpen:n,onClose:function(){return o(!1)}},e)))},t.AddSourceWizard=W}}]);
//# sourceMappingURL=../sourcemaps/vendors~addSource.js.map